(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69758,       1840]
NotebookOptionsPosition[     68659,       1803]
NotebookOutlinePosition[     69001,       1818]
CellTagsIndexPosition[     68958,       1815]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"top", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", 
      "d1"}], "}"}], ",", 
    RowBox[{"(*", " ", "top", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"data", ",", "All", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d1", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"back", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d2"}], "}"}], ",", 
    RowBox[{"(*", " ", "back", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"data", ",", "All", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d2", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"left", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d3"}], "}"}], ",", 
    RowBox[{"(*", " ", "left", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"data", ",", "All", ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d3", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bottom", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", 
      "d4"}], "}"}], ",", 
    RowBox[{"(*", " ", "bottom", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"data", ",", "All", ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d4", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"front", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d5"}], "}"}], ",", 
    RowBox[{"(*", " ", "front", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"data", ",", "All", ",", "2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d5", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"right", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d6"}], "}"}], ",", 
    RowBox[{"(*", " ", "right", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"data", ",", "All", ",", "3"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d6", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"renderslices", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<top\>\"", ":>", "top"}], ",", 
     RowBox[{"\"\<back\>\"", ":>", "back"}], ",", 
     RowBox[{"\"\<left\>\"", ":>", "left"}], ",", 
     RowBox[{"\"\<bottom\>\"", ":>", "bottom"}], ",", 
     RowBox[{"\"\<front\>\"", ":>", "front"}], ",", 
     RowBox[{"\"\<right\>\"", ":>", "right"}]}], "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.653390381406852*^9, 3.6533903817039704`*^9}, {
   3.653390590977067*^9, 3.6533906202040243`*^9}, 3.653390775649913*^9, {
   3.6533908116802015`*^9, 3.653390869471839*^9}, {3.6533909245377426`*^9, 
   3.6533909544889555`*^9}, {3.6533914196586013`*^9, 3.6533914199242516`*^9}}],

Cell[BoxData[{
 RowBox[{"top2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "df", ",", "d1"}], 
     "}"}], ",", 
    RowBox[{"(*", " ", "top", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"df", ",", "All", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d1", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"back2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d2"}], "}"}], ",", 
    RowBox[{"(*", " ", "back", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"df", ",", "All", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d2", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"left2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d3"}], "}"}], ",", 
    RowBox[{"(*", " ", "left", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"df", ",", "All", ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d3", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bottom2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "df", ",", "d4"}], 
     "}"}], ",", 
    RowBox[{"(*", " ", "bottom", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"df", ",", "All", ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d4", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"front2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d5"}], "}"}], ",", 
    RowBox[{"(*", " ", "front", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"df", ",", "All", ",", "2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d5", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"right2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d6"}], "}"}], ",", 
    RowBox[{"(*", " ", "right", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"df", ",", "All", ",", "3"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d6", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"renderslices2", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<top\>\"", ":>", "top2"}], ",", 
     RowBox[{"\"\<back\>\"", ":>", "back2"}], ",", 
     RowBox[{"\"\<left\>\"", ":>", "left2"}], ",", 
     RowBox[{"\"\<bottom\>\"", ":>", "bottom2"}], ",", 
     RowBox[{"\"\<front\>\"", ":>", "front2"}], ",", 
     RowBox[{"\"\<right\>\"", ":>", "right2"}]}], "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6533903859876237`*^9, 3.653390386315754*^9}, 
   3.653390592228038*^9, {3.6533906222841387`*^9, 3.6533906225341263`*^9}, {
   3.6533907050910063`*^9, 3.653390724347232*^9}, {3.6533910426423764`*^9, 
   3.6533910752363367`*^9}, 3.653391164293522*^9, {3.6533911974059334`*^9, 
   3.6533914334937663`*^9}, {3.653393937411039*^9, 3.6533939527707477`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"d", "=", 
  RowBox[{"Import", "[", 
   RowBox[{
   "\"\<D:\\\\_volume_data\\\\Mathematica\\\\tooth.tif\>\"", ",", 
    "\"\<Image3D\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ImageDimensions", "[", "d", "]"}]}], "Input",
 CellChangeTimes->{{3.6533398489881477`*^9, 3.653339874048232*^9}, {
   3.6533399801366987`*^9, 3.6533400047140512`*^9}, {3.6533889577117476`*^9, 
   3.653388980193605*^9}, {3.653389018761639*^9, 3.653389026961242*^9}, {
   3.653389256350097*^9, 3.6533892569594774`*^9}, {3.653389573745006*^9, 
   3.653389577480497*^9}, 3.6533924874271836`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"140", ",", "120", ",", "161"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6533398747854347`*^9, {3.6533399851738997`*^9, 3.6533400098281693`*^9}, 
   3.6533405082166686`*^9, 3.6533421665608373`*^9, 3.6533426126654377`*^9, {
   3.653342719342616*^9, 3.653342725083887*^9}, 3.6533430712427015`*^9, 
   3.653388992756989*^9, {3.6533890289711018`*^9, 3.6533890663253555`*^9}, 
   3.6533891235285463`*^9, 3.65338938637949*^9, {3.6533895742918563`*^9, 
   3.653389578199952*^9}, 3.6533897081598663`*^9, {3.6533904834397383`*^9, 
   3.6533905331235895`*^9}, 3.653390735159441*^9, 3.6533916078200893`*^9, 
   3.653391702644822*^9, 3.653391735758596*^9, 3.653392230312686*^9, 
   3.653392619376109*^9, 3.6533929976946125`*^9, 3.653393980648978*^9, 
   3.653394017904356*^9, 3.6533941581389775`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<D:\\\\document\\\\work\\\\time-varying-visualization\\\\feature_\
transfer_function\\\\tooth_naive.tfi\>\"", ",", "\"\<XML\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bincount", "=", "256"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<intensity\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
          "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", "___"}], 
        "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbcolors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"r", ",", "g", ",", "b"}], "}"}], "]"}]}], "//", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RGBColor", "/@", "#"}], "&"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbfunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"intensity", ",", "rgbcolors"}], "}"}], "]"}], ",", " ", 
       "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgba", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"r", ",", "g", ",", "b", ",", "a"}], "}"}], "]"}]}], "//", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RGBColor", "/@", "#"}], "&"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbafunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"intensity", ",", "rgba"}], "}"}], "]"}], ",", " ", "#1"}], 
      "]"}], " ", "&"}], " ", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alpha", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", "a"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity0", "=", "intensity"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha0", "=", "alpha"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rangeOfAlpha", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "alpha", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "intensity0", "]"}], ">", "0"}], ",", 
    RowBox[{
     RowBox[{"intensity0", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "intensity0"}], "]"}]}], ";", 
     RowBox[{"alpha0", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "alpha0"}], "]"}]}], ";", 
     RowBox[{"rangeOfAlpha", "+=", "1"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", "intensity0", "]"}], "<", "1"}], ",", 
     RowBox[{
      RowBox[{"intensity0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"intensity0", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
      RowBox[{"alpha0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"alpha0", ",", 
         RowBox[{"{", "0", "}"}]}], "]"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
     RowBox[{
     "PlotLegends", "\[Rule]", "\"\<user specified transfer function\>\""}]}],
     "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fun", "=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
     RowBox[{
     "PlotLegends", "\[Rule]", "\"\<user specified transfer function\>\""}]}],
     "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"index0", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Position", "[", 
      RowBox[{"alpha0", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"df", "=", 
  RowBox[{"ImageApply", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fun", "[", "#", "]"}], "&"}], ",", "d"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.65338993313264*^9, 3.653389971839387*^9}, {
   3.6533902219448977`*^9, 3.653390222398024*^9}, 3.6533923870881605`*^9, 
   3.653392510016527*^9, {3.6533926699929543`*^9, 3.6533926705554333`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "data", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LaunchKernels", "[", "8", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"f", ":=", 
    RowBox[{
     RowBox[{"#", "/", "2."}], "&"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ParallelTable", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "=", "fun"}], ",", 
         RowBox[{"data", "=", "d"}]}], "}"}], ",", 
       RowBox[{"renderslices", "[", "i", "]"}]}], "]"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "=", "fun"}], ",", 
         RowBox[{"data", "=", "d"}]}], "}"}], ",", 
       RowBox[{"renderslices2", "[", "i", "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<top\>\"", ",", "\"\<back\>\"", ",", "\"\<left\>\"", ",", 
       "\"\<bottom\>\"", ",", "\"\<front\>\"", ",", "\"\<right\>\""}], 
      "}"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6533904239318047`*^9, 3.6533904297724752`*^9}, {
   3.6533904997933903`*^9, 3.6533905305121737`*^9}, {3.6533905952453227`*^9, 
   3.6533906543538303`*^9}, {3.6533915428283157`*^9, 
   3.6533915487374115`*^9}, {3.6533915864919033`*^9, 
   3.6533915987655635`*^9}, {3.6533916943794117`*^9, 3.653391697613778*^9}, {
   3.653391729389826*^9, 3.6533917334284964`*^9}, {3.6533917739444647`*^9, 
   3.653391814839697*^9}, {3.6533921885218067`*^9, 3.6533922000344644`*^9}, {
   3.6533925221224785`*^9, 3.6533925248598375`*^9}, {3.653392665336996*^9, 
   3.6533926893276987`*^9}, {3.653392788207327*^9, 3.653392847947543*^9}, {
   3.653393995510131*^9, 3.6533939969945107`*^9}, 3.653394073928684*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ParallelTable", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "v", ",", "t2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f", "=", "fun"}], ",", 
           RowBox[{"data", "=", "d"}]}], "}"}], ",", 
         RowBox[{"renderslices", "[", "i", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t2", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t2", "-", "t1"}], ",", 
        RowBox[{"ImageMeasurements", "[", 
         RowBox[{"v", ",", "\"\<TotalIntensity\>\""}], "]"}], ",", 
        RowBox[{"ImageMeasurements", "[", 
         RowBox[{"v", ",", "\"\<StandardDeviationIntensity\>\""}], "]"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<top\>\"", ",", "\"\<back\>\"", ",", "\"\<left\>\"", ",", 
       "\"\<bottom\>\"", ",", "\"\<front\>\"", ",", "\"\<right\>\""}], 
      "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ParallelTable", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "v", ",", "t2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f", "=", "fun"}], ",", 
           RowBox[{"data", "=", "d"}]}], "}"}], ",", 
         RowBox[{"renderslices2", "[", "i", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t2", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t2", "-", "t1"}], ",", 
        RowBox[{"ImageMeasurements", "[", 
         RowBox[{"v", ",", "\"\<TotalIntensity\>\""}], "]"}], ",", 
        RowBox[{"ImageMeasurements", "[", 
         RowBox[{"v", ",", "\"\<StandardDeviationIntensity\>\""}], "]"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<top\>\"", ",", "\"\<back\>\"", ",", "\"\<left\>\"", ",", 
       "\"\<bottom\>\"", ",", "\"\<front\>\"", ",", "\"\<right\>\""}], 
      "}"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6533918807727165`*^9, 3.6533919468550215`*^9}, 
   3.6533919826008263`*^9, {3.653392051667371*^9, 3.6533921723197503`*^9}, {
   3.6533930957438545`*^9, 3.653393133304534*^9}, {3.6533940010999465`*^9, 
   3.6533940022226486`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "21.6583174`8.787169707452879", ",", "5639.733333333334`", ",", 
     "0.0010481405359159697`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21.797991`8.789961462429957", ",", "10452.886274509803`", ",", 
     "0.0014477047833914034`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "22.0162849`8.794289030041277", ",", "7575.694117647059`", ",", 
     "0.0012280846304975753`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21.9688225`8.793351773427093", ",", "5639.772549019608`", ",", 
     "0.0010220806954955855`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21.7808334`8.78961948664285", ",", "10452.619607843137`", ",", 
     "0.0014767465863473276`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21.6704902`8.787413728938871", ",", "7575.682352941177`", ",", 
     "0.0012431955878119167`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6533932336448526`*^9, 3.6533940645655785`*^9, 
  3.6533942061260595`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.4687332`7.122470708838583", ",", "5639.854901960784`", ",", 
     "0.0010482598061967473`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4062348`7.060322117883833", ",", "10452.850980392157`", ",", 
     "0.001447848108799438`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.484359`7.136712367382013", ",", "7575.588235294118`", ",", 
     "0.0012281212282493194`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.484359`7.136712367382013", ",", "5639.894117647059`", ",", 
     "0.0010219697813268647`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4062348`7.060322117883833", ",", "10452.627450980392`", ",", 
     "0.0014768369344605491`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4687332`7.122470708838583", ",", "7575.8`", ",", 
     "0.001243329153962022`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6533932336448526`*^9, 3.6533940645655785`*^9, 
  3.6533942066416674`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Image3DSlices", "[", 
    RowBox[{"d", ",", "All", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"list", "[", 
    RowBox[{"[", "25", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img2", "=", 
   RowBox[{"list", "[", 
    RowBox[{"[", "30", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ImageAdd", "[", 
  RowBox[{"img", ",", 
   RowBox[{"ImageMultiply", "[", 
    RowBox[{
     RowBox[{"ColorNegate", "[", "img", "]"}], ",", "img2"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"t2", "-", "t1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ImageApply", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "#"}], ")"}], "*", "#2"}]}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"img", ",", "img2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"t2", "-", "t1"}]}], "Input",
 CellChangeTimes->{{3.653342166279584*^9, 3.6533422576413145`*^9}, {
  3.6533423522141347`*^9, 3.6533424750840163`*^9}, {3.6533895269056745`*^9, 
  3.653389552074544*^9}, {3.6533904606803102`*^9, 3.6533904615392003`*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
nZFUrWpVq1rVqla1qlWtav9T9h/XWMmg
    "], {{0, 120}, {140, 0}}, {0, 255},
    ColorFunction->GrayLevel],
   BoxForm`ImageTag["Byte", ColorSpace -> "Grayscale", Interleaving -> None],
   Selectable->False],
  BaseStyle->"ImageGraphics",
  ImageSizeRaw->{140, 120},
  PlotRange->{{0, 140}, {0, 120}}]], "Output",
 CellChangeTimes->{{3.653342172222836*^9, 3.6533422011907005`*^9}, {
   3.6533422448754663`*^9, 3.6533422685378747`*^9}, {3.6533423667300825`*^9, 
   3.6533424755196667`*^9}, {3.653342536741371*^9, 3.6533425616199365`*^9}, 
   3.6533426157452292`*^9, 3.6533895060416284`*^9, 3.653389552993409*^9, {
   3.653389690896109*^9, 3.653389717377738*^9}, 3.653390464649588*^9, {
   3.653390495085172*^9, 3.653390544473236*^9}, 3.6533907468557425`*^9, 
   3.653391619658323*^9, 3.6533917145397935`*^9, 3.6533917475575466`*^9, 
   3.6533923108450527`*^9, 3.653392725481904*^9, 3.65339350418635*^9, 
   3.6533940651125116`*^9, 3.6533942066729555`*^9}],

Cell[BoxData["0``7.451544993495973"], "Output",
 CellChangeTimes->{{3.653342172222836*^9, 3.6533422011907005`*^9}, {
   3.6533422448754663`*^9, 3.6533422685378747`*^9}, {3.6533423667300825`*^9, 
   3.6533424755196667`*^9}, {3.653342536741371*^9, 3.6533425616199365`*^9}, 
   3.6533426157452292`*^9, 3.6533895060416284`*^9, 3.653389552993409*^9, {
   3.653389690896109*^9, 3.653389717377738*^9}, 3.653390464649588*^9, {
   3.653390495085172*^9, 3.653390544473236*^9}, 3.6533907468557425`*^9, 
   3.653391619658323*^9, 3.6533917145397935`*^9, 3.6533917475575466`*^9, 
   3.6533923108450527`*^9, 3.653392725481904*^9, 3.65339350418635*^9, 
   3.6533940651125116`*^9, 3.653394206688553*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
nZFUrWpVq1rVqla1qlWtav9T9h/XWMmg
    "], {{0, 120}, {140, 0}}, {0, 255},
    ColorFunction->GrayLevel],
   BoxForm`ImageTag["Byte", ColorSpace -> "Grayscale", Interleaving -> None],
   Selectable->False],
  BaseStyle->"ImageGraphics",
  ImageSizeRaw->{140, 120},
  PlotRange->{{0, 140}, {0, 120}}]], "Output",
 CellChangeTimes->{{3.653342172222836*^9, 3.6533422011907005`*^9}, {
   3.6533422448754663`*^9, 3.6533422685378747`*^9}, {3.6533423667300825`*^9, 
   3.6533424755196667`*^9}, {3.653342536741371*^9, 3.6533425616199365`*^9}, 
   3.6533426157452292`*^9, 3.6533895060416284`*^9, 3.653389552993409*^9, {
   3.653389690896109*^9, 3.653389717377738*^9}, 3.653390464649588*^9, {
   3.653390495085172*^9, 3.653390544473236*^9}, 3.6533907468557425`*^9, 
   3.653391619658323*^9, 3.6533917145397935`*^9, 3.6533917475575466`*^9, 
   3.6533923108450527`*^9, 3.653392725481904*^9, 3.65339350418635*^9, 
   3.6533940651125116`*^9, 3.6533942067041903`*^9}],

Cell[BoxData["0.0312345`5.9461795516736755"], "Output",
 CellChangeTimes->{{3.653342172222836*^9, 3.6533422011907005`*^9}, {
   3.6533422448754663`*^9, 3.6533422685378747`*^9}, {3.6533423667300825`*^9, 
   3.6533424755196667`*^9}, {3.653342536741371*^9, 3.6533425616199365`*^9}, 
   3.6533426157452292`*^9, 3.6533895060416284`*^9, 3.653389552993409*^9, {
   3.653389690896109*^9, 3.653389717377738*^9}, 3.653390464649588*^9, {
   3.653390495085172*^9, 3.653390544473236*^9}, 3.6533907468557425`*^9, 
   3.653391619658323*^9, 3.6533917145397935`*^9, 3.6533917475575466`*^9, 
   3.6533923108450527`*^9, 3.653392725481904*^9, 3.65339350418635*^9, 
   3.6533940651125116`*^9, 3.6533942067198153`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"df", "=", 
   RowBox[{"ImageApply", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fun", "[", "#", "]"}], "&"}], ",", "d"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Image3DSlices", "[", 
    RowBox[{"df", ",", "All", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"First", "[", "list", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list2", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"img", "=", 
       RowBox[{"ImageAdd", "[", 
        RowBox[{"img", ",", 
         RowBox[{"ImageMultiply", "[", 
          RowBox[{
           RowBox[{"ColorNegate", "[", "img", "]"}], ",", "i"}], "]"}]}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"list", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{"#", ",", 
       RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list3", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ImageSubtract", "[", 
       RowBox[{
        RowBox[{"list2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"list2", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", 
        RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{"#", ",", 
       RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"d1", "=", 
  RowBox[{"Image3D", "[", "list3", "]"}]}]}], "Input",
 CellChangeTimes->{{3.653342644247078*^9, 3.6533426850141435`*^9}, {
   3.653342777826734*^9, 3.6533428184633656`*^9}, {3.65334294323746*^9, 
   3.653343080939371*^9}, 3.6533431192278495`*^9, {3.653343150564906*^9, 
   3.653343164723798*^9}, {3.6533896509078054`*^9, 3.653389654660518*^9}, {
   3.653391651323802*^9, 3.653391651573823*^9}}],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"SystemInformation", "[", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6533451885119467`*^9, 3.6533451885135756`*^9}, 
   3.653391674322067*^9}],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CUDAResourcesInstall", "[", 
    RowBox[{"Update", "\[Rule]", "True"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.653345835250424*^9}],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CUDAInformation", "[", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6533416961796083`*^9, 3.6533416995620966`*^9}, {
   3.653344598833947*^9, 3.6533446107433357`*^9}, 3.6533960991685467`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"list", "=", 
     RowBox[{"Image3DSlices", "[", 
      RowBox[{"d", ",", "All", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"img", "=", 
     RowBox[{"First", "[", "list", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list2", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"img", "=", 
         RowBox[{"CUDAImageAdd", "[", 
          RowBox[{"img", ",", 
           RowBox[{"CUDAImageMultiply", "[", 
            RowBox[{
             RowBox[{"CUDAColorNegate", "[", "img", "]"}], ",", "im"}], 
            "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"im", ",", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"#", ",", 
         RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list3", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CUDAImageSubtract", "[", 
         RowBox[{
          RowBox[{"list2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"list2", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"#", ",", 
         RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"d1", "=", 
    RowBox[{"Image3D", "[", "list3", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6533428599160523`*^9, 3.6533428654371734`*^9}, {
  3.6533431755122128`*^9, 3.653343212234645*^9}}]
},
WindowSize->{1282, 781},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 17087, 468, 952, "Input"],
Cell[17648, 490, 16381, 457, 972, "Input"],
Cell[CellGroupData[{
Cell[34054, 951, 599, 11, 52, "Input"],
Cell[34656, 964, 829, 13, 31, "Output"]
}, Open  ]],
Cell[35500, 980, 7826, 234, 512, "Input"],
Cell[43329, 1216, 2004, 48, 152, "Input"],
Cell[CellGroupData[{
Cell[45358, 1268, 2926, 74, 252, "Input"],
Cell[48287, 1344, 1018, 28, 52, "Output"],
Cell[49308, 1374, 999, 28, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50344, 1407, 1621, 45, 232, "Input"],
Cell[51968, 1454, 5164, 87, 135, "Output"],
Cell[57135, 1543, 686, 9, 31, "Output"],
Cell[57824, 1554, 5164, 87, 135, "Output"],
Cell[62991, 1643, 696, 9, 31, "Output"]
}, Open  ]],
Cell[63702, 1655, 2179, 64, 132, "Input"],
Cell[65884, 1721, 260, 6, 52, "Input"],
Cell[66147, 1729, 253, 6, 52, "Input"],
Cell[66403, 1737, 325, 6, 52, "Input"],
Cell[66731, 1745, 1924, 56, 112, "Input"]
}
]
*)

(* End of internal cache information *)
