(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    104799,       2790]
NotebookOptionsPosition[    102562,       2722]
NotebookOutlinePosition[    103102,       2743]
CellTagsIndexPosition[    103059,       2740]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
  "Hurricane", "\[IndentingNewLine]", "alpha", " ", "H", " ", "S", " ", "B", 
   "\[IndentingNewLine]", "cloud", " ", "wind", " ", "cloud", " ", "grad", 
   " ", "mag", "\[IndentingNewLine]", "cloud", " ", "wind", " ", "constant", 
   "\[IndentingNewLine]", "cloud", " ", "constant", " ", "wind", 
   "\[IndentingNewLine]", "Lung", "\[IndentingNewLine]", "alha", " ", "H", 
   " ", "S", " ", "B", "\[IndentingNewLine]", "I", " ", "constant", " ", 
   "grad", " ", "mag"}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[{
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "tf", ",", "intensity", ",", "r", ",", "g", ",", "b", ",", "a", ",", 
     "rgbcolors"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tf", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
       "\"\<E:\\\\_time_varying_data\\\\SmokeSim\\\\DSSmokeSideways100500\\\\\
dsSmoke.\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"159", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.tfi\>\""}], 
       ",", "\"\<XML\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"intensity", "=", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"tf", ",", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<intensity\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
            "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
        "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"r", "=", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"tf", ",", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<colorL\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
           ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
        "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g", "=", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"tf", ",", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<colorL\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
           ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
        "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"b", "=", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"tf", ",", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<colorL\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
           ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
        "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"tf", ",", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<colorL\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", 
           "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rgbcolors", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"r", ",", "g", ",", "b"}], "}"}], "]"}]}], "//", 
      RowBox[{
       RowBox[{"RGBColor", "/@", "#"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rgbfunction", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"intensity", ",", "rgbcolors"}], "}"}], "]"}], ",", " ", 
         "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bincount", "=", "256"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6363058081602592`*^9, 3.6363058442981215`*^9}, {
  3.6363065573824024`*^9, 3.6363065576379004`*^9}, {3.63637766855851*^9, 
  3.636377680255339*^9}, {3.63637801164539*^9, 3.6363780368234625`*^9}, {
  3.636667652840522*^9, 3.6366676532305202`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GetUCARFile", "[", "filename_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"url", "=", "\"\<http://www.vets.ucar.edu/vg/isabeldata/\>\""}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"FileExistsQ", "[", "filename", "]"}]}], ",", 
       RowBox[{"URLSave", "[", 
        RowBox[{
         RowBox[{"url", "<>", "filename"}], ",", "filename"}], "]"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Import", "[", 
      RowBox[{"filename", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<GZIP\>\"", ",", "\"\<Binary\>\"", ",", "\"\<Real32\>\""}], "}"}],
        ",", 
       RowBox[{"ByteOrdering", "\[Rule]", "1"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UCARFileToImage3D", "[", 
    RowBox[{"data_", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Image3D", "[", 
    RowBox[{
     RowBox[{"Reverse", "@", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Clip", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{"2", "^", "16"}], " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "500"}], "]"}], 
          ",", "500"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], ",", 
     "\"\<Real32\>\"", ",", "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UCARImage3D", ":=", 
   RowBox[{
    RowBox[{"Image3D", "[", 
     RowBox[{
      RowBox[{"Reverse", "@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Clip", "[", 
              RowBox[{"#1", ",", 
               RowBox[{
                RowBox[{"2", "^", "16"}], " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "500"}], "]"}], 
           ",", "500"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], ",", 
      "\"\<Real32\>\""}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elevation", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{
      "GetUCARFile", "[", 
       "\"\<E:\\\\_time_varying_data\\\\isabeldata\\\\HGTdata.bin.gz\>\"", 
       "]"}], ",", "500"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groundColor", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.", ",", "0.0675975", ",", "0.467384"}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.001", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.42313633333333334`", ",", "0.4823743333333333", ",", 
            "0.434165"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.4680942", ",", "0.4216284", ",", "0.29627780000000004`"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.5066887333333333", ",", "0.3798376666666667", ",", 
            "0.24217553333333333`"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.8", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.6809748666666666", ",", "0.5876996666666666", ",", 
            "0.49616886666666665`"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1.", ",", "1.", ",", "1."}], "]"}]}], "}"}]}], "}"}], ",",
       "#"}], "]"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ground", "=", 
   RowBox[{"ListPlot3D", "[", 
    RowBox[{
     RowBox[{"Reverse", "@", 
      RowBox[{"ArrayResample", "[", 
       RowBox[{
        RowBox[{"GaussianFilter", "[", 
         RowBox[{
          RowBox[{"elevation", "/", "200"}], ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "4"}], "}"}]}], "]"}], ",", "128"}], "]"}]}], 
     ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Texture", "[", 
       RowBox[{"ReliefImage", "[", 
        RowBox[{"elevation", ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "groundColor"}]}], "]"}], 
       "]"}]}], ",", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0.1"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "48"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"clist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata\\\\CLOUDf\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", 
         "\"\<.bin.gz\>\""}], ")"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ulist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata\\\\Uf\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", 
         "\"\<.bin.gz\>\""}], ")"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vlist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata\\\\Vf\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", 
         "\"\<.bin.gz\>\""}], ")"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"wlist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata\\\\Wf\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", 
         "\"\<.bin.gz\>\""}], ")"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tf", "=", 
    RowBox[{"ColorData", "[", "\"\<RedGreenSplit\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clist0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\CLOUDf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ulist0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\Uf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlist0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\Vf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wlist0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\Wf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vaporlist0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\QVAPORf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plist0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\Pf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"preciplist0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "\"\<E:\\\\_time_varying_data\\\\isabeldata_tiff\\\\PRECIPf\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\CLOUDf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ulist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\Uf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vlist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\Vf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"wlist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\Wf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vaporlist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\QVAPORf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"plist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\Pf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"preciplist2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\isabeldata_resized\\\\PRECIPf\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.636205610101866*^9, 3.63620561077374*^9}, {
   3.6362057261971583`*^9, 3.6362057269002857`*^9}, {3.6362057836499095`*^9, 
   3.636205803211651*^9}, {3.636206162887823*^9, 3.636206169618414*^9}, {
   3.6362134768259*^9, 3.6362135033105907`*^9}, {3.636289422722559*^9, 
   3.6362894247225637`*^9}, {3.6362923139156446`*^9, 
   3.6362923141812725`*^9}, {3.636292405790868*^9, 3.636292406259617*^9}, {
   3.6363065411511555`*^9, 3.636306554687073*^9}, {3.636312475771102*^9, 
   3.636312476099229*^9}, 3.6363690668641634`*^9, 3.636369565009246*^9, {
   3.6363752861093674`*^9, 3.6363753375863905`*^9}, {3.6390531209987497`*^9, 
   3.639053155602914*^9}, {3.6390536803544636`*^9, 3.639053684673418*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    "clist2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}], "&"}], "/@", "ulist2"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}], "&"}], "/@", "vlist2"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}], "&"}], "/@", 
     "wlist2"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"gradient", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"#1", "*", "#1"}], "+", 
           RowBox[{"#2", "*", "#2"}], "+", 
           RowBox[{"#3", "*", "#3"}]}], "]"}], "]"}], "&"}], "@@@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}], "//", 
      "Rescale"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageAdjust", "[", "#", "]"}], "&"}], "/@", "u"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"v", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageAdjust", "[", "#", "]"}], "&"}], "/@", "v"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"w", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageAdjust", "[", "#", "]"}], "&"}], "/@", "w"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vapor", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    "vaporlist2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    "plist2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"precip", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    "preciplist2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "t0"}]}], "Input",
 CellChangeTimes->{{3.6362958736302166`*^9, 3.636295912208418*^9}, {
   3.6362961049588757`*^9, 3.6362961051776333`*^9}, {3.636296844726271*^9, 
   3.636296848960656*^9}, {3.6363055016428676`*^9, 3.6363055018994255`*^9}, {
   3.6363130287981453`*^9, 3.636313029141903*^9}, 3.6363138469839644`*^9, 
   3.6363139405623116`*^9, {3.6363753595674534`*^9, 3.636375389278273*^9}, {
   3.636378305755845*^9, 3.636378316402506*^9}, {3.6363785140875297`*^9, 
   3.63637851563442*^9}, 3.636378575243927*^9, {3.639053375264374*^9, 
   3.639053445037927*^9}, 3.639053632016075*^9}],

Cell[BoxData["17.9997031`8.706810335093992"], "Output",
 CellChangeTimes->{3.6390545354543343`*^9, 3.6390546402727365`*^9, 
  3.6390713601703444`*^9, 3.639074940908785*^9, 3.6390762285993214`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvw", "=", 
   RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"#1", "*", "#1"}], "+", 
            RowBox[{"#2", "*", "#2"}], "+", 
            RowBox[{"#3", "*", "#3"}]}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"w", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "u", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "t0"}]}], "Input",
 CellChangeTimes->{{3.6363142530942764`*^9, 3.636314261047449*^9}, {
  3.6363785175875435`*^9, 3.6363785425094748`*^9}, {3.6363786807129307`*^9, 
  3.6363786810098076`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.636379899668998*^9, 3.636379903231484*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", "1"}], ";", 
  RowBox[{"end", "=", "n"}], ";", 
  RowBox[{"step", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"endofstep", "=", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "a", ",", "h", ",", "intensityfunction", ",", "sum", 
        ",", "hist", ",", "probability", ",", "entropy", ",", "op", ",", 
        "opacityfunction", ",", "rgba", ",", "denormalized", ",", "r", ",", 
        "strlist", ",", "alphaMode", ",", "gammaValue", ",", "domain", ",", 
        "threshold", ",", "k", ",", "intensity", ",", "split", ",", "colorL", 
        ",", "keylist", ",", "keys", ",", "TransFuncIntensity", ",", 
        "VoreenData"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"ImageData", "[", 
              RowBox[{"precip", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"h", "=", 
            RowBox[{"HistogramList", "[", 
             RowBox[{"a", ",", "bincount"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"intensityfunction", "=", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1.", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"h", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], 
                ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hist", "[", "i_", "]"}], ":=", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FirstPosition", "[", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"i", "<", "#"}], "&"}], ")"}]}]}], "]"}]}], "-", 
             "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"sum", ":=", 
            RowBox[{"Total", "[", 
             RowBox[{"h", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"probability", "[", "i_", "]"}], ":=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "/", "sum"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"entropy", "[", "i_", "]"}], ":=", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", 
              RowBox[{
               RowBox[{"p", "=", 
                RowBox[{"probability", "[", "i", "]"}]}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"p", "\[NotEqual]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"-", "p"}], "*", 
                  RowBox[{"Log", "[", "p", "]"}]}], ",", "0"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"op", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", "t", "}"}], ",", 
                 RowBox[{
                  RowBox[{"t", "=", 
                   RowBox[{"entropy", "[", "#", "]"}]}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"t", "!=", "0"}], ",", 
                    RowBox[{"1.", "/", "t"}], ",", "0"}], "]"}]}]}], "]"}], 
               "&"}], "/@", "intensityfunction"}], "//", "Rescale"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"opacityfunction", "=", 
            RowBox[{"Interpolation", "[", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rgba", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"rgbfunction", "[", "#", "]"}]}], ",", 
                RowBox[{"opacityfunction", "[", "#", "]"}]}], "]"}], "&"}], "/@",
              "intensityfunction"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"denormalized", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerPart", "[", 
                RowBox[{"255", "#"}], "]"}], "&"}], ")"}], "/@", "rgba"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensityfunction", ",", "denormalized"}], "}"}], 
              "]"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "#"}], 
              "&"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"strlist", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ToString", "[", "#1", "]"}], ",", 
                 RowBox[{"ToString", "[", "#2", "]"}], ",", 
                 RowBox[{"ToString", "[", "#3", "]"}], ",", 
                 RowBox[{"ToString", "[", "#4", "]"}], ",", 
                 RowBox[{"ToString", "[", "#5", "]"}]}], "}"}], "&"}], ")"}], 
             "@@@", "r"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"alphaMode", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<alphaMode\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gammaValue", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<gammaValue\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"domain", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<domain\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
                RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"threshold", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<threshold\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
                RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"k", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"intensity", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<intensity\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "#1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                 RowBox[{"split", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<split\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<false\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                 RowBox[{"colorL", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<colorL\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<r\>\"", "\[Rule]", "#2"}], ",", 
                    RowBox[{"\"\<g\>\"", "\[Rule]", "#3"}], ",", 
                    RowBox[{"\"\<b\>\"", "\[Rule]", "#4"}], ",", 
                    RowBox[{"\"\<a\>\"", "\[Rule]", "#5"}]}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], "&"}], ")"}], "@@@",
              "strlist"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"keylist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"XMLElement", "[", 
               RowBox[{"\"\<key\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<type\>\"", "\[Rule]", "\"\<TransFuncMappingKey\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], 
             "@@@", "k"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"keys", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<Keys\>\"", ",", 
              RowBox[{"{", "}"}], ",", "keylist"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TransFuncIntensity", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<TransFuncIntensity\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<type\>\"", "\[Rule]", "\"\<TransFuncIntensity\>\""}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "alphaMode", ",", "gammaValue", ",", "domain", ",", 
                "threshold", ",", "keys"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"VoreenData", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<VoreenData\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<version\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], 
              ",", 
              RowBox[{"{", "TransFuncIntensity", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"XMLObject", "[", "\"\<Document\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Declaration\>\"", "]"}], "[", 
                RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<1.0\>\""}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Comment\>\"", "]"}], "[", 
                "\"\<This is a Voreen transfer function exported from \
Mathematica\>\"", "]"}]}], "}"}], ",", "VoreenData", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"num", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
             "\"\<hurricane_precip_tfi\\\\\>\"", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{
               RowBox[{"num", "[", 
                RowBox[{"[", 
                 RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
               ",", "2"}], "]"}], "<>", "\"\<.tfi\>\""}], ",", "#", ",", " ", 
            "\"\<XML\>\""}], "]"}], "&"}], ",", "result"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "t0"}]}], "Input",
 CellChangeTimes->{{3.6363056524048653`*^9, 3.6363057249098444`*^9}, {
   3.6363059009964924`*^9, 3.636305904147952*^9}, 3.63631260851587*^9, {
   3.6363126609378963`*^9, 3.6363126642191477`*^9}, 3.6363131280015135`*^9, {
   3.6363132462987046`*^9, 3.6363132499705715`*^9}, {3.6363139574060955`*^9, 
   3.6363139621248293`*^9}, 3.63637555505264*^9, {3.6363766395193763`*^9, 
   3.6363766435074315`*^9}, {3.6363766777085037`*^9, 
   3.6363766848293886`*^9}, {3.6363781960690455`*^9, 3.6363782014537067`*^9}, 
   3.6363782342235746`*^9, 3.636378323667514*^9}],

Cell[BoxData["48.5626138`9.137847047353274"], "Output",
 CellChangeTimes->{3.636378670447281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opacityfunctionlist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tf", ",", "intensity", ",", "r", ",", "g", ",", "b", ",", "a"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tf", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<hurricane_precip_tfi\\\\\>\"", "<>", 
            RowBox[{"IntegerString", "[", 
             RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", 
            "\"\<.tfi\>\""}], ",", "\"\<XML\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"intensity", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"tf", ",", 
            RowBox[{
             RowBox[{"XMLElement", "[", 
              RowBox[{"\"\<intensity\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}],
                 "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",",
             "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"tf", ",", 
            RowBox[{
             RowBox[{"XMLElement", "[", 
              RowBox[{"\"\<colorL\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
                "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
            "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"g", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"tf", ",", 
            RowBox[{
             RowBox[{"XMLElement", "[", 
              RowBox[{"\"\<colorL\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
                "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
            "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"tf", ",", 
            RowBox[{
             RowBox[{"XMLElement", "[", 
              RowBox[{"\"\<colorL\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
                "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
            "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"tf", ",", 
            RowBox[{
             RowBox[{"XMLElement", "[", 
              RowBox[{"\"\<colorL\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", 
               "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
            "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", "a"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"intensity", ",", "a"}], "}"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "d", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "t0"}]}], "Input",
 CellChangeTimes->{{3.6363062048792863`*^9, 3.636306247840603*^9}, {
   3.6363142978600435`*^9, 3.636314302110052*^9}, {3.636376723147668*^9, 
   3.636376732681534*^9}, 3.6363783391535716`*^9, {3.6363787358224382`*^9, 
   3.6363787364630632`*^9}}],

Cell[BoxData["3.1406496`7.948564478676624"], "Output",
 CellChangeTimes->{{3.6363062411654887`*^9, 3.636306253251818*^9}, 
   3.6363080818406873`*^9, 3.636314316516306*^9, 3.636315100456965*^9, 
   3.63637680470561*^9, 3.6363787401349506`*^9, 3.636663799105055*^9, 
   3.6367120246752396`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<hurricane_precip_tfi\\\\\>\"", "<>", 
      RowBox[{"IntegerString", "[", 
       RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.tfi\>\""}], 
     ",", "\"\<XML\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<intensity\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
          "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", "___"}], 
        "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", "a"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"intensity", ",", "a"}], "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
   RowBox[{
   "PlotLegends", "\[Rule]", "\"\<intensity transfer function\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6363768539782305`*^9, 3.636376933794698*^9}, {
   3.6363769887203703`*^9, 3.6363770116101723`*^9}, {3.6363773605313454`*^9, 
   3.6363775569853287`*^9}, {3.636377588678735*^9, 3.6363776047651205`*^9}, {
   3.6363776929509745`*^9, 3.6363777538833475`*^9}, {3.6363778198112745`*^9, 
   3.636377840876872*^9}, {3.636377903564745*^9, 3.636377905510714*^9}, {
   3.63637805037471*^9, 3.636378078107757*^9}, {3.636378123289014*^9, 
   3.6363781500822515`*^9}, 3.636378349273716*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opacityfunctionlist", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "a", ",", "h", ",", "intensityfunction", ",", "hist", ",", "sum", ",",
          "probability", ",", "entropy", ",", "op"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ImageData", "[", 
           RowBox[{"d", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{"a", ",", "bincount"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"intensityfunction", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1.", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"h", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hist", "[", "i_", "]"}], ":=", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"FirstPosition", "[", 
            RowBox[{
             RowBox[{"h", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"i", "<", "#"}], "&"}], ")"}]}]}], "]"}]}], "-", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sum", ":=", 
         RowBox[{"Total", "[", 
          RowBox[{"h", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"probability", "[", "i_", "]"}], ":=", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"h", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "/", "sum"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"entropy", "[", "i_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "p", "}"}], ",", 
           RowBox[{
            RowBox[{"p", "=", 
             RowBox[{"probability", "[", "i", "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"p", "\[NotEqual]", "0"}], ",", 
              RowBox[{
               RowBox[{"-", "p"}], "*", 
               RowBox[{"Log", "[", "p", "]"}]}], ",", "0"}], "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "t", "}"}], ",", 
              RowBox[{
               RowBox[{"t", "=", 
                RowBox[{"entropy", "[", "#", "]"}]}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"t", "!=", "0"}], ",", 
                 RowBox[{"1.", "/", "t"}], ",", "0"}], "]"}]}]}], "]"}], 
            "&"}], "/@", "intensityfunction"}], "//", "Rescale"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "d", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "t0"}]}], "Input",
 CellChangeTimes->{{3.636296928742097*^9, 3.636296946382767*^9}, 
   3.636378355420988*^9}],

Cell[BoxData["35.1847201`8.997899093991998"], "Output",
 CellChangeTimes->{3.6362969763203683`*^9, 3.6363062933614445`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"hsb", " ", "color", " ", "1"}], ":", " ", 
     RowBox[{"cloud", " ", "as", " ", "opacity"}]}], ",", " ", 
    RowBox[{
    "std", " ", "as", " ", "hue", " ", "and", " ", "precipitation", " ", "to",
      " ", "desaturate"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"start", "=", 
     RowBox[{"1", "+", "offset"}]}], ";", 
    RowBox[{"end", "=", "n"}], ";", 
    RowBox[{"step", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"endofstep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "std", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"stdp", "=", 
              RowBox[{"ImageAdjust", "@@", 
               RowBox[{"ImageApply", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StandardDeviation", "[", 
                   RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}],
                 "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ImageApply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#2", ",", 
                   RowBox[{"1", "-", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
                   RowBox[{"1", "-", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "#3"}], 
                  "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "stdp", ",", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "//", 
              RowBox[{
               RowBox[{"Image3D", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], 
               "&"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"std", "=", 
              RowBox[{"ImageAdjust", "@@", 
               RowBox[{"ImageApply", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StandardDeviation", "[", 
                   RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
                 RowBox[{"d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}],
                 "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ImageApply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", 
                   RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"10", "*", "#1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                   RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"10", "*", "#1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", "#2"}], 
                  "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"std", ",", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "//", 
              RowBox[{
               RowBox[{"Image3D", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], 
               "&"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"std", "=", 
             RowBox[{"ImageAdjust", "@@", 
              RowBox[{"ImageApply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StandardDeviation", "[", 
                  RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ImageApply", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#3", ",", 
                  RowBox[{"Clip", "[", 
                   RowBox[{
                    RowBox[{"10", "*", "#1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Clip", "[", 
                   RowBox[{
                    RowBox[{"10", "*", "#1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", "#2"}], 
                 "}"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"precip", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"d", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "std"}], "}"}]}], 
              "]"}], "//", 
             RowBox[{
              RowBox[{"Image3D", "[", 
               RowBox[{"#", ",", 
                RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], 
              "&"}]}]}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "//", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
              "\"\<result\\\\new\\\\hsba_std_10precip_10precip_cloud_\>\"", "<>", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
                ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", "#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], "&"}], ",", 
          "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.636306378283909*^9, {3.6363064177153387`*^9, 3.636306494810054*^9}, 
   3.636375563051296*^9, {3.6363795826681933`*^9, 3.6363796057464223`*^9}, {
   3.636379694059104*^9, 3.636379741871719*^9}, {3.636379775293672*^9, 
   3.6363797803718386`*^9}, 3.6363798437000885`*^9, {3.636383890417257*^9, 
   3.636383914182966*^9}, {3.6363839521205215`*^9, 3.636384001245678*^9}, 
   3.636384068558304*^9, {3.6363851098107977`*^9, 3.63638511559206*^9}, {
   3.6363852422955213`*^9, 3.6363852478892546`*^9}, 3.6363860894071026`*^9, {
   3.6363914632618284`*^9, 3.636391484287989*^9}, {3.636666143543065*^9, 
   3.6366661441380653`*^9}, {3.636666209586542*^9, 3.6366662184760156`*^9}, {
   3.6366663628351955`*^9, 3.6366663884302425`*^9}, {3.636666919695219*^9, 
   3.63666699067535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"hsb", " ", "color", " ", "2"}], ":", " ", 
     RowBox[{
     "cloud", " ", "in", " ", "white", " ", "and", " ", "precipitation", " ", 
      "in", " ", "black"}]}], ",", " ", 
    RowBox[{
    "which", " ", "imitates", " ", "natual", " ", "rain", " ", "clouds"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"start", "=", 
     RowBox[{"1", "+", "offset"}]}], ";", 
    RowBox[{"end", "=", "n"}], ";", 
    RowBox[{"step", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"endofstep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"std", ",", "cloud"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"std", "=", 
             RowBox[{"ImageAdjust", "@@", 
              RowBox[{"ImageApply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StandardDeviation", "[", 
                  RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"cloud", "=", 
             RowBox[{
              RowBox[{"ImageApply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"4", "*", "#1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                   RowBox[{"1", "-", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"10", "*", "#2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "#3"}], 
                  "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"std", ",", 
                  RowBox[{"precip", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "//", 
              RowBox[{
               RowBox[{"Image3D", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], 
               "&"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ImageResize", "[", 
               RowBox[{
                RowBox[{"ColorConvert", "[", 
                 RowBox[{"cloud", ",", "\"\<RGB\>\""}], "]"}], ",", 
                RowBox[{
                 RowBox[{"ImageDimensions", "[", "cloud", "]"}], "*", "2"}]}],
                "]"}], ",", "ground", ",", 
              RowBox[{"Boxed", "->", "False"}], ",", 
              RowBox[{"ViewPoint", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "//", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
              "\"\<result\\\\hurricane_hsba_0_10std_1-10precip_cloud\\\\hsba_\
0_10std_1-10precip_cloud_\>\"", "<>", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
                ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", "#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], "&"}], ",", 
          "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6366660594253983`*^9, 3.6366660675604153`*^9}, 
   3.6366662305507126`*^9, {3.6366663382401505`*^9, 3.636666352445177*^9}, 
   3.6366663946302533`*^9, {3.6366668487842026`*^9, 3.6366668754992733`*^9}, {
   3.6366671202870855`*^9, 3.6366671258471146`*^9}, 3.6366671596680546`*^9, {
   3.636711948819976*^9, 3.6367120040032787`*^9}, {3.636712048690978*^9, 
   3.6367120570346413`*^9}, 3.63671241559879*^9, 3.6367148727316933`*^9, {
   3.6367196765269766`*^9, 3.636719679152018*^9}, {3.6368113743876457`*^9, 
   3.636811458122218*^9}, 3.6368115548567467`*^9, {3.636811628169503*^9, 
   3.6368116362475567`*^9}, {3.636812930689397*^9, 3.6368129337375717`*^9}, {
   3.636813094988535*^9, 3.6368130951759815`*^9}, {3.6368148233583717`*^9, 
   3.6368148459677944`*^9}, 3.6368149552648587`*^9, {3.6368161464322276`*^9, 
   3.636816151697867*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"opacityfunction", "=", 
    RowBox[{"opacityfunctionlist", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"list", "=", 
    RowBox[{"d", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"std", "=", 
    RowBox[{"ImageAdjust", "@@", 
     RowBox[{"ImageApply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StandardDeviation", "[", 
         RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "list"}], "]"}]}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#3", ",", 
         RowBox[{"Clip", "[", 
          RowBox[{
           RowBox[{"5", "*", "#1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"Clip", "[", 
           RowBox[{
            RowBox[{"4", "*", "#2"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"opacityfunction", "[", "#3", "]"}]}], "}"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"std", ",", "gradient", ",", 
        RowBox[{"d", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], "&"}]}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{3.6363073839189606`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"opacityfunction", "=", 
   RowBox[{"opacityfunctionlist", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.636312396817791*^9, 3.636312397052165*^9}, {
  3.63638010868526*^9, 3.636380109122757*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ColorConvert", "[", 
   RowBox[{"Yellow", ",", "\"\<HSB\>\""}], "]"}], "//", 
  "InputForm"}]], "Input",
 CellChangeTimes->{{3.6368115096222944`*^9, 3.6368115271067085`*^9}}],

Cell["Hue[0.16666666666666666, 1., 1.]", "Output",
 CellChangeTimes->{3.6368115276379895`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stdvapor", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
      RowBox[{"vapor", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"std", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stdprecip", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
      RowBox[{"precip", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stdp", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
      RowBox[{"p", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], "]"}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.6363143994384117`*^9, 3.636314409235283*^9}, {
  3.6366674545587826`*^9, 3.636667467633806*^9}, {3.636667623930467*^9, 
  3.6366676329254856`*^9}}],

Cell[BoxData[{
 RowBox[{"Image3D", "[", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"[", "i", "]"}], "]"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RGBColor", "[", 
       RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], ")"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Image3D", "[", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"[", "i", "]"}], "]"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RGBColor", "[", 
       RowBox[{
        RowBox[{"1", "-", "#"}], ",", 
        RowBox[{"1", "-", "#"}], ",", 
        RowBox[{"1", "-", "#"}], ",", "#"}], "]"}], "&"}], ")"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6366653673285227`*^9, 3.636665372988553*^9}, {
  3.636667483183836*^9, 3.636667490778844*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}]}], "Input",
 CellChangeTimes->{{3.63907367187362*^9, 3.6390736720986176`*^9}, {
  3.6390742696857314`*^9, 3.6390742697007103`*^9}, {3.6391267311873417`*^9, 
  3.6391267312967443`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    RowBox[{"clist0", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"plist0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"std", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "d0"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6390720932646255`*^9, 3.6390720971809416`*^9}, {
  3.639072151915489*^9, 3.639072212777844*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cloud", "=", 
   RowBox[{
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Clip", "[", 
          RowBox[{
           RowBox[{"5", "*", "#1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"Clip", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "#3"}], "}"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"std", ",", "p0", ",", 
        RowBox[{"d0", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"cloud", ",", "ground", ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"cloud", ",", "ground", ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", 
        RowBox[{"-", "2.4"}], ",", " ", "2."}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_hsba_0_5std_1-1p_cloud_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "2000"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_hsba_0_5std_1-1p_cloud_defaultangle_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r2", ",", 
    RowBox[{"ImageSize", "\[Rule]", "2000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.639130138962425*^9, {3.6391301972912483`*^9, 3.6391302025168076`*^9}, {
   3.639130280526475*^9, 3.6391302984238405`*^9}, {3.639132296995333*^9, 
   3.6391322977453375`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    RowBox[{"clist0", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"plist0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"std", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "d0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cloud", "=", 
   RowBox[{
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Clip", "[", 
          RowBox[{
           RowBox[{"5", "*", "#1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"Clip", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "#3"}], "}"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"std", ",", "p0", ",", 
        RowBox[{"d0", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"cloud", ",", "ground", ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"cloud", ",", "ground", ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", 
        RowBox[{"-", "2.4"}], ",", " ", "2."}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_hsba_0_5std_1-1p_cloud_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "2000"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_hsba_0_5std_1-1p_cloud_defaultangle_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r2", ",", 
    RowBox[{"ImageSize", "\[Rule]", "2000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6391306529697886`*^9, 3.639130660428029*^9}, {
  3.639132300621546*^9, 3.6391323012750177`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.636713199278349*^9, {3.6367992109596057`*^9, 3.6367992111546392`*^9}, {
   3.6368190793720307`*^9, 3.6368190797001543`*^9}, {3.6368191107332354`*^9, 
   3.6368191150628395`*^9}, {3.6368191520974407`*^9, 
   3.6368191522693324`*^9}, {3.637429616714781*^9, 3.6374296175467725`*^9}, {
   3.6374299289311547`*^9, 3.6374299292275777`*^9}, {3.6391267380795927`*^9, 
   3.639126738173346*^9}, {3.63912991150686*^9, 3.639129911706625*^9}, {
   3.639136492070368*^9, 3.639136492205318*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    RowBox[{"clist0", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"precip0", "=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"preciplist0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"std", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "d0"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.639054545854638*^9, 3.639054547641529*^9}, 
   3.6390568139477386`*^9, {3.6390569017847595`*^9, 3.639056902117899*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cloud", "=", 
   RowBox[{
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Clip", "[", 
          RowBox[{
           RowBox[{"5", "*", "#1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"Clip", "[", 
           RowBox[{
            RowBox[{"10", "*", "#2"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "#3"}], "}"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"std", ",", "precip0", ",", 
        RowBox[{"d0", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"cloud", ",", "ground", ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"cloud", ",", "ground", ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", 
        RowBox[{"-", "2.4"}], ",", " ", "2."}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_hsba_0_5std_1-10precip_cloud_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "2000"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_hsba_0_5std_1-10precip_cloud_defaultangle_\>\"",
      "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r2", ",", 
    RowBox[{"ImageSize", "\[Rule]", "2000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6391284105281696`*^9, {3.6391292971274414`*^9, 3.639129297993577*^9}, {
   3.639130245719013*^9, 3.6391302688870544`*^9}, {3.6391377106559343`*^9, 
   3.6391377112470384`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "images", " ", "to", " ", "be", " ", "included", " ", "in", " ", "EuroVis",
     " ", "2015", " ", "poster"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"start", "=", 
     RowBox[{"1", "+", "offset"}]}], ";", 
    RowBox[{"end", "=", "n"}], ";", 
    RowBox[{"step", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"endofstep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"d", ",", "precip"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"ImageAdjust", "@", 
              RowBox[{"Import", "[", 
               RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
            RowBox[{"clist0", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"j", "-", "offset"}], ";;", "endofstep"}], "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"precip", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"ImageAdjust", "@", 
              RowBox[{"Import", "[", 
               RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
            RowBox[{"preciplist0", "[", 
             RowBox[{"[", 
              RowBox[{"j", ";;", "endofstep"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"d0", ",", "precip0", ",", "std", ",", "cloud"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"d0", "=", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "j", "+", "1"}], ";;", 
                   RowBox[{"i", "-", "j", "+", "1", "+", "offset"}]}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"precip0", "=", 
                RowBox[{"precip", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "-", "j", "+", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"std", "=", 
                RowBox[{"ImageAdjust", "@@", 
                 RowBox[{"ImageApply", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StandardDeviation", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "d0"}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"cloud", "=", 
                RowBox[{
                 RowBox[{"ImageApply", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"5", "*", "#1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"1", "-", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"10", "*", "#2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "#3"}], 
                    "}"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"std", ",", "precip0", ",", 
                    RowBox[{"d0", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
                 RowBox[{
                  RowBox[{"Image3D", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<HSB\>\""}]}], "]"}],
                   "&"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Show", "[", 
                RowBox[{"cloud", ",", "ground", ",", 
                 RowBox[{"Boxed", "->", "False"}], ",", 
                 RowBox[{"ViewPoint", "->", 
                  RowBox[{"{", 
                   RowBox[{"1.3", ",", " ", 
                    RowBox[{"-", "2.4"}], ",", " ", "2."}], "}"}]}]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
              "\"\<result\\\\hurricane_hsba_0_5std_1-10precip_cloud_\
defaultangle\\\\hurricane_hsba_0_5std_1-10precip_cloud_defaultangle_\>\"", "<>", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
                ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", "#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], "&"}], ",", 
          "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.639139579272792*^9, 3.6391396875681067`*^9}, 
   3.63913972075836*^9, {3.639139761780244*^9, 3.639139778728816*^9}, {
   3.6391400305924473`*^9, 3.6391400457918944`*^9}, {3.639140331901582*^9, 
   3.639140370577582*^9}, {3.639140446212295*^9, 3.639140646426944*^9}, {
   3.639140683716171*^9, 3.63914070141636*^9}, 3.6391628974257603`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}]}], "Input",
 CellChangeTimes->{{3.639076268152427*^9, 3.6390762681723967`*^9}, 
   3.639132348267785*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Image3D\>\""}], "]"}]}], "&"}], "/@", 
    RowBox[{"clist0", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{
       RowBox[{"ImageAdjust", "@@", 
        RowBox[{"ImageApply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StandardDeviation", "[", 
            RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "d0"}], "]"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
         ")"}]}]}], "]"}], ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_std_gray_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6368116897164*^9, 3.6368117084977603`*^9}, {
   3.636811774138468*^9, 3.636811781232232*^9}, {3.6374296571746063`*^9, 
   3.637429686497879*^9}, {3.6391323782866564`*^9, 3.639132489955184*^9}, {
   3.6391325719794893`*^9, 3.639132572135709*^9}, 3.63913301003401*^9, 
   3.6391410858668365`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c0", "=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"clist0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"c0", ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
         ")"}]}]}], "]"}], ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_cloud_gray_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.636799260334712*^9, 3.6367993016297407`*^9}, {
   3.637429743730748*^9, 3.6374297503404202`*^9}, {3.6391323562677855`*^9, 
   3.639132371586912*^9}, {3.6391324520443006`*^9, 3.639132453581558*^9}, {
   3.6391324981240683`*^9, 3.639132523398452*^9}, {3.6391325764188967`*^9, 
   3.63913260844466*^9}, 3.6391330134323006`*^9, 3.639141087101184*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"precip0", "=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"preciplist0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"precip0", ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
         ")"}]}]}], "]"}], ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_cloud_gray_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6367993159547644`*^9, 3.6367993166297646`*^9}, {
   3.6374297620376277`*^9, 3.63742976773555*^9}, {3.6391321944266996`*^9, 
   3.6391322021358633`*^9}, {3.639132309052174*^9, 3.6391323460925136`*^9}, {
   3.6391325276640577`*^9, 3.6391325310266743`*^9}, 3.6391330169253707`*^9, 
   3.6391410887909374`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"plist0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"p0", ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
         ")"}]}]}], "]"}], ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_p_gray_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "r1", ",", 
    RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6390756730361576`*^9, 3.6390756759742966`*^9}, {
   3.639075877043401*^9, 3.6390758772134285`*^9}, {3.639132111161134*^9, 
   3.6391321727560606`*^9}, {3.6391325410837526`*^9, 
   3.6391325505493126`*^9}, {3.6391330221075754`*^9, 3.6391330223732057`*^9}, 
   3.639141090494077*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ImageAdjust", "@", 
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"plist0", "[", 
     RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Image3D\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.639119732179673*^9, 3.639119743905193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<result\\\\hurricane_p_yellow_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"i", ",", "10", ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
    "%29", ",", 
    RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6391198113214293`*^9, 3.639119820275025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"grayscale", " ", "rendering", " ", "for", " ", "comparison"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"start", "=", 
     RowBox[{"1", "+", "offset"}]}], ";", 
    RowBox[{"end", "=", "n"}], ";", 
    RowBox[{"step", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"endofstep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Image3D", "[", 
            RowBox[{
             RowBox[{"ImageAdjust", "@@", 
              RowBox[{"ImageApply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StandardDeviation", "[", 
                  RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], 
               "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
               ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "//", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
              "\"\<result\\\\hurricane_cloud_std\\\\hurricane_cloud_std_\>\"",
               "<>", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
                ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", "#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], "&"}], ",", 
          "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.636819387986158*^9, 3.6368194018128858`*^9}, {
   3.6368195125502777`*^9, 3.63681953246242*^9}, 3.6368197093406043`*^9, 
   3.636819802935937*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"grayscale", " ", "rendering", " ", "for", " ", "comparison"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"start", "=", "1"}], ";", 
    RowBox[{"end", "=", "n"}], ";", 
    RowBox[{"step", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"endofstep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Image3D", "[", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
               ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "//", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
              "\"\<result\\\\hurricane_cloud\\\\hurricane_cloud_\>\"", "<>", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
                ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", "#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], "&"}], ",", 
          "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6368195669533987`*^9, 3.6368195734707727`*^9}, 
   3.636819718308116*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"grayscale", " ", "rendering", " ", "for", " ", "comparison"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"start", "=", "1"}], ";", 
    RowBox[{"end", "=", "n"}], ";", 
    RowBox[{"step", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"endofstep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"j", ",", "endofstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Image3D", "[", 
            RowBox[{
             RowBox[{"precip", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "]"}], "&"}], 
               ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "endofstep"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "//", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
              "\"\<result\\\\hurricane_precip\\\\hurricane_precip_\>\"", "<>", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", "10", 
                ",", "2"}], "]"}], "<>", "\"\<.png\>\""}], ",", "#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], "&"}], ",", 
          "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.636819591928832*^9, 3.636819601224365*^9}, 
   3.636819725709507*^9}]
},
WindowSize->{1268, 696},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.92}},
Magnification:>1.1 Inherited,
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 577, 9, 213, "Input"],
Cell[1138, 31, 4113, 105, 253, "Input"],
Cell[5254, 138, 13976, 388, 733, "Input"],
Cell[CellGroupData[{
Cell[19255, 530, 3368, 100, 273, "Input"],
Cell[22626, 632, 196, 2, 33, "Output"]
}, Open  ]],
Cell[22837, 637, 1279, 35, 113, "Input"],
Cell[24119, 674, 226, 5, 53, "Input"],
Cell[CellGroupData[{
Cell[24370, 683, 13250, 300, 873, "Input"],
Cell[37623, 985, 97, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37757, 991, 4361, 105, 273, "Input"],
Cell[42121, 1098, 293, 4, 33, "Output"]
}, Open  ]],
Cell[42429, 1105, 3956, 107, 193, "Input"],
Cell[CellGroupData[{
Cell[46410, 1216, 4000, 106, 293, "Input"],
Cell[50413, 1324, 123, 1, 33, "Output"]
}, Open  ]],
Cell[50551, 1328, 8166, 194, 433, "Input"],
Cell[58720, 1524, 5577, 129, 353, "Input"],
Cell[64300, 1655, 1600, 47, 93, "Input"],
Cell[65903, 1704, 267, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[66195, 1714, 209, 5, 32, "Input"],
Cell[66407, 1721, 94, 1, 33, "Output"]
}, Open  ]],
Cell[66516, 1725, 1930, 59, 133, "Input"],
Cell[68449, 1786, 837, 25, 53, "Input"],
Cell[69289, 1813, 316, 7, 53, "Input"],
Cell[69608, 1822, 995, 31, 73, "Input"],
Cell[70606, 1855, 2552, 73, 113, "Input"],
Cell[73161, 1930, 3489, 104, 213, "Input"],
Cell[76653, 2036, 649, 12, 53, "Input"],
Cell[77305, 2050, 1028, 31, 73, "Input"],
Cell[78336, 2083, 2611, 75, 133, "Input"],
Cell[80950, 2160, 6187, 144, 473, "Input"],
Cell[87140, 2306, 237, 6, 53, "Input"],
Cell[87380, 2314, 1835, 50, 93, "Input"],
Cell[89218, 2366, 1556, 40, 73, "Input"],
Cell[90777, 2408, 1531, 40, 80, "Input"],
Cell[92311, 2450, 1556, 42, 102, "Input"],
Cell[93870, 2494, 332, 9, 58, "Input"],
Cell[94205, 2505, 451, 11, 35, "Input"],
Cell[94659, 2518, 2960, 74, 344, "Input"],
Cell[97622, 2594, 2465, 62, 278, "Input"],
Cell[100090, 2658, 2468, 62, 278, "Input"]
}
]
*)

(* End of internal cache information *)
