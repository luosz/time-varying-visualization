(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    157680,       3667]
NotebookOptionsPosition[    156359,       3626]
NotebookOutlinePosition[    156873,       3646]
CellTagsIndexPosition[    156830,       3643]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"filelist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\SmokeSim\\\\tif\\\\dsSmoke.\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.tif\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "499"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filelist", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<Image3D\>\""}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "500"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tf", "=", 
  RowBox[{
  "ColorData", "[", "\"\<RedGreenSplit\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tffilelist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "\"\<E:\\\\_time_varying_data\\\\SmokeSim\\\\DSSmokeSideways100500\\\\\
dsSmoke.\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"#", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.tfi\>\""}], 
      ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "499"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bincount", "=", "256"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "160"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"tffilelist", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<XML\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<intensity\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
          "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", "___"}], 
        "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbcolors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"r", ",", "g", ",", "b"}], "}"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"RGBColor", "/@", "#"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbfunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"intensity", ",", "rgbcolors"}], "}"}], "]"}], ",", " ", 
       "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "8", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.633890381433823*^9, 3.633890410291797*^9}, {
  3.6338904620572667`*^9, 3.6338905429775467`*^9}, {3.6338905939299307`*^9, 
  3.6338905962907705`*^9}, {3.635170507043296*^9, 3.6351705184660373`*^9}, {
  3.6351821730657578`*^9, 3.6351821757376356`*^9}, {3.635182211003361*^9, 
  3.635182252097193*^9}, {3.6356855485827875`*^9, 3.6356855488327866`*^9}, {
  3.635694720858083*^9, 3.6356947237799606`*^9}, {3.635702637497902*^9, 
  3.6357026555459228`*^9}, {3.6357845490593863`*^9, 3.6357845493093834`*^9}, {
  3.63579911941645*^9, 3.635799119763296*^9}, {3.6357993904331045`*^9, 
  3.6357993906518574`*^9}, {3.635799455690899*^9, 3.635799460382468*^9}, {
  3.635799508437855*^9, 3.635799557395273*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["ColorDataFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False}, 
    PanelBox[
     PaneSelectorBox[{False->GridBox[{
        {
         PaneBox[
          ButtonBox[
           
           DynamicBox[FEPrivate`FrontEndResource[
            "FEBitmaps", "SquarePlusIconMedium"],
            ImageSizeCache->{12., {0., 12.}}],
           Appearance->None,
           ButtonFunction:>(Typeset`open$$ = True),
           Evaluator->Automatic,
           Method->"Preemptive"],
          Alignment->{Center, Center},
          
          ImageSize->
           Dynamic[{
            Automatic, 3.5 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
             Magnification]}]], GridBox[{
           {
            RowBox[{
             TagBox["\<\"Name: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox["\<\"RedGreenSplit\"\>",
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Gradient: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              StyleBox[
               GraphicsBox[RasterBox[CompressedData["
1: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
Z43mZVbR/6rvZrxQmVoM4jTzSuqcOxX4D1dYN1E=
                 "], {{0, 0}, {1, 1}}],
                AspectRatio->NCache[
                  Rational[1, 8], 0.125],
                BaselinePosition->Bottom,
                ImageSize->65,
                PlotRange->{{0, 1}, {0, 1}}],
               Selectable->False,
               StripOnInput->False],
              "SummaryItem"]}]}
          },
          AutoDelete->False,
          
          BaseStyle->{
           ShowStringCharacters -> False, NumberMarks -> False, 
            PrintPrecision -> 3, ShowSyntaxStyles -> False},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}
       },
       AutoDelete->False,
       BaselinePosition->{1, 1},
       GridBoxAlignment->{"Rows" -> {{Top}}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True->GridBox[{
        {
         PaneBox[
          ButtonBox[
           
           DynamicBox[FEPrivate`FrontEndResource[
            "FEBitmaps", "SquareMinusIconMedium"]],
           Appearance->None,
           ButtonFunction:>(Typeset`open$$ = False),
           Evaluator->Automatic,
           Method->"Preemptive"],
          Alignment->{Center, Center},
          
          ImageSize->
           Dynamic[{
            Automatic, 3.5 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
             Magnification]}]], GridBox[{
           {
            RowBox[{
             TagBox["\<\"Name: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox["\<\"RedGreenSplit\"\>",
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Gradient: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              StyleBox[
               GraphicsBox[RasterBox[CompressedData["
1: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
Z43mZVbR/6rvZrxQmVoM4jTzSuqcOxX4D1dYN1E=
                 "], {{0, 0}, {1, 1}}],
                AspectRatio->NCache[
                  Rational[1, 8], 0.125],
                BaselinePosition->Bottom,
                ImageSize->65,
                PlotRange->{{0, 1}, {0, 1}}],
               Selectable->False,
               StripOnInput->False],
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Domain: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}],
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Class: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox["\<\"Gradients\"\>",
              "SummaryItem"]}]}
          },
          AutoDelete->False,
          
          BaseStyle->{
           ShowStringCharacters -> False, NumberMarks -> False, 
            PrintPrecision -> 3, ShowSyntaxStyles -> False},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}
       },
       AutoDelete->False,
       BaselinePosition->{1, 1},
       GridBoxAlignment->{"Rows" -> {{Top}}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, Dynamic[
      Typeset`open$$],
      ImageSize->Automatic],
     BaselinePosition->Baseline],
    DynamicModuleValues:>{}], "]"}],
  ColorDataFunction[
  "RedGreenSplit", "Gradients", {0, 1}, Blend["RedGreenSplit", #]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.635685580332896*^9, 3.6356869537373075`*^9, 
  3.635687069487567*^9, 3.6356877265046196`*^9, 3.635688474881611*^9, 
  3.6356937131340575`*^9, 3.635694475645793*^9, 3.6356947448268676`*^9, 
  3.635695264777503*^9, 3.635702733573598*^9, 3.635704560011611*^9, 
  3.6357046917272577`*^9, 3.6357048040787077`*^9, 3.6357049390078807`*^9, 
  3.6357051162937355`*^9, 3.6357055236445704`*^9, 3.635772248753092*^9, 
  3.6357979546128187`*^9, 3.635798016487506*^9, 3.635798744891463*^9, 
  3.635799144201305*^9, 3.6357992982139235`*^9, 3.6357995802507935`*^9, 
  3.635799624811185*^9, 3.635800019995581*^9, 3.6358002163683987`*^9, 
  3.635800356009491*^9, 3.6358005717348957`*^9, 3.6358017909690924`*^9, 
  3.6358019964852247`*^9, 3.635802241517043*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", 
     RowBox[{"d", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"HistogramList", "[", 
    RowBox[{"a", ",", "bincount"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensityfunction", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{"1.", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"h", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sum", ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"h", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hist", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FirstPosition", "[", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "<", "#"}], "&"}], ")"}]}]}], "]"}]}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probability", "[", "i_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "/", "sum"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"entropy", "[", "i_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "p", "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"probability", "[", "i", "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", "\[NotEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{"-", "p"}], "*", 
         RowBox[{"Log", "[", "p", "]"}]}], ",", "0"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "t", "}"}], ",", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"entropy", "[", "#", "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "!=", "0"}], ",", 
           RowBox[{"1.", "/", "t"}], ",", "0"}], "]"}]}]}], "]"}], "&"}], "/@",
      "intensityfunction"}], "//", "Rescale"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"entropy", "[", "#", "]"}], "&"}], "/@", "intensityfunction"}], 
    "//", "Rescale"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"d", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"std", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "list"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", "std", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numofbins", "=", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"h", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bins", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"h", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sumstd", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"h", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", "numofbins"}], "]"}], "+", 
       "1"}]}], ";", 
     RowBox[{
      RowBox[{"bins", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "++"}], ";", 
     RowBox[{
      RowBox[{"sumstd", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "+=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stds", "=", 
   RowBox[{"sumstd", "/", "bins"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"volatility", "[", "i_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"stds", "[", 
     RowBox[{"[", 
      RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temporalentropy", "[", "i_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "p", "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"volatility", "[", "i", "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", "\[NotEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{"-", "p"}], "*", 
         RowBox[{"Log", "[", "p", "]"}]}], ",", "0"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "t", "}"}], ",", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"temporalentropy", "[", "#", "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "!=", "0"}], ",", 
           RowBox[{"1.", "/", "t"}], ",", "0"}], "]"}]}]}], "]"}], "&"}], "/@",
      "intensityfunction"}], "//", "Rescale"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"temporalentropy", "[", "#", "]"}], "&"}], "/@", 
     "intensityfunction"}], "//", "Rescale"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6356885318036385`*^9, 3.6356885363349037`*^9}, 
   3.635688591085059*^9, 3.6356952890431895`*^9, 3.6356977383663282`*^9, {
   3.6357022625514545`*^9, 3.6357022818189287`*^9}, 3.6357026914010925`*^9, {
   3.635703956880822*^9, 3.63570395805274*^9}, {3.6357040496935463`*^9, 
   3.635704050599853*^9}, {3.635704772569888*^9, 3.635704772891966*^9}, 
   3.635705497367609*^9, {3.6357057416037755`*^9, 3.635705791119528*^9}, {
   3.635705849588411*^9, 3.635705865885321*^9}, {3.6357059171198483`*^9, 
   3.63570592354171*^9}, {3.6357845314352293`*^9, 3.635784597169468*^9}, {
   3.6357846632934027`*^9, 3.6357847055890837`*^9}, {3.6357847384431024`*^9, 
   3.6357848086848707`*^9}, {3.635784848801886*^9, 3.6357848667377377`*^9}, {
   3.6357848994649534`*^9, 3.635784945185487*^9}, {3.635785061417362*^9, 
   3.6357850670760107`*^9}, {3.6357851069886103`*^9, 
   3.6357851718477154`*^9}, {3.6357852198049564`*^9, 3.6357852377397895`*^9}, 
   3.6357853674974375`*^9, 3.635785446365835*^9, {3.635790052904509*^9, 
   3.635790053906294*^9}, 3.6357902309623737`*^9, {3.6357903182908792`*^9, 
   3.63579034318392*^9}, {3.635790748279696*^9, 3.6357907484671955`*^9}, {
   3.6357909507473636`*^9, 3.6357909731375494`*^9}, {3.6357911474515367`*^9, 
   3.635791223465116*^9}, {3.6357914015012493`*^9, 3.6357914236726446`*^9}, {
   3.635791463672619*^9, 3.6357914712429934`*^9}, {3.6357915178711863`*^9, 
   3.635791533409438*^9}, {3.635792230165406*^9, 3.635792328404942*^9}, {
   3.635792501808595*^9, 3.6357925041765857`*^9}, 3.6357928674977617`*^9, 
   3.635792961015156*^9, {3.6357930053154154`*^9, 3.635793059963599*^9}, {
   3.6357940272526693`*^9, 3.635794046495702*^9}, {3.6357942438205223`*^9, 
   3.6357942504903784`*^9}, {3.635795286424201*^9, 3.635795286627323*^9}, {
   3.6357959706653905`*^9, 3.6357959712122707`*^9}, {3.6357968435226355`*^9, 
   3.6357968437257566`*^9}, {3.6357973378911867`*^9, 3.6357973382349114`*^9}, 
   3.6357980137843933`*^9, {3.63579873513023*^9, 3.6357987355364866`*^9}, {
   3.6357991145626764`*^9, 3.6357991167269306`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"h", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "20000"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"GrayLevel", "[", "#", "]"}], "&"}], ")"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "\"\<intensity histogram\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "stds"}], "}"}], "]"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"GrayLevel", "[", "#", "]"}], "&"}], ")"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "\"\<volatility histogram\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"intensityfunction", ",", "op2"}], "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
   RowBox[{
   "PlotLegends", "\[Rule]", "\"\<intensity transfer function\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
   RowBox[{
   "PlotLegends", "\[Rule]", 
    "\"\<inverted intensity transfer function\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"intensityfunction", ",", "op4"}], "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
   RowBox[{
   "PlotLegends", "\[Rule]", "\"\<volatility transfer function\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"intensityfunction", ",", "op3"}], "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
   RowBox[{
   "PlotLegends", "\[Rule]", 
    "\"\<inverted volatility transfer function\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.635792348379642*^9, 3.635792441369423*^9}, {
  3.6357924767473392`*^9, 3.6357924792018375`*^9}, {3.635792886391177*^9, 
  3.6357928926952143`*^9}, {3.635793085239197*^9, 3.635793105197216*^9}, {
  3.635793710455142*^9, 3.635793711447276*^9}, {3.635794065207861*^9, 
  3.63579407272402*^9}, {3.635794273675841*^9, 3.6357942766527524`*^9}, {
  3.635794325161895*^9, 3.635794328367172*^9}, {3.635794397972642*^9, 
  3.6357943998869076`*^9}, {3.6357994687312965`*^9, 3.635799472242732*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, 
     GraphicsComplexBox[CompressedData["
1:eJxdl0tsVGUUx29cNU1MWHTBwuCwwx0JLljYeDZqXWkHK9IHvTNTpqWW9lKK
j7Ykl2qrYqKIXVgTySUQ0UgaCBgrEXMtIoqgxaqtPKc8irQ8uqlx4cLee37n
m+hNmuY33+uc/++7k8zKfFd20wOe551Z+kv+/+d5c1L6qkafmunteTzBsOI0
/HrK3vy4jK0YnK8deydleew848M6XnlCPhxJH+W3jzN/r/LwmNypTT7Zp/t/
Ns76Azr+6CGpnNofVFceVI4Ost+nymuOyiON744vrjqk/M9e9h9V7v9IDiyt
ntp/WPnSCOcdUR76WNakz1Hlh4Y5/xjr98jJxVVLJ3yu/MJ71POFskSS1QOV
1+6ivi+VV++Smd5kw+OMj1DvV8ofDMnWpLzghPInQ9T/tfKyQVERsfLf79MP
vHpAatIDvlEee43+4LUDkpy2dKSyt4d+TyrXDEjazhRcCun/W+Xp3fJwUs6K
U8qZHeQBL/RLMX2+Y/0O8jmt/OxbkuxWNQpP9JLX99TTJ38l2y3Cy14lvx+U
K96QNJ7qM8rhy+QJey9JWt7gj8wfIt+zysF2OXc2fbg/3eR9Tnl3t6TtVv2k
vHwn+cMLWyXdrvFn6gvwMUG/O+kH9rrwA2cC+oMlwNd5l7f2C0sn/mAvoP9f
6L8Dn/B0SB6wH+B3UjnuIp9Jl7f6hqMXyetX15/6h6N28oPDPu7Db3AbecKZ
Du4HLB3k+zvnv8J9gaWVvOFMK/dnin56yd+4jftkXMTHNPW04GPa3Q/1UR5X
H3BmEz7+cPupD1i24wPOFPFxAX8FfMATPfi44PpTHxfZv4CPi269tgtHPfi4
5OarD7iUxwccbcPHZerL4wOOC/i47PZTH1e439vwccWtVx9wlMPHVfrJ4+Oq
e3/UBxzn8FFivwL9wGE3fuBSjv5sfgu+yuPaL+x34884R/8zsI9POCyQh3GA
3xm3XvMxzuMbngjI6xr9NeAf9nzyg8NG7gNc6iLP8riWd82dr/leJ98m7st1
9z5p3rDXwP0xbiJ/407uExw24OMG9TfjA/Y24sPGt+ADzuTwYfOb8QH7W/Bx
w+WhPm7COXzA0oAPONOJj5uuH/Vh8+vxAcdN+Jh1/aqPWdev+jBuxgccmQ9j
Hx+zrj71cet/Pm6570f1YePN+CjPVx9wvB4fsN+Ojz+pbyM+4LgeH3C0GR82
fz0+YK8eH7a+Dh+2vh0ft939VR+3Xb7qw7gRH8at+DDegA+45ONjDp/t+DC2
92PO7a8+5pwv9QH7m/Fh89fhY97dV/UBx0V82PgGfMy7PNQHHK7Dh3ELPu64
fNVHmdUHLM/hA/ba8GFchw9bbz7gqIiPu9SXxQcsdfiAvRp83HX3VX3Y+PP4
MM7i4x7nZ/EBey34gONafNj8Wnzcc9+H6qM8X33cZ/4z+IC9p/Fx3/WvPowF
Hzb/SXwYP4GPBeWKUKr3Pdi/vEZ/fyS/R/4FvZf4eA==
      "], {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.01388888888888889], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[{202, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
           18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
           35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51,
           52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68,
           69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,
           86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
          102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 
          115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 
          128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
          141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 
          154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 
          167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 
          180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
          193, 194, 195, 196, 197, 198, 199, 200, 201}, VertexColors -> 
          Automatic]}}}, VertexColors -> CompressedData["
1:eJxF0DtMk1EYxvG6krh1cMK44ezcvKOsMDOR6ComTOgoqy4uMpAQSIiJaTRq
RKMGrAhWwN6/3vvd7xeXOtvv9J94lhZ63vM8v/fW+oPVe9cKhUK18P88Kpbv
GlubMv98IkeL29HK0VP+fi47L9Th/7sSr+Tf9vj9QBa0/Y3SwiH3XsrttWff
pkuvuF+Wg9mv2v5r5t7IHXXeMv9OKtOl2cR73vkgq/NB3vsoxlZ+8RPvfpaH
+XMbX3j/q8wVx+Qcy7IaOCHvRPKp2Si5FVExWoX873Izf2bxlB6ncl+dH/Q5
k/xWsXxGr3P5m1+bntPvp6g6pSo9q6Ke2/5F3wu5vFCH3peiYotX9L8SdW3t
N44aOTU8NfJquOrk1vHVyW/gbNCjgbdJnybuJr1a+Fv0a7GHNj3b7KNN3w57
6dC7w340+mvsScPRxdHF0cXRxdHD0cPRw9HH0cfRxzHAMcAxwDHEMcQxxDHC
McIxwjHGMcYxxjHBMcExwaGTo+PRydNx6eTq+HTyDZwGPQy8Bn0M3Aa9TPwm
/Uz2YNLTZB8mfS32YtHbYj8W/S32ZOGwcdg4bBw2DhuHjcPG4eBwcDg4HBwO
DgeHi8PF4eJwcbg4XBweDg+Hh8PD4eHwcPg4fBw+Dh+Hj8PH4eMIcAQ4AhwB
jgBHgCPEEeIIcYQ4QhwhjghHhCPCEeGIcEQ4YhwxjhhHjCPGEeOIcSQ4EhwJ
jgRHgiPBkeJIcaQ4UhwpjhRHhiPDkeHIcGQ4Mhx/pLR3/fGN5U35B3PEHYQ=

       "]], {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     AxesOrigin -> {0, 0}, PlotRange -> {{0, 1}, {0, 20000}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0, 1}, {0, 20000}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"intensity histogram\"", TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.6357923942116766`*^9, {3.6357924243448954`*^9, 3.635792442632284*^9}, 
   3.635792480742041*^9, 3.6357925289885664`*^9, {3.6357930939687786`*^9, 
   3.63579310613472*^9}, {3.635793428809909*^9, 3.6357934530109234`*^9}, 
   3.6357937123243666`*^9, 3.635794081274702*^9, 3.6357942775903015`*^9, 
   3.635794329125631*^9, 3.6357944015147047`*^9, 3.635795312851101*^9, 
   3.6357960861303663`*^9, 3.635796875780998*^9, 3.6357974959540577`*^9, 
   3.635799594310619*^9, 3.635801933578828*^9, 3.6358019669695325`*^9, 
   3.6358020252822065`*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, 
     GraphicsComplexBox[CompressedData["
1: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
/B/yfyOx+Jo=
      "], {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.01388888888888889], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
          18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
          35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
          52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
          69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
          86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
          102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 
          115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 
          128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
          141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 
          154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 
          167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 
          180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
          193, 194, 195, 196, 197, 198, 199, 200, 201}, VertexColors -> 
          Automatic]}}}, VertexColors -> CompressedData["
1:eJxF0DtMk1EYxvG6MnfGuOHMTN5RV5iZSGQFEyZcZdXFRQcSAokxIQ1EjWDU
gBW5Q+9f7/3u94tLne13+k88Sws973me3/toZW3p2YNCoXBZ+H9eFEtPjM0N
mX6+lKPZrWjx6BV/v5F3b9Xh/9sSL+bfdvh9T2a03fWFmffc+yCPl1//HM/t
c78ke5Nftd0D5g5lXp2PzH+S8nhuMvGZd77I0nSQ947F2MwvfuXdb/I8f279
O+//kKnihJwTeaoGTsk7lXxqMkpuWVSMVib/lzzMn5k9o8eZrKrzmz7nkt8q
ls7pdSF/82vjC/pdiqqzcEXPK1HPbV3T90Zub9Sh962o2OId/e9EXVu+x1Eh
p4KnQl4FV5XcKr4q+TWcNXrU8NbpU8ddp1cDf4N+DfbQpGeTfTTp22IvLXq3
2I9Gf409aTjaONo42jjaODo4Ojg6OLo4uji6OHo4ejh6OPo4+jj6OAY4BjgG
OIY4hjiGOEY4RjhGOHRydDw6eTounVwdn06+gdOgh4HXoI+B26CXid+kn8ke
THqa7MOkr8VeLHpb7Meiv8WeLBw2DhuHjcPGYeOwcdg4HBwODgeHg8PB4eBw
cbg4XBwuDheHi8PD4eHwcHg4PBweDh+Hj8PH4ePwcfg4fBwBjgBHgCPAEeAI
cIQ4QhwhjhBHiCPEEeGIcEQ4IhwRjghHjCPGEeOIccQ4YhwxjgRHgiPBkeBI
cCQ4UhwpjhRHiiPFkeLIcGQ4MhwZjgxHhuOP/AOJsRsJ
       "]], {}}, {DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 1.}, {0, 0.06243872549019604}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, 
     PlotRange -> {{0, 1.}, {0, 0.06243872549019604}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"volatility histogram\"", TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.6357923942116766`*^9, {3.6357924243448954`*^9, 3.635792442632284*^9}, 
   3.635792480742041*^9, 3.6357925289885664`*^9, {3.6357930939687786`*^9, 
   3.63579310613472*^9}, {3.635793428809909*^9, 3.6357934530109234`*^9}, 
   3.6357937123243666`*^9, 3.635794081274702*^9, 3.6357942775903015`*^9, 
   3.635794329125631*^9, 3.6357944015147047`*^9, 3.635795312851101*^9, 
   3.6357960861303663`*^9, 3.635796875780998*^9, 3.6357974959540577`*^9, 
   3.635799594310619*^9, 3.635801933578828*^9, 3.6358019669695325`*^9, 
   3.6358020253290644`*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, 
     GraphicsComplexBox[CompressedData["
1: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
      "], {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.01388888888888889], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
          18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
          35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
          52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
          69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
          86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
          102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 
          115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 
          128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
          141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 
          154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 
          167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 
          180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
          193, 194, 195, 196, 197, 198, 199, 200, 201}, VertexColors -> 
          Automatic]}}}, VertexColors -> CompressedData["
1:eJx12As0VdkfB3CFGGGQShOmh0Ip/JHHxJbnRKMYIxkhoYfnpAkxoWHo7xUJ
vSSURxLKdfNXuJI8R/J+X68b7osyUWLuuf/pnPW/v3+/tSxrfdax9z7n7vvd
P2ezq6+N+0o+Pr56zg8/35erZk7JMYFSiv6/1wK3IctHTlu3fuH6DuCaGlj1
fWGcYeCru7L89EVGvzD+OPBg6UJz6vk3X5h3GjjdGpuYAfy/xUbB8mTr6YgL
iNdXt2d46wllA99qE0meli8BrsetcuAqie+PPt9RDfw7wbZ0Tx3e581GZkEF
Q1Jm9cB/YvyxqfzHZuAlRVjxfj5sRJ6Ss44oawNeqRAzc/hZO/AXTvOJO2s7
gd+4G7IpsaUbeF8vt4DLSuheVaD1A3c0TT3o83YQuNXTDwL9obz7go3oXcoj
fH9QgcfO2lduix2Bz1ks+qZFEu8+YqMmxbIg37Qx4F5GE3bJ6bz7i41Ej67V
fJI9AbwgwERyMJ+Ge0JT5wNrCgv1OlnctPUn9qPAhjpx9mkWYtWe6l2/ZRL3
8+5lvvFrWEhw1yWZvlbCWcU5rSoVTPRNcq5deugU7m5LqeqNbkyk+rEu+dhu
Yl/3WkQnnRJjIhNXWpvCAOGHUgPfCpEY6Ej9Ksk3MXTca0dP2t5zYiAfte0H
7+sR3wM9tSOlJkIM9HuqaZzPJOFFIfvXjT6ko2tLbo3qaUzct9XrBoTb01Gh
e8RXc2Ys3K+v3dH97Qo6qmnKMifPEa67+/AjI8HP62Pjfm2NUqfc8iTwhXms
3gA/Mli/sX2WBvxJzXWDh/QJ4BvyPI/9e2IceFD83gj34THgvf5iOYa9o8D1
uBOPAMdm/auZCnxxa9jXbXXDwMulMt0cfh+C6xkwzpcIGACumzvOenG6D/j8
mSit35x6gJP1lYM1bLqABwo3Vk2adgDXfu21KkP3NfC/bokfsNv1CrjXK5et
G4xagNM9sgsjlRuAn16k6c5KvAA+xUkXp/lqeL/qDiRT4We4i5q2p8SWhqO6
8Ixtksf/g/tda3O/pp/TkW3bRHL/UzLuroZJFqeYeWhkyy6BXBkS7gueYbvP
HS5Bfv5YPcK9qoxb6FPNkxGDliLco/lZhgvrn6J1ynzZ0jYFuOcqrnGX21uN
1BpiL94XysE9trlQ2YBegw54bjhm9PQO7n7+Fkynmy9Qk8yB0JLxNNxtN0yU
hB6oR8KkhsCqO7G4a1eGB2QsNqLhyXeNvsPeuG/EZi1owZ/TZ685XXJFfOsr
4J9uS1jZq74GvrfDRzjzO95zmo1CRJop0+ZdwCvQzt+0bHuAL569pB3qwnuu
c8bPp8289BqA4w+ZFkgFDQF3ErHRKKTAvF9SCJd4/RLmfToqYrxvgXlv4DDU
INsB837wrHjuvj6Y9+cT9CM9qDDvv8n3co2hwbwvf36DMzMNOHfat7z9Bxt9
WMBqEvh1aeUueT7evoTTL6jaPzZeRQfeuz8q8aQob7/CWb8bySdOignXHzpu
WSJD5K6Zx3SnEpWF76PPfs+yYoG/jwl8lXqc7FA7A/iJdU6ovIUOvO7jbter
L2GuK1KXI/woU8CjXrTmWFbAvKfdv9OwnQTz3jzxDGNFEcz7nHPGEgN5MO/F
HaU1yFkw7332jf905RbM+5btpECfVJj3u0WjbuxPhHkfz+mWFGJg3jM5T3k5
Aub9TewY/jQI3NH46g9eM/3AZcW1r2wZ7wXe380tOH7WeXlO7wHH95F1M61q
By6n+yzv46M24AP8LljrgXs3N68CkajBL9ldIkTeCz7HcvIyUkzrGCI5NOLe
wc3nG8hoVndjSv5L3NtuGz+e+ZiJHA+k2/36oRb38iVSh4NZLgq4tzLJ1qIG
98yjO97XXH6AkvhONGtcr8LddNAqNsW7GNmXpkhubyfOgSdxwnKNUo9R/Cnn
6DF/Iu9V9CkPlstI6Lmc0nLmmmLcM+jBBppHnyB2FnWa4kHkt/RNrT9PrqxA
ZBksl6/hHmDJcr6V8wyFHcLOGx/cKc6tYjIsCvj+GXHPhTrgFM397w02NcLr
bwt6ten8CZwqcIxdkgtzfbNeZf7iY5jrLr5y7mbVMNfvZAd/e7kZ5vpwD7eA
b/paJ3nrBMx1F5MUK+9ZmOsZQe+Ey5ZgrvsdzjsWJgjzW+JMt8Hd1TC/i2KF
ZBskYX4fytmzwFwP85td7d65Rh7m9+X+5Ec6CjC/1Ti76ugOmN+tkm+9L6rB
/PZT2WKZswfmt4S5tVLT3im4fs7dzhjBXJcJGfn+4Voi1+uX/+VxrYmFMlVn
aRLehD9KwxphFto5uiLqzHPCM9XfTUr5MhEJ2/YbiXMgrqH9/sEqBjK02Fyr
5U944PFS71hJBmr8pOaW2kC46+JV1XpXOrIrNuRf2EycGz9cPTcj+HgaDbsd
ynQIIlznn37dU8ZlX0Ur4VvqtH8NtZtCc5zuRE6JOGfEXGS0K3ImUVgoVoTP
/9PHr9ZIkKd2Ej6S2FOuZQHzXsdkY6WqN8z7NGU6VeQEzPt58acCEy4w7+3f
xSlWO8C8J/dg/6DBvJfhzBpgBfM+MJvvss33MO+7L70q2WUE8/6XQZP7koEw
79XzJth1njDvZ/yj91xwhnlfbLAjRPNHIu+X/fRFurKK0MVewxyxs8T1x7nv
OWoQY4BbuJthr0WkW1AB9++Idfpz35e0I7vZmG2V9sT9jnHfi/Qg0bPYBMRz
s0ugzCk5DqGq/3n/wkZuHliNoHMBWBGfl1zkNGekcbRzoTbJWYU45zux1zpd
NDR8HlsA0RfEY8MnTKGURdd61RSiv8BWX2jOQJYXisfWW/L2KcTvvwGUK+gE

       "]], {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     AxesOrigin -> {0, 0}, PlotRange -> {{0, 1}, {0, 1}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0, 1}, {0, 1}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"intensity transfer function\"", TraditionalForm], 
    TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.6357923942116766`*^9, {3.6357924243448954`*^9, 3.635792442632284*^9}, 
   3.635792480742041*^9, 3.6357925289885664`*^9, {3.6357930939687786`*^9, 
   3.63579310613472*^9}, {3.635793428809909*^9, 3.6357934530109234`*^9}, 
   3.6357937123243666`*^9, 3.635794081274702*^9, 3.6357942775903015`*^9, 
   3.635794329125631*^9, 3.6357944015147047`*^9, 3.635795312851101*^9, 
   3.6357960861303663`*^9, 3.635796875780998*^9, 3.6357974959540577`*^9, 
   3.635799594310619*^9, 3.635801933578828*^9, 3.6358019669695325`*^9, 
   3.6358020253915734`*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, 
     GraphicsComplexBox[CompressedData["
1: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
89DIPWddUl6yRn4f/wfJeTmT
      "], {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.01388888888888889], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
          18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
          35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
          52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
          69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
          86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
          102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 
          115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 
          128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
          141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 
          154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 
          167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 
          180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
          193, 194, 195, 196, 197, 198, 199, 200, 201}, VertexColors -> 
          Automatic]}}}, VertexColors -> CompressedData["
1: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

       "]], {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     AxesOrigin -> {0, 0}, PlotRange -> {{0, 1}, {0, 1}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0, 1}, {0, 1}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"inverted intensity transfer function\"", TraditionalForm], 
    TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.6357923942116766`*^9, {3.6357924243448954`*^9, 3.635792442632284*^9}, 
   3.635792480742041*^9, 3.6357925289885664`*^9, {3.6357930939687786`*^9, 
   3.63579310613472*^9}, {3.635793428809909*^9, 3.6357934530109234`*^9}, 
   3.6357937123243666`*^9, 3.635794081274702*^9, 3.6357942775903015`*^9, 
   3.635794329125631*^9, 3.6357944015147047`*^9, 3.635795312851101*^9, 
   3.6357960861303663`*^9, 3.635796875780998*^9, 3.6357974959540577`*^9, 
   3.635799594310619*^9, 3.635801933578828*^9, 3.6358019669695325`*^9, 
   3.635802025438427*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, 
     GraphicsComplexBox[CompressedData["
1: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
      "], {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.01388888888888889], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
          18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
          35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
          52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
          69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
          86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
          102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 
          115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 
          128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
          141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 
          154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 
          167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 
          180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
          193, 194, 195, 196, 197, 198, 199, 200, 201}, VertexColors -> 
          Automatic]}}}, VertexColors -> CompressedData["
1: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

       "]], {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     AxesOrigin -> {0, 0}, PlotRange -> {{0, 1}, {0, 1}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0, 1}, {0, 1}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"volatility transfer function\"", TraditionalForm], 
    TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.6357923942116766`*^9, {3.6357924243448954`*^9, 3.635792442632284*^9}, 
   3.635792480742041*^9, 3.6357925289885664`*^9, {3.6357930939687786`*^9, 
   3.63579310613472*^9}, {3.635793428809909*^9, 3.6357934530109234`*^9}, 
   3.6357937123243666`*^9, 3.635794081274702*^9, 3.6357942775903015`*^9, 
   3.635794329125631*^9, 3.6357944015147047`*^9, 3.635795312851101*^9, 
   3.6357960861303663`*^9, 3.635796875780998*^9, 3.6357974959540577`*^9, 
   3.635799594310619*^9, 3.635801933578828*^9, 3.6358019669695325`*^9, 
   3.635802025485318*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, 
     GraphicsComplexBox[CompressedData["
1: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
      "], {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.01388888888888889], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
          18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
          35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
          52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
          69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
          86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
          102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 
          115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 
          128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
          141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 
          154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 
          167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 
          180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
          193, 194, 195, 196, 197, 198, 199, 200, 201}, VertexColors -> 
          Automatic]}}}, VertexColors -> CompressedData["
1:eJx12As0VdkfB3CFGGGQShOmh0Ip/JHHxJbnRKMYIxkhoYfnpAkxoWHo7xUJ
vSSURxLKdfNXuJI8R/J+X68b7osyUWLuuf/pnPW/v3+/tSxrfdax9z7n7vvd
P2ezq6+N+0o+Pr56zg8/35erZk7JMYFSiv6/1wK3IctHTlu3fuH6DuCaGlj1
fWGcYeCru7L89EVGvzD+OPBg6UJz6vk3X5h3GjjdGpuYAfy/xUbB8mTr6YgL
iNdXt2d46wllA99qE0meli8BrsetcuAqie+PPt9RDfw7wbZ0Tx3e581GZkEF
Q1Jm9cB/YvyxqfzHZuAlRVjxfj5sRJ6Ss44oawNeqRAzc/hZO/AXTvOJO2s7
gd+4G7IpsaUbeF8vt4DLSuheVaD1A3c0TT3o83YQuNXTDwL9obz7go3oXcoj
fH9QgcfO2lduix2Bz1ks+qZFEu8+YqMmxbIg37Qx4F5GE3bJ6bz7i41Ej67V
fJI9AbwgwERyMJ+Ge0JT5wNrCgv1OlnctPUn9qPAhjpx9mkWYtWe6l2/ZRL3
8+5lvvFrWEhw1yWZvlbCWcU5rSoVTPRNcq5deugU7m5LqeqNbkyk+rEu+dhu
Yl/3WkQnnRJjIhNXWpvCAOGHUgPfCpEY6Ej9Ksk3MXTca0dP2t5zYiAfte0H
7+sR3wM9tSOlJkIM9HuqaZzPJOFFIfvXjT6ko2tLbo3qaUzct9XrBoTb01Gh
e8RXc2Ys3K+v3dH97Qo6qmnKMifPEa67+/AjI8HP62Pjfm2NUqfc8iTwhXms
3gA/Mli/sX2WBvxJzXWDh/QJ4BvyPI/9e2IceFD83gj34THgvf5iOYa9o8D1
uBOPAMdm/auZCnxxa9jXbXXDwMulMt0cfh+C6xkwzpcIGACumzvOenG6D/j8
mSit35x6gJP1lYM1bLqABwo3Vk2adgDXfu21KkP3NfC/bokfsNv1CrjXK5et
G4xagNM9sgsjlRuAn16k6c5KvAA+xUkXp/lqeL/qDiRT4We4i5q2p8SWhqO6
8Ixtksf/g/tda3O/pp/TkW3bRHL/UzLuroZJFqeYeWhkyy6BXBkS7gueYbvP
HS5Bfv5YPcK9qoxb6FPNkxGDliLco/lZhgvrn6J1ynzZ0jYFuOcqrnGX21uN
1BpiL94XysE9trlQ2YBegw54bjhm9PQO7n7+Fkynmy9Qk8yB0JLxNNxtN0yU
hB6oR8KkhsCqO7G4a1eGB2QsNqLhyXeNvsPeuG/EZi1owZ/TZ685XXJFfOsr
4J9uS1jZq74GvrfDRzjzO95zmo1CRJop0+ZdwCvQzt+0bHuAL569pB3qwnuu
c8bPp8289BqA4w+ZFkgFDQF3ErHRKKTAvF9SCJd4/RLmfToqYrxvgXlv4DDU
INsB837wrHjuvj6Y9+cT9CM9qDDvv8n3co2hwbwvf36DMzMNOHfat7z9Bxt9
WMBqEvh1aeUueT7evoTTL6jaPzZeRQfeuz8q8aQob7/CWb8bySdOignXHzpu
WSJD5K6Zx3SnEpWF76PPfs+yYoG/jwl8lXqc7FA7A/iJdU6ovIUOvO7jbter
L2GuK1KXI/woU8CjXrTmWFbAvKfdv9OwnQTz3jzxDGNFEcz7nHPGEgN5MO/F
HaU1yFkw7332jf905RbM+5btpECfVJj3u0WjbuxPhHkfz+mWFGJg3jM5T3k5
Aub9TewY/jQI3NH46g9eM/3AZcW1r2wZ7wXe380tOH7WeXlO7wHH95F1M61q
By6n+yzv46M24AP8LljrgXs3N68CkajBL9ldIkTeCz7HcvIyUkzrGCI5NOLe
wc3nG8hoVndjSv5L3NtuGz+e+ZiJHA+k2/36oRb38iVSh4NZLgq4tzLJ1qIG
98yjO97XXH6AkvhONGtcr8LddNAqNsW7GNmXpkhubyfOgSdxwnKNUo9R/Cnn
6DF/Iu9V9CkPlstI6Lmc0nLmmmLcM+jBBppHnyB2FnWa4kHkt/RNrT9PrqxA
ZBksl6/hHmDJcr6V8wyFHcLOGx/cKc6tYjIsCvj+GXHPhTrgFM397w02NcLr
bwt6ten8CZwqcIxdkgtzfbNeZf7iY5jrLr5y7mbVMNfvZAd/e7kZ5vpwD7eA
b/paJ3nrBMx1F5MUK+9ZmOsZQe+Ey5ZgrvsdzjsWJgjzW+JMt8Hd1TC/i2KF
ZBskYX4fytmzwFwP85td7d65Rh7m9+X+5Ec6CjC/1Ti76ugOmN+tkm+9L6rB
/PZT2WKZswfmt4S5tVLT3im4fs7dzhjBXJcJGfn+4Voi1+uX/+VxrYmFMlVn
aRLehD9KwxphFto5uiLqzHPCM9XfTUr5MhEJ2/YbiXMgrqH9/sEqBjK02Fyr
5U944PFS71hJBmr8pOaW2kC46+JV1XpXOrIrNuRf2EycGz9cPTcj+HgaDbsd
ynQIIlznn37dU8ZlX0Ur4VvqtH8NtZtCc5zuRE6JOGfEXGS0K3ImUVgoVoTP
/9PHr9ZIkKd2Ej6S2FOuZQHzXsdkY6WqN8z7NGU6VeQEzPt58acCEy4w7+3f
xSlWO8C8J/dg/6DBvJfhzBpgBfM+MJvvss33MO+7L70q2WUE8/6XQZP7koEw
79XzJth1njDvZ/yj91xwhnlfbLAjRPNHIu+X/fRFurKK0MVewxyxs8T1x7nv
OWoQY4BbuJthr0WkW1AB9++Idfpz35e0I7vZmG2V9sT9jnHfi/Qg0bPYBMRz
s0ugzCk5DqGq/3n/wkZuHliNoHMBWBGfl1zkNGekcbRzoTbJWYU45zux1zpd
NDR8HlsA0RfEY8MnTKGURdd61RSiv8BWX2jOQJYXisfWW/L2KcTvvwGUK+gE

       "]], {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     AxesOrigin -> {0, 0}, PlotRange -> {{0, 1}, {0, 1}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0, 1}, {0, 1}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"inverted volatility transfer function\"", TraditionalForm], 
    TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.6357923942116766`*^9, {3.6357924243448954`*^9, 3.635792442632284*^9}, 
   3.635792480742041*^9, 3.6357925289885664`*^9, {3.6357930939687786`*^9, 
   3.63579310613472*^9}, {3.635793428809909*^9, 3.6357934530109234`*^9}, 
   3.6357937123243666`*^9, 3.635794081274702*^9, 3.6357942775903015`*^9, 
   3.635794329125631*^9, 3.6357944015147047`*^9, 3.635795312851101*^9, 
   3.6357960861303663`*^9, 3.635796875780998*^9, 3.6357974959540577`*^9, 
   3.635799594310619*^9, 3.635801933578828*^9, 3.6358019669695325`*^9, 
   3.6358020255321755`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opacityfunction", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgba", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"List", "@@", 
        RowBox[{"rgbfunction", "[", "#", "]"}]}], ",", 
       RowBox[{"opacityfunction", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
    "intensityfunction"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"RGBColor", "/@", "rgba"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorfunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"intensityfunction", ",", "colors"}], "}"}], "]"}], ",", " ",
        "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "colorfunction"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.635793360004868*^9, 3.635793388225378*^9}, 
   3.635793421483656*^9, {3.635793465300071*^9, 3.6357935423092732`*^9}, {
   3.635793579680519*^9, 3.6357936708909965`*^9}, 3.6357940917368317`*^9, {
   3.635794185320995*^9, 3.6357941861178737`*^9}, {3.6357944788323727`*^9, 
   3.635794479004217*^9}, 3.6357953640386047`*^9, 3.6357994773905773`*^9, 
   3.6358018427036114`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<E:\\\\_time_varying_data\\\\SmokeSim\\\\DSSmokeSideways100500\\\\\
dsSmoke.159.tfi\>\"", ",", "\"\<XML\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<intensity\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
          "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", "___"}], 
        "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgba", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"r", ",", "g", ",", "b", ",", "a"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"RGBColor", "/@", "rgba"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorfunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"intensity", ",", "colors"}], "}"}], "]"}], ",", " ", "#1"}],
       "]"}], " ", "&"}], " ", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "colorfunction"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6357960601981816`*^9, 3.6357960703557143`*^9}, 
   3.63580184437549*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opacityfunction", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgba", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"List", "@@", 
        RowBox[{"rgbfunction", "[", "#", "]"}]}], ",", 
       RowBox[{"opacityfunction", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
    "intensityfunction"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denormalized", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"255", "#"}], "]"}], "&"}], ")"}], "/@", "rgba"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"intensityfunction", ",", "denormalized"}], "}"}], "]"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "#"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strlist", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
     "r"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphaMode", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<alphaMode\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gammaValue", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<gammaValue\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<domain\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
       RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"threshold", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<threshold\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
       RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"intensity", "=", 
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<intensity\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<value\>\"", "\[Rule]", "#1"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ",", 
        RowBox[{"split", "=", 
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<split\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<false\>\""}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ",", 
        RowBox[{"colorL", "=", 
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<colorL\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<r\>\"", "\[Rule]", "#2"}], ",", 
             RowBox[{"\"\<g\>\"", "\[Rule]", "#3"}], ",", 
             RowBox[{"\"\<b\>\"", "\[Rule]", "#4"}], ",", 
             RowBox[{"\"\<a\>\"", "\[Rule]", "#5"}]}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], "&"}], ")"}], "@@@", 
    "strlist"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keylist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"XMLElement", "[", 
      RowBox[{"\"\<key\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<TransFuncMappingKey\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@", 
    "k"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keys", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<Keys\>\"", ",", 
     RowBox[{"{", "}"}], ",", "keylist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransFuncIntensity", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<TransFuncIntensity\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<TransFuncIntensity\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "alphaMode", ",", "gammaValue", ",", "domain", ",", "threshold", ",", 
       "keys"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VoreenData", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<VoreenData\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<version\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", "TransFuncIntensity", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xml", "=", 
   RowBox[{
    RowBox[{"XMLObject", "[", "\"\<Document\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"XMLObject", "[", "\"\<Declaration\>\"", "]"}], "[", 
        RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<1.0\>\""}], "]"}], ",", 
       RowBox[{
        RowBox[{"XMLObject", "[", "\"\<Comment\>\"", "]"}], "[", 
        "\"\<This is a Voreen transfer function exported from \
Mathematica\>\"", "]"}]}], "}"}], ",", "VoreenData", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<smoke\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{
       RowBox[{"160", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
     "\"\<_201bins.tfi\>\""}], ",", "xml", ",", " ", "\"\<XML\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.63579556173087*^9, 3.6357955960757275`*^9}, {
   3.6357956374503765`*^9, 3.635795674243438*^9}, {3.6357970622777267`*^9, 
   3.6357970739102435`*^9}, 3.6357994824548635`*^9, 3.635801735218956*^9, 
   3.6358018161410437`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"unwanted", " ", "opacity", " ", "0.0409807"}], ",", " ", 
   "0.0400936", ",", " ", 
   RowBox[{"0.0326559", " ", "in", " ", "15.", "png"}], ",", " ", 
   RowBox[{"16.", "png"}], ",", " ", 
   RowBox[{"22.", "png"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6356986924370685`*^9, 3.6356987719856977`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "160"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"tffilelist", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<XML\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<intensity\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
          "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", "___"}], 
        "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbcolors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"r", ",", "g", ",", "b"}], "}"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"RGBColor", "/@", "#"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rgbfunction", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"intensity", ",", "rgbcolors"}], "}"}], "]"}], ",", " ", 
        "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"1", "+", "offset"}]}], ";", 
  RowBox[{"end", "=", "500"}], ";", 
  RowBox[{"step", "=", "32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"end2", "=", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "a", ",", "h", ",", "intensityfunction", ",", "sum", 
        ",", "hist", ",", "probability", ",", "entropy", ",", "op", ",", 
        "opacityfunction", ",", "rgba", ",", "denormalized", ",", "r", ",", 
        "strlist", ",", "alphaMode", ",", "gammaValue", ",", "domain", ",", 
        "threshold", ",", "k", ",", "intensity", ",", "split", ",", "colorL", 
        ",", "keylist", ",", "keys", ",", "TransFuncIntensity", ",", 
        "VoreenData"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"ImageData", "[", 
              RowBox[{"d", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"h", "=", 
            RowBox[{"HistogramList", "[", 
             RowBox[{"a", ",", "bincount"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"intensityfunction", "=", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1.", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"h", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], 
                ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hist", "[", "i_", "]"}], ":=", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FirstPosition", "[", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"i", "<", "#"}], "&"}], ")"}]}]}], "]"}]}], "-", 
             "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"sum", ":=", 
            RowBox[{"Total", "[", 
             RowBox[{"h", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"probability", "[", "i_", "]"}], ":=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "/", "sum"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"entropy", "[", "i_", "]"}], ":=", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", 
              RowBox[{
               RowBox[{"p", "=", 
                RowBox[{"probability", "[", "i", "]"}]}], ";", 
               RowBox[{
                RowBox[{"-", "p"}], "*", 
                RowBox[{"Log", "[", "p", "]"}]}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"op", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", "t", "}"}], ",", 
                 RowBox[{
                  RowBox[{"t", "=", 
                   RowBox[{"entropy", "[", "#", "]"}]}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"t", "!=", "0"}], ",", 
                    RowBox[{"1.", "/", "t"}], ",", "0"}], "]"}]}]}], "]"}], 
               "&"}], "/@", "intensityfunction"}], "//", "Rescale"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"opacityfunction", "=", 
            RowBox[{"Interpolation", "[", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rgba", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"rgbfunction", "[", "#", "]"}]}], ",", 
                RowBox[{"opacityfunction", "[", "#", "]"}]}], "]"}], "&"}], "/@",
              "intensityfunction"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"denormalized", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerPart", "[", 
                RowBox[{"255", "#"}], "]"}], "&"}], ")"}], "/@", "rgba"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensityfunction", ",", "denormalized"}], "}"}], 
              "]"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "#"}], 
              "&"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"strlist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@",
              "r"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"alphaMode", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<alphaMode\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gammaValue", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<gammaValue\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"domain", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<domain\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
                RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"threshold", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<threshold\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
                RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"k", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"intensity", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<intensity\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "#1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                 RowBox[{"split", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<split\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<false\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                 RowBox[{"colorL", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<colorL\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<r\>\"", "\[Rule]", "#2"}], ",", 
                    RowBox[{"\"\<g\>\"", "\[Rule]", "#3"}], ",", 
                    RowBox[{"\"\<b\>\"", "\[Rule]", "#4"}], ",", 
                    RowBox[{"\"\<a\>\"", "\[Rule]", "#5"}]}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], "&"}], ")"}], "@@@",
              "strlist"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"keylist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"XMLElement", "[", 
               RowBox[{"\"\<key\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<type\>\"", "\[Rule]", "\"\<TransFuncMappingKey\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], 
             "@@@", "k"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"keys", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<Keys\>\"", ",", 
              RowBox[{"{", "}"}], ",", "keylist"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TransFuncIntensity", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<TransFuncIntensity\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<type\>\"", "\[Rule]", "\"\<TransFuncIntensity\>\""}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "alphaMode", ",", "gammaValue", ",", "domain", ",", 
                "threshold", ",", "keys"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"VoreenData", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<VoreenData\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<version\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], 
              ",", 
              RowBox[{"{", "TransFuncIntensity", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"XMLObject", "[", "\"\<Document\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Declaration\>\"", "]"}], "[", 
                RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<1.0\>\""}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Comment\>\"", "]"}], "[", 
                "\"\<This is a Voreen transfer function exported from \
Mathematica\>\"", "]"}]}], "}"}], ",", "VoreenData", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "end2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"num", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"j", ",", "end2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<tf\\\\\>\"", 
             "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], "-", "1"}],
                ",", "10", ",", "3"}], "]"}], "<>", "\"\<.tfi\>\""}], ",", 
            "#", ",", " ", "\"\<XML\>\""}], "]"}], "&"}], ",", "result"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6356832490737395`*^9, 3.6356832754957056`*^9}, {
   3.6356834721836696`*^9, 3.6356834888712125`*^9}, {3.6356843808418913`*^9, 
   3.635684385451255*^9}, {3.635684417591979*^9, 3.6356844452951484`*^9}, {
   3.6356846488737655`*^9, 3.63568466124879*^9}, {3.635684771143425*^9, 
   3.635684771862158*^9}, {3.635684811377953*^9, 3.6356850043471117`*^9}, {
   3.635685045831602*^9, 3.635685061409786*^9}, {3.635685148003684*^9, 
   3.635685193660043*^9}, {3.635685271379033*^9, 3.6356852771758676`*^9}, 
   3.6356865886583433`*^9, {3.6356866416272025`*^9, 3.635686644892832*^9}, 
   3.635687010893676*^9, {3.6356879024582043`*^9, 3.6356879063643885`*^9}, {
   3.6356879825367002`*^9, 3.635688062115049*^9}, {3.635688093552635*^9, 
   3.635688101162019*^9}, 3.6356881429433813`*^9, {3.6356881761934104`*^9, 
   3.6356882510842156`*^9}, {3.6356883141781282`*^9, 3.6356883144437237`*^9}, 
   3.6356883680063915`*^9, {3.6356884210065155`*^9, 3.63568842330336*^9}, {
   3.6356885403974094`*^9, 3.6356887557416754`*^9}, {3.6356936450401635`*^9, 
   3.635693688555867*^9}, {3.635694730404978*^9, 3.635694732608137*^9}, {
   3.635695196683627*^9, 3.6356952266523924`*^9}, {3.635696704113458*^9, 
   3.635696704478201*^9}, 3.6356977468041697`*^9, {3.635698602566883*^9, 
   3.6356986027658944`*^9}, {3.6357025117359633`*^9, 
   3.6357025121422124`*^9}, {3.635702627553308*^9, 3.63570262861437*^9}, 
   3.6357026960524807`*^9, {3.6357039614277477`*^9, 3.6357039623183928`*^9}, {
   3.6357040238497925`*^9, 3.6357040339904203`*^9}, {3.6357041966783066`*^9, 
   3.6357042037407713`*^9}, {3.6357058870573044`*^9, 3.63570588843225*^9}, {
   3.6357974410652804`*^9, 3.635797444578904*^9}, 3.6357977223129063`*^9, {
   3.6357979116814604`*^9, 3.6357979756069665`*^9}, 3.635798137099939*^9, {
   3.6357982176734805`*^9, 3.6357982393689175`*^9}, {3.6357984378486795`*^9, 
   3.6357984384736495`*^9}, {3.6357984732859945`*^9, 3.635798478551637*^9}, 
   3.6357994862098446`*^9, {3.635800284042012*^9, 3.635800286463888*^9}, {
   3.6358004768752594`*^9, 3.63580047703151*^9}, {3.635802097110448*^9, 
   3.635802099641742*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "160"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", 
     RowBox[{"d", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"HistogramList", "[", 
    RowBox[{"a", ",", "bincount"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensityfunction", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{"1.", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"h", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hist", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"FirstPosition", "[", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "<", "#"}], "&"}], ")"}]}]}], "]"}]}], "-", "1"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"d", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"std", "=", 
   RowBox[{"ImageAdjust", "@@", 
    RowBox[{"ImageApply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviation", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "list"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", "std", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numofbins", "=", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"h", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bins", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"h", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sumstd", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"h", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", "numofbins"}], "]"}], "+", 
        "1"}]}], ";", 
      RowBox[{
       RowBox[{"bins", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "++"}], ";", 
      RowBox[{
       RowBox[{"sumstd", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "+=", 
       RowBox[{"b", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"stds", "=", 
     RowBox[{"sumstd", "/", "bins"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bins", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
       RowBox[{
        RowBox[{"sumstd", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        RowBox[{"bins", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "bins", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"volatility", "[", "i_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"stds", "[", 
     RowBox[{"[", 
      RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temporalentropy", "[", "i_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "p", "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"volatility", "[", "i", "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", "\[NotEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{"-", "p"}], "*", 
         RowBox[{"Log", "[", "p", "]"}]}], ",", "0"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"temporalentropy", "[", "#", "]"}], "&"}], "/@", 
      "intensityfunction"}], "//", "Rescale"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opacityfunction", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgba", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"List", "@@", 
        RowBox[{"rgbfunction", "[", "#", "]"}]}], ",", 
       RowBox[{"opacityfunction", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
    "intensityfunction"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denormalized", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"255", "#"}], "]"}], "&"}], ")"}], "/@", "rgba"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"intensityfunction", ",", "denormalized"}], "}"}], "]"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "#"}], "&"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"strlist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
      "r"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strlist", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToString", "[", "#1", "]"}], ",", 
         RowBox[{"ToString", "[", "#2", "]"}], ",", 
         RowBox[{"ToString", "[", "#3", "]"}], ",", 
         RowBox[{"ToString", "[", "#4", "]"}], ",", 
         RowBox[{"ToString", "[", "#5", "]"}]}], "}"}], "&"}], ")"}], "@@@", 
     "r"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphaMode", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<alphaMode\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gammaValue", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<gammaValue\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<domain\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
       RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"threshold", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<threshold\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
       RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"intensity", "=", 
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<intensity\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<value\>\"", "\[Rule]", "#1"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ",", 
        RowBox[{"split", "=", 
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<split\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<false\>\""}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ",", 
        RowBox[{"colorL", "=", 
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<colorL\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<r\>\"", "\[Rule]", "#2"}], ",", 
             RowBox[{"\"\<g\>\"", "\[Rule]", "#3"}], ",", 
             RowBox[{"\"\<b\>\"", "\[Rule]", "#4"}], ",", 
             RowBox[{"\"\<a\>\"", "\[Rule]", "#5"}]}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], "&"}], ")"}], "@@@", 
    "strlist"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keylist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"XMLElement", "[", 
      RowBox[{"\"\<key\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<TransFuncMappingKey\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@", 
    "k"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keys", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<Keys\>\"", ",", 
     RowBox[{"{", "}"}], ",", "keylist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransFuncIntensity", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<TransFuncIntensity\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<TransFuncIntensity\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "alphaMode", ",", "gammaValue", ",", "domain", ",", "threshold", ",", 
       "keys"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VoreenData", "=", 
   RowBox[{"XMLElement", "[", 
    RowBox[{"\"\<VoreenData\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<version\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", "TransFuncIntensity", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xml", "=", 
   RowBox[{
    RowBox[{"XMLObject", "[", "\"\<Document\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"XMLObject", "[", "\"\<Declaration\>\"", "]"}], "[", 
        RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<1.0\>\""}], "]"}], ",", 
       RowBox[{
        RowBox[{"XMLObject", "[", "\"\<Comment\>\"", "]"}], "[", 
        "\"\<This is a Voreen transfer function exported from \
Mathematica\>\"", "]"}]}], "}"}], ",", "VoreenData", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<std_tf\\\\\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{
       RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
     "\"\<.tfi\>\""}], ",", "xml", ",", " ", "\"\<XML\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.635799168886199*^9, 3.6357991843517694`*^9}, 
   3.635799244977105*^9, 3.635799490163889*^9, {3.6357999648281155`*^9, 
   3.6357999796189237`*^9}, {3.635800882657518*^9, 3.6358008942669053`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "160"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"tffilelist", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<XML\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensity", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<intensity\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
          "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}], 
         ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
      "\[Infinity]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"tf", ",", 
      RowBox[{
       RowBox[{"XMLElement", "[", 
        RowBox[{"\"\<colorL\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", "___"}], 
        "]"}], "\[RuleDelayed]", "atrib"}], ",", "\[Infinity]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbcolors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"r", ",", "g", ",", "b"}], "}"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"RGBColor", "/@", "#"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rgbfunction", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"intensity", ",", "rgbcolors"}], "}"}], "]"}], ",", " ", 
        "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"1", "+", "offset"}]}], ";", 
  RowBox[{"end", "=", "500"}], ";", 
  RowBox[{"step", "=", "32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"end2", "=", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"j", "+", "step", "-", "1"}], ",", "end"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "a", ",", "h", ",", "intensityfunction", ",", "hist", 
        ",", "op", ",", "list", ",", "std", ",", "b", ",", "numofbins", ",", 
        "bins", ",", "sumstd", ",", "stds", ",", "volatility", ",", 
        "temporalentropy", ",", "opacityfunction", ",", "rgba", ",", 
        "denormalized", ",", "r", ",", "strlist", ",", "alphaMode", ",", 
        "gammaValue", ",", "domain", ",", "threshold", ",", "k", ",", 
        "intensity", ",", "split", ",", "colorL", ",", "keylist", ",", "keys",
         ",", "TransFuncIntensity", ",", "VoreenData"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"ImageData", "[", 
              RowBox[{"d", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"h", "=", 
            RowBox[{"HistogramList", "[", 
             RowBox[{"a", ",", "bincount"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"intensityfunction", "=", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1.", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"h", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], 
                ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hist", "[", "i_", "]"}], ":=", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FirstPosition", "[", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"i", "<", "#"}], "&"}], ")"}]}]}], "]"}]}], "-", 
             "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"list", "=", 
            RowBox[{"d", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "offset"}], ";;", "i"}], "]"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"std", "=", 
            RowBox[{"ImageAdjust", "@@", 
             RowBox[{"ImageApply", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StandardDeviation", "[", 
                 RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", "list"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"b", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"ImageData", "[", "std", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"numofbins", "=", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bins", "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"h", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"sumstd", "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"h", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"j", "=", 
               RowBox[{
                RowBox[{"IntegerPart", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "*", "numofbins"}], "]"}], 
                "+", "1"}]}], ";", 
              RowBox[{
               RowBox[{"bins", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "++"}], ";", 
              RowBox[{
               RowBox[{"sumstd", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "+=", 
               RowBox[{"b", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"stds", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bins", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
                RowBox[{
                 RowBox[{"sumstd", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", 
                 RowBox[{"bins", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "bins", "]"}]}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"volatility", "[", "i_", "]"}], ":=", 
            RowBox[{"N", "[", 
             RowBox[{"stds", "[", 
              RowBox[{"[", 
               RowBox[{"hist", "[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"temporalentropy", "[", "i_", "]"}], ":=", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", 
              RowBox[{
               RowBox[{"p", "=", 
                RowBox[{"volatility", "[", "i", "]"}]}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"p", "\[NotEqual]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"-", "p"}], "*", 
                  RowBox[{"Log", "[", "p", "]"}]}], ",", "0"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"op", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"temporalentropy", "[", "#", "]"}], "&"}], "/@", 
              "intensityfunction"}], "//", "Rescale"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"opacityfunction", "=", 
            RowBox[{"Interpolation", "[", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensityfunction", ",", "op"}], "}"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rgba", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"rgbfunction", "[", "#", "]"}]}], ",", 
                RowBox[{"opacityfunction", "[", "#", "]"}]}], "]"}], "&"}], "/@",
              "intensityfunction"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"denormalized", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerPart", "[", 
                RowBox[{"255", "#"}], "]"}], "&"}], ")"}], "/@", "rgba"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensityfunction", ",", "denormalized"}], "}"}], 
              "]"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "#"}], 
              "&"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"strlist", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ToString", "[", "#1", "]"}], ",", 
                 RowBox[{"ToString", "[", "#2", "]"}], ",", 
                 RowBox[{"ToString", "[", "#3", "]"}], ",", 
                 RowBox[{"ToString", "[", "#4", "]"}], ",", 
                 RowBox[{"ToString", "[", "#5", "]"}]}], "}"}], "&"}], ")"}], 
             "@@@", "r"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"alphaMode", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<alphaMode\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gammaValue", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<gammaValue\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"domain", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<domain\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
                RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"threshold", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<threshold\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
                RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"k", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"intensity", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<intensity\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "#1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                 RowBox[{"split", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<split\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<false\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                 RowBox[{"colorL", "=", 
                  RowBox[{"XMLElement", "[", 
                   RowBox[{"\"\<colorL\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<r\>\"", "\[Rule]", "#2"}], ",", 
                    RowBox[{"\"\<g\>\"", "\[Rule]", "#3"}], ",", 
                    RowBox[{"\"\<b\>\"", "\[Rule]", "#4"}], ",", 
                    RowBox[{"\"\<a\>\"", "\[Rule]", "#5"}]}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], "&"}], ")"}], "@@@",
              "strlist"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"keylist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"XMLElement", "[", 
               RowBox[{"\"\<key\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<type\>\"", "\[Rule]", "\"\<TransFuncMappingKey\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], 
             "@@@", "k"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"keys", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<Keys\>\"", ",", 
              RowBox[{"{", "}"}], ",", "keylist"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TransFuncIntensity", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<TransFuncIntensity\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<type\>\"", "\[Rule]", "\"\<TransFuncIntensity\>\""}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "alphaMode", ",", "gammaValue", ",", "domain", ",", 
                "threshold", ",", "keys"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"VoreenData", "=", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<VoreenData\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<version\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], 
              ",", 
              RowBox[{"{", "TransFuncIntensity", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"XMLObject", "[", "\"\<Document\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Declaration\>\"", "]"}], "[", 
                RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<1.0\>\""}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Comment\>\"", "]"}], "[", 
                "\"\<This is a Voreen transfer function exported from \
Mathematica\>\"", "]"}]}], "}"}], ",", "VoreenData", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "end2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"num", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"j", ",", "end2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
             "\"\<std_tf\\\\\>\"", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"num", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], "-", "1"}],
                ",", "10", ",", "3"}], "]"}], "<>", "\"\<.tfi\>\""}], ",", 
            "#", ",", " ", "\"\<XML\>\""}], "]"}], "&"}], ",", "result"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "start", ",", "end", ",", "step"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6357976900222044`*^9, 3.6357977847276325`*^9}, {
   3.6357978210741434`*^9, 3.6357979051433773`*^9}, {3.6357979559565496`*^9, 
   3.635797956315939*^9}, 3.6357981262997403`*^9, 3.6357982335371714`*^9, {
   3.635798320011873*^9, 3.6357983303685784`*^9}, {3.6357984070460668`*^9, 
   3.6357984244298067`*^9}, 3.6357994945257792`*^9, {3.635799801606949*^9, 
   3.635799860129323*^9}, {3.6357998972469835`*^9, 3.635799952714168*^9}, {
   3.6358001024243555`*^9, 3.6358001028462105`*^9}, {3.635800244624174*^9, 
   3.635800255343918*^9}, {3.6358004826877728`*^9, 3.6358004828440237`*^9}, {
   3.6358007748759975`*^9, 3.635800869204405*^9}, {3.635800901220036*^9, 
   3.6358009014544554`*^9}, {3.635802104579216*^9, 3.635802163595025*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tf", ",", "intensity", ",", "r", ",", "g", ",", "b", ",", "a", ",", 
       "rgba", ",", "colors", ",", "colorfunction", ",", "img"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tf", "=", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<std_tf\\\\\>\"",
           "<>", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
          "\"\<.tfi\>\""}], ",", "\"\<XML\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensity", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<intensity\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", 
             "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rgba", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"r", ",", "g", ",", "b", ",", "a"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{"RGBColor", "/@", "rgba"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"colorfunction", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"intensity", ",", "colors"}], "}"}], "]"}], ",", " ", 
           "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"img", "=", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "colorfunction"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<smoke_std_tf\\\\\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
         "\"\<.png\>\""}], ",", "img", ",", 
        RowBox[{"ImageSize", "\[Rule]", "640"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"1", "+", "offset"}], ",", "500"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6357983437790675`*^9, 3.635798367736744*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tf", ",", "intensity", ",", "r", ",", "g", ",", "b", ",", "a", ",", 
       "rgba", ",", "colors", ",", "colorfunction", ",", "img"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tf", "=", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<tf\\\\\>\"", "<>", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
          "\"\<.tfi\>\""}], ",", "\"\<XML\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensity", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<intensity\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", 
             "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rgba", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"r", ",", "g", ",", "b", ",", "a"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{"RGBColor", "/@", "rgba"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"colorfunction", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"intensity", ",", "colors"}], "}"}], "]"}], ",", " ", 
           "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"img", "=", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "colorfunction"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<smoke_entropy_tf\\\\\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
         "\"\<.png\>\""}], ",", "img", ",", 
        RowBox[{"ImageSize", "\[Rule]", "640"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "500"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6356963337857847`*^9, {3.635696608110939*^9, 3.6356966322129097`*^9}, {
   3.635696712260092*^9, 3.6356967125725517`*^9}, {3.6357033778169937`*^9, 
   3.635703391379487*^9}, {3.635703427082699*^9, 3.6357034296295824`*^9}, {
   3.6357044489044695`*^9, 3.6357045052614565`*^9}, {3.635704588937807*^9, 
   3.635704601156582*^9}, {3.6357046366722975`*^9, 3.635704644078562*^9}, 
   3.635798192191287*^9, 3.635798243884075*^9}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tf", ",", "intensity", ",", "r", ",", "g", ",", "b", ",", "a", ",", 
       "rgba", ",", "colors", ",", "colorfunction", ",", "img"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tf", "=", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{
         "\"\<E:\\\\_time_varying_data\\\\SmokeSim\\\\DSSmokeSideways100500\\\
\\dsSmoke.\>\"", "<>", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
          "\"\<.tfi\>\""}], ",", "\"\<XML\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensity", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<intensity\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", 
             "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rgba", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"r", ",", "g", ",", "b", ",", "a"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{"RGBColor", "/@", "rgba"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"colorfunction", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"intensity", ",", "colors"}], "}"}], "]"}], ",", " ", 
           "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"img", "=", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "colorfunction"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<smoke_intensity_tf\\\\\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "10", ",", "3"}], "]"}], "<>", 
         "\"\<.png\>\""}], ",", "img", ",", 
        RowBox[{"ImageSize", "\[Rule]", "640"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "500"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.635772185609265*^9, 3.6357722099669123`*^9}, {
   3.6357737601340284`*^9, 3.6357737662454605`*^9}, 3.635798170645211*^9}]
},
WindowSize->{1602, 996},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.92}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5608, 153, 352, "Input"],
Cell[6191, 177, 10119, 224, 79, "Output"]
}, Open  ]],
Cell[16325, 404, 8384, 238, 432, "Input"],
Cell[CellGroupData[{
Cell[24734, 646, 4142, 116, 172, "Input"],
Cell[28879, 764, 5844, 101, 236, "Output"],
Cell[34726, 867, 7443, 131, 241, "Output"],
Cell[42172, 1000, 9145, 156, 247, "Output"],
Cell[51320, 1158, 9128, 156, 247, "Output"],
Cell[60451, 1316, 9388, 160, 247, "Output"],
Cell[69842, 1478, 9403, 160, 247, "Output"]
}, Open  ]],
Cell[79260, 1641, 1640, 44, 112, "Input"],
Cell[80903, 1687, 3604, 105, 212, "Input"],
Cell[84510, 1794, 6763, 187, 412, "Input"],
Cell[91276, 1983, 369, 8, 31, "Input"],
Cell[91648, 1993, 18263, 423, 1032, "Input"],
Cell[109914, 2418, 12142, 364, 772, "Input"],
Cell[122059, 2784, 19148, 458, 1132, "Input"],
Cell[141210, 3244, 4915, 124, 292, "Input"],
Cell[146128, 3370, 5252, 128, 292, "Input"],
Cell[151383, 3500, 4972, 124, 292, "Input"]
}
]
*)

(* End of internal cache information *)
