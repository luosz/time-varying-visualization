(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    185073,       4688]
NotebookOptionsPosition[    181567,       4595]
NotebookOutlinePosition[    181909,       4610]
CellTagsIndexPosition[    181866,       4607]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"top", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", 
      "d1"}], "}"}], ",", 
    RowBox[{"(*", " ", "top", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"data", ",", "All", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d1", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"back", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d2"}], "}"}], ",", 
    RowBox[{"(*", " ", "back", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"data", ",", "All", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d2", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"left", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d3"}], "}"}], ",", 
    RowBox[{"(*", " ", "left", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"data", ",", "All", ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d3", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bottom", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", 
      "d4"}], "}"}], ",", 
    RowBox[{"(*", " ", "bottom", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"data", ",", "All", ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d4", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"front", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d5"}], "}"}], ",", 
    RowBox[{"(*", " ", "front", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"data", ",", "All", ",", "2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d5", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"right", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "count", ",", "img", ",", "list2", ",", "list3", ",", "tmp",
       ",", "d6"}], "}"}], ",", 
    RowBox[{"(*", " ", "right", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"data", ",", "All", ",", "3"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageApply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{
               RowBox[{"Clip", "[", 
                RowBox[{
                 RowBox[{"1", "-", "#1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", 
               RowBox[{"f", "[", "#2", "]"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"img", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "count"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "list", "]"}], "}"}], ",", "#"}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d6", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"renderslices", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<top\>\"", ":>", "top"}], ",", 
     RowBox[{"\"\<back\>\"", ":>", "back"}], ",", 
     RowBox[{"\"\<left\>\"", ":>", "left"}], ",", 
     RowBox[{"\"\<bottom\>\"", ":>", "bottom"}], ",", 
     RowBox[{"\"\<front\>\"", ":>", "front"}], ",", 
     RowBox[{"\"\<right\>\"", ":>", "right"}]}], "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6525285775791597`*^9, {3.652532436961684*^9, 3.652532437617946*^9}, {
   3.653393246359665*^9, 3.6533932579627733`*^9}, {3.6533933207069187`*^9, 
   3.6533933347143383`*^9}}],

Cell[BoxData[{
 RowBox[{"top2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "df", ",", "d1"}], 
     "}"}], ",", 
    RowBox[{"(*", " ", "top", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"df", ",", "All", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d1", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"back2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d2"}], "}"}], ",", 
    RowBox[{"(*", " ", "back", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"df", ",", "All", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d2", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"left2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d3"}], "}"}], ",", 
    RowBox[{"(*", " ", "left", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Image3DSlices", "[", 
       RowBox[{"df", ",", "All", ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d3", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bottom2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "df", ",", "d4"}], 
     "}"}], ",", 
    RowBox[{"(*", " ", "bottom", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"df", ",", "All", ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d4", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"front2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d5"}], "}"}], ",", 
    RowBox[{"(*", " ", "front", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"df", ",", "All", ",", "2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", "list3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d5", "=", 
      RowBox[{"ImageRotate", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"90", " ", "Degree"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"right2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", "img", ",", "list2", ",", "list3", ",", "tmp", ",", "df", 
      ",", "d6"}], "}"}], ",", 
    RowBox[{"(*", " ", "right", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"df", "=", 
      RowBox[{"ImageApply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Image3DSlices", "[", 
        RowBox[{"df", ",", "All", ",", "3"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"img", "=", 
          RowBox[{"ImageAdd", "[", 
           RowBox[{"img", ",", 
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"ImageClip", "@", 
               RowBox[{"ColorNegate", "[", "img", "]"}]}], ",", "i"}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list3", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageSubtract", "[", 
          RowBox[{
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"First", "[", "list", "]"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Image3D", "[", 
       RowBox[{"Reverse", "[", "list3", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d6", "=", 
      RowBox[{
       RowBox[{"ImageRotate", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"90", " ", "Degree"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ImageRotate", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", "90"}], " ", "Degree"}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"renderslices2", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<top\>\"", ":>", "top2"}], ",", 
     RowBox[{"\"\<back\>\"", ":>", "back2"}], ",", 
     RowBox[{"\"\<left\>\"", ":>", "left2"}], ",", 
     RowBox[{"\"\<bottom\>\"", ":>", "bottom2"}], ",", 
     RowBox[{"\"\<front\>\"", ":>", "front2"}], ",", 
     RowBox[{"\"\<right\>\"", ":>", "right2"}]}], "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6533903859876237`*^9, 3.653390386315754*^9}, 
   3.653390592228038*^9, {3.6533906222841387`*^9, 3.6533906225341263`*^9}, {
   3.6533907050910063`*^9, 3.653390724347232*^9}, {3.6533910426423764`*^9, 
   3.6533910752363367`*^9}, 3.653391164293522*^9, {3.6533911974059334`*^9, 
   3.6533914334937663`*^9}, {3.653393937411039*^9, 3.6533939527707477`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vorts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<vorts\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", "99", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xml", ",", "tfifile", ",", "volumefile", ",", "legends", ",", "face", 
       ",", "imagefilenames", ",", "txtfilenames", ",", "featurefilename", 
       ",", "visibilityfilename", ",", "resultxml", ",", "imagefile", ",", 
       "rawfile", ",", "dataname", ",", "tf", ",", "bincount", ",", 
       "intensity", ",", "r", ",", "g", ",", "b", ",", "a", ",", "rgbcolors", 
       ",", "rgbfunction", ",", "rgba", ",", "rgbafunction", ",", "alpha", 
       ",", "intensity0", ",", "alpha0", ",", "d", ",", "colorized", ",", 
       "pos", ",", "index", ",", "features", ",", "chartcolors", ",", 
       "colorizedfeatures", ",", "viewpoints", ",", "lightness", ",", 
       "chroma", ",", "hue", ",", "opacity", ",", "g1", ",", "g2", ",", 
       "visibility", ",", "chart1", ",", "dog", ",", "saliency", ",", 
       "chart0", ",", "chart2", ",", "viss2", ",", "total2", ",", "vs2", ",", 
       "chart2b", ",", "weighted", ",", "charts", ",", "scores", ",", 
       "scoremap", ",", "w", ",", "results", ",", "t3", ",", "t4", ",", 
       "rangeOfAlpha", ",", "plotpath", ",", "imagepath", ",", "index0", ",", 
       "targets", ",", "target", ",", "records", ",", "epsilon", ",", 
       "stepsize", ",", "iterationcount1", ",", "iterationcount2", ",", 
       "peaks1", ",", "iteration", ",", "previous", ",", "t1", ",", "t2", ",",
        "list", ",", "saliency5", ",", "saliency3", ",", "saliency2", ",", 
       "saliency1", ",", "opacity5", ",", "opacity3", ",", "opacity2", ",", 
       "opacity1", ",", "x", ",", "y", ",", "saliencyopacity5", ",", 
       "saliencyopacity3", ",", "saliencyopacity2", ",", "saliencyopacity1", 
       ",", "rms5", ",", "rms3", ",", "rms2", ",", "rms1", ",", "table5", ",",
        "table3", ",", "table2", ",", "table1", ",", "rmslist5", ",", "path5",
        ",", "path3", ",", "path2", ",", "path1", ",", "rmslists1", ",", 
       "multipliers", ",", "rmslist1", ",", "rmslist2", ",", "rmslist3", ",", 
       "rmslists2", ",", "recordxml", ",", "recordmap", ",", "tf1", ",", 
       "tf2", ",", "tf3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{"InputString", "[", 
          RowBox[{"\"\<Enter xml file name\>\"", ",", "\"\<tooth.xml\>\""}], 
          "]"}], "//", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}]}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"xml", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<~images\\\\\>\"", "<>", "\"\<nucleon_naive.xml\>\""}], "]"}]}],
        ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"xml", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<~images\\\\\>\"", "<>", "\"\<nucleon_strong_red.xml\>\""}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"xml", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<~images\\\\\>\"", "<>", "\"\<nucleon_weak_red.xml\>\""}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"xml", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<~images\\\\\>\"", "<>", 
          "\"\<nucleon_naive_optimized_green_1000.xml\>\""}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"xml", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<~images\\\\\>\"", "<>", 
          "\"\<nucleon_naive_optimized_red_1000.xml\>\""}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xml", "=", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<~images\\\\\>\"",
          "<>", "xmlstr", "<>", "\"\<.xml\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tfifile", ",", "volumefile", ",", "legends", ",", "face", ",", 
         "imagefilenames", ",", "txtfilenames", ",", 
         RowBox[{"{", 
          RowBox[{"featurefilename", ",", "visibilityfilename"}], "}"}], ",", 
         "resultxml", ",", "imagefile", ",", "rawfile", ",", "dataname", ",", 
         "plotpath", ",", "imagepath"}], "}"}], "=", "xml"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Column", "[", 
        RowBox[{"xml", ",", 
         RowBox[{"Background", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lighter", "@", "LightYellow"}], ",", 
             RowBox[{"Lighter", "@", "LightBlue"}]}], "}"}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"LightGray", ",", "Thin", ",", "Dashed"}], "]"}]}]}], 
        "]"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tf", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"tfifile", ",", "\"\<XML\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bincount", "=", "256"}], ";", "\[IndentingNewLine]", 
      RowBox[{"intensity", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<intensity\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<value\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<r\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<g\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<b\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"tf", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<colorL\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<a\>\"", "\[Rule]", "atrib_"}]}], "}"}], ",", 
             "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rgbcolors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"r", ",", "g", ",", "b"}], "}"}], "]"}]}], "//", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RGBColor", "/@", "#"}], "&"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rgbfunction", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"intensity", ",", "rgbcolors"}], "}"}], "]"}], ",", " ", 
           "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rgba", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"r", ",", "g", ",", "b", ",", "a"}], "}"}], "]"}]}], "//", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RGBColor", "/@", "#"}], "&"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rgbafunction", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"intensity", ",", "rgba"}], "}"}], "]"}], ",", " ", 
           "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", "a"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"Import", "[", 
        RowBox[{"volumefile", ",", "\"\<Image3D\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colorized", "=", 
       RowBox[{"Image3D", "[", 
        RowBox[{"d", ",", 
         RowBox[{"ColorFunction", "\[Rule]", "rgbafunction"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lightness", ",", "chroma", ",", "hue", ",", "opacity"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageApply", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"rgbafunction", "[", "#", "]"}]}], "&"}], ",", "d"}], 
          "]"}], "//", 
         RowBox[{
          RowBox[{"Image3D", "[", 
           RowBox[{"#", ",", 
            RowBox[{"ColorSpace", "\[Rule]", "\"\<RGB\>\""}]}], "]"}], 
          "&"}]}], "//", 
        RowBox[{
         RowBox[{"ColorSeparate", "[", 
          RowBox[{"ColorConvert", "[", 
           RowBox[{"#", ",", "\"\<LCH\>\""}], "]"}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"lo", "=", 
         RowBox[{"ImageMultiply", "[", 
          RowBox[{"lightness", ",", "opacity"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"co", "=", 
         RowBox[{"ImageMultiply", "[", 
          RowBox[{"chroma", ",", "opacity"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"g1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ImageDifference", "[", 
            RowBox[{
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"lightness", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "2"}]}],
                 "}"}]}], "]"}], ",", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"lightness", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "4"}]}],
                 "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "g2"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ImageDifference", "[", 
             RowBox[{
              RowBox[{"GaussianFilter", "[", 
               RowBox[{"chroma", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", 
                   "2"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"GaussianFilter", "[", 
               RowBox[{"chroma", ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", 
                   "4"}]}], "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
            "g3"}], "=", 
           RowBox[{"ImageDifference", "[", 
            RowBox[{
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"hue", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "2"}]}],
                 "}"}]}], "]"}], ",", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"hue", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "4"}]}],
                 "}"}]}], "]"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"g4", "=", 
         RowBox[{"ImageDifference", "[", 
          RowBox[{
           RowBox[{"GaussianFilter", "[", 
            RowBox[{"opacity", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "2"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"GaussianFilter", "[", 
            RowBox[{"opacity", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "4"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g1", ",", "g2"}], "}"}], "=", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageDifference", "[", 
           RowBox[{
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "2"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sqrt", "[", "2", "]"}], "/", "8."}], "*", "4"}]}], 
               "}"}]}], "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"lightness", ",", "chroma"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"intensity", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "==", "0"}], "&"}], ")"}]}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"index", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"alpha", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"features", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageApply", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[GreaterEqual]", 
                RowBox[{"pos", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], " ", "&&", " ", 
               RowBox[{"#", "\[LessEqual]", 
                RowBox[{"pos", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", "1", ",", 
              "0"}], "]"}], "&"}], ",", "d"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pos", "]"}], ",", "2"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"chartcolors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"rgbcolors", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colorizedfeatures", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageMultiply", "[", 
          RowBox[{"colorized", ",", "#"}], "]"}], "&"}], "/@", "features"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"viewpoints", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<top\>\"", "\[RuleDelayed]", "Top"}], ",", 
         RowBox[{"\"\<back\>\"", "\[RuleDelayed]", "Back"}], ",", 
         RowBox[{"\"\<left\>\"", "\[RuleDelayed]", "Left"}], ",", 
         RowBox[{"\"\<bottom\>\"", "\[RuleDelayed]", "Bottom"}], ",", 
         RowBox[{"\"\<front\>\"", "\[RuleDelayed]", "Front"}], ",", 
         RowBox[{"\"\<right\>\"", "\[RuleDelayed]", "Right"}]}], "|>"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"StringReplace", "[", 
            RowBox[{"imagefile", ",", 
             RowBox[{"\"\<.\>\"", "\[Rule]", 
              RowBox[{"\"\<_\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"First", "[", "#2", "]"}], "]"}], "<>", 
               "\"\<.\>\""}]}]}], "]"}], ",", 
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Boxed", "->", "False"}], ",", 
             RowBox[{"ViewPoint", "\[Rule]", 
              RowBox[{"viewpoints", "[", "face", "]"}]}]}], "]"}]}], "]"}], 
         "&"}], ",", "colorizedfeatures"}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"intensity0", "=", "intensity"}], ";", "\[IndentingNewLine]", 
      RowBox[{"alpha0", "=", "alpha"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rangeOfAlpha", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "alpha", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "intensity0", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"intensity0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", "intensity0"}], "]"}]}], ";", 
         RowBox[{"alpha0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", "alpha0"}], "]"}]}], ";", 
         RowBox[{"rangeOfAlpha", "+=", "1"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "intensity0", "]"}], "<", "1"}], ",", 
        RowBox[{
         RowBox[{"intensity0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"intensity0", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
         RowBox[{"alpha0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"alpha0", ",", 
            RowBox[{"{", "0", "}"}]}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
         RowBox[{
         "PlotLegends", "\[Rule]", 
          "\"\<user specified transfer function\>\""}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"fun", "=", 
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"fun", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
         RowBox[{
         "PlotLegends", "\[Rule]", 
          "\"\<user specified transfer function\>\""}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"index0", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"alpha0", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VisibilitySaliency", "[", "peaks_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "alpha2", ",", "fun", ",", "vis", ",", "viss", ",", "vs", ",", 
           "mean", ",", "total"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"alpha2", "=", "alpha0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"alpha2", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "=", 
               RowBox[{"peaks", "[", 
                RowBox[{"[", 
                 RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}], 
            ",", "index0"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"fun", "=", 
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"intensity0", ",", "alpha2"}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vis", "=", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"f", "=", "fun"}], ",", 
               RowBox[{"data", "=", "d"}]}], "}"}], ",", 
             RowBox[{"renderslices2", "[", "face", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"viss", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageMultiply", "[", 
               RowBox[{"#", ",", "vis"}], "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"g1", ",", "g2"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"total", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageMeasurements", "[", 
               RowBox[{"#", ",", "\"\<TotalIntensity\>\""}], "]"}], "&"}], 
             ",", "viss"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vs", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"total", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"ImageMeasurements", "[", 
                   RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{
                    RowBox[{"viss", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\"\<TotalIntensity\>\""}], "]"}], "/", 
                  RowBox[{"total", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "features"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "total", "]"}]}], "}"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"mean", "=", 
           RowBox[{"Mean", "[", "vs", "]"}]}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Visibility", "[", "fun_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vis", ",", "viss", ",", "vs", ",", "mean", ",", "total"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vis", "=", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"f", "=", "fun"}], ",", 
               RowBox[{"data", "=", "d"}]}], "}"}], ",", 
             RowBox[{"renderslices2", "[", "face", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"viss", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageMultiply", "[", 
               RowBox[{"#", ",", "vis"}], "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"g1", ",", "g2"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"total", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageMeasurements", "[", 
               RowBox[{"#", ",", "\"\<TotalIntensity\>\""}], "]"}], "&"}], 
             ",", "viss"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vs", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"total", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"ImageMeasurements", "[", 
                   RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{
                    RowBox[{"viss", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\"\<TotalIntensity\>\""}], "]"}], "/", 
                  RowBox[{"total", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "features"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "total", "]"}]}], "}"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"mean", "=", 
           RowBox[{"Mean", "[", "vs", "]"}]}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ObjectiveFunction", "[", "pos_", "]"}], ":=", 
       RowBox[{"RootMeanSquare", "[", 
        RowBox[{
         RowBox[{"VisibilitySaliency", "[", "pos", "]"}], "-", "target"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"saveTransferFunction", "[", 
        RowBox[{"peaks_", ",", "filename_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "a2", ",", "rgba2", ",", "intensity2", ",", "rgbafunction2", ",", 
           "rgba2denormalized", ",", "xrgba", ",", "strlist", ",", 
           "alphaMode", ",", "gammaValue", ",", "domain", ",", "threshold", 
           ",", "k", ",", "int", ",", "split", ",", "colorL", ",", "keylist", 
           ",", "keys", ",", "TransFuncIntensity", ",", "VoreenData", ",", 
           "xmlobject"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"alpha0", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "=", 
               RowBox[{"peaks", "[", 
                RowBox[{"[", 
                 RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}], 
            ",", "index0"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"255", "*", 
               RowBox[{"alpha0", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
            "rangeOfAlpha"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rgba2", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "/", "255."}], "&"}], ")"}], "/@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"r", ",", "g", ",", "b", ",", "a2"}], "}"}], "]"}]}], "//", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"RGBColor", "/@", "#"}], "&"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"intensity2", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"intensity0", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "rangeOfAlpha"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"rgbafunction2", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"intensity2", ",", "rgba2"}], "}"}], "]"}], ",", " ",
                "#"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{"for", " ", "return", " ", 
            RowBox[{"only", ".", " ", "not"}], " ", "used", " ", "in", " ", 
            "this", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"rgba2denormalized", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"r", ",", "g", ",", "b", ",", "a2"}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"xrgba", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"intensity2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
               RowBox[{"rgba2denormalized", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "intensity2", "]"}]}], "}"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"strlist", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", "#1", "]"}], ",", 
               RowBox[{"ToString", "[", "#2", "]"}], ",", 
               RowBox[{"ToString", "[", "#3", "]"}], ",", 
               RowBox[{"ToString", "[", "#4", "]"}], ",", 
               RowBox[{"ToString", "[", "#5", "]"}]}], "}"}], "&"}], "@@@", 
            "xrgba"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"alphaMode", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<alphaMode\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"gammaValue", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<gammaValue\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"domain", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<domain\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
               RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"threshold", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<threshold\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<0\>\""}], ",", 
               RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<1\>\""}]}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"k", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"int", "=", 
                 RowBox[{"XMLElement", "[", 
                  RowBox[{"\"\<intensity\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "#1"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ",", 
                RowBox[{"split", "=", 
                 RowBox[{"XMLElement", "[", 
                  RowBox[{"\"\<split\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<value\>\"", "\[Rule]", "\"\<false\>\""}], 
                    "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ",", 
                RowBox[{"colorL", "=", 
                 RowBox[{"XMLElement", "[", 
                  RowBox[{"\"\<colorL\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<r\>\"", "\[Rule]", "#2"}], ",", 
                    RowBox[{"\"\<g\>\"", "\[Rule]", "#3"}], ",", 
                    RowBox[{"\"\<b\>\"", "\[Rule]", "#4"}], ",", 
                    RowBox[{"\"\<a\>\"", "\[Rule]", "#5"}]}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], "&"}], ")"}], "@@@",
             "strlist"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"keylist", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"XMLElement", "[", 
              RowBox[{"\"\<key\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<type\>\"", "\[Rule]", "\"\<TransFuncMappingKey\>\""}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@",
             "k"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"keys", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<Keys\>\"", ",", 
             RowBox[{"{", "}"}], ",", "keylist"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TransFuncIntensity", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<TransFuncIntensity\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<type\>\"", "\[Rule]", "\"\<TransFuncIntensity\>\""}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "alphaMode", ",", "gammaValue", ",", "domain", ",", "threshold",
                ",", "keys"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"VoreenData", "=", 
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<VoreenData\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<version\>\"", "\[Rule]", "\"\<1\>\""}], "}"}], ",", 
             RowBox[{"{", "TransFuncIntensity", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xmlobject", "=", 
           RowBox[{
            RowBox[{"XMLObject", "[", "\"\<Document\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Declaration\>\"", "]"}], "[", 
                RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<1.0\>\""}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"XMLObject", "[", "\"\<Comment\>\"", "]"}], "[", 
                "\"\<This is a Voreen transfer function exported from \
Mathematica\>\"", "]"}]}], "}"}], ",", "VoreenData", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"filename", ",", "xmlobject", ",", " ", "\"\<XML\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "rgbafunction2"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "nucleon", " ", "0.1", " ", "0.3", " ", "0.6", " ", "vortex", " ", 
        "0.4", " ", "0.3", " ", "0.3"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"targets", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"2", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.8"}], "}"}]}], ",", 
         RowBox[{"3", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.1", ",", "0.3", ",", "0.6"}], "}"}]}], ",", 
         RowBox[{"4", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.1", ",", "0.2", ",", "0.3", ",", "0.4"}], "}"}]}]}], 
        "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"target", "=", 
       RowBox[{"targets", "[", 
        RowBox[{"Length", "[", "index0", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "[", "8", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "f", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "data", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"records", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"epsilon", "=", "0.01"}], ";", "\[IndentingNewLine]", 
      RowBox[{"stepsize", "=", "0.05"}], ";", "\[IndentingNewLine]", 
      RowBox[{"iterationcount1", "=", "70"}], ";", "\[IndentingNewLine]", 
      RowBox[{"iterationcount2", "=", "30"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"k", "+", "1"}], ")"}]}], "=", 
        RowBox[{
         RowBox[{"x", 
          RowBox[{"(", "k", ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"f", "-", "f0"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f", "'"}], "-", 
            RowBox[{"f0", "'"}]}], ")"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"reset", " ", "peak", " ", "control", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"alpha0", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"peaks1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"alpha0", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "=", 
           RowBox[{"peaks1", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}], ",", 
        "index0"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "gradient", " ", "descent", " ", "with", " ", "fixed", " ", "step", 
        " ", "size"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iteration", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"previous", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"list", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "peaks", ",", "mean", ",", "steps", ",", "rms", ",", "peaks0", 
             ",", "gradient", ",", "direction", ",", "square"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mean", "=", 
             RowBox[{"Visibility", "[", 
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"rms", "=", 
             RowBox[{"RootMeanSquare", "[", 
              RowBox[{"mean", "-", "target"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"peaks", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"alpha0", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"gradient", ":=", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"mean", "-", "target"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"square", ":=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mean", "-", "target"}], ")"}], "^", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"steps", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "@", "previous"}], "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"-", "gradient"}], "*", "stepsize"}], ",", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "rms0", ",", "mean0", ",", "p0", ",", "g0", ",", "s0", ",", 
                   "dy", ",", "dx"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "rms0", ",", "mean0", ",", "p0", ",", "g0", ",", "s0"}], 
                    "}"}], "=", "previous"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"dy", "=", 
                   RowBox[{"square", "-", "s0"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"dx", "=", 
                   RowBox[{"gradient", "-", "g0"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Product", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "dx"}], "}"}]}], "]"}], "\[NotEqual]", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"direction", "=", 
                    RowBox[{
                    RowBox[{"Normalize", "[", 
                    RowBox[{"dy", "/", "dx"}], "]"}], "*", 
                    RowBox[{"Norm", "[", "gradient", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"-", "direction"}], "*", "stepsize"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "gradient"}], "*", "stepsize"}]}], "]"}]}]}],
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"previous", "=", 
             RowBox[{"{", 
              RowBox[{
              "rms", ",", "mean", ",", "peaks", ",", "gradient", ",", 
               "square"}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"peaks0", "=", "peaks"}], ";", "\[IndentingNewLine]", 
            RowBox[{"peaks", "=", 
             RowBox[{"Clip", "[", 
              RowBox[{
               RowBox[{"peaks", "+", "steps"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"alpha0", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "=", 
                 RowBox[{"peaks", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}],
               ",", "index0"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"t2", "\[Equal]", "0"}], " ", "&&", " ", 
               RowBox[{"rms", "<", "epsilon"}]}], ",", 
              RowBox[{
               RowBox[{"t2", "=", 
                RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
               RowBox[{"iteration", "=", "iterator"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "mean", ",", "peaks0", ",", "rms", ",", "steps", ",", "gradient",
               ",", "direction"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"iterator", ",", "iterationcount1"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"saliency5", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Iterations\>\"", ",", 
            "\"\<Visibility-weighted saliency\>\""}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_saliency_newton.png\>\""}], 
        ",", "saliency5"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"opacity5", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#2", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Opacity over iterations\>\""}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Opacity\>\""}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_opacity_newton.png\>\""}], 
        ",", "opacity5"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#2", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"saliencyopacity5", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "chartcolors", "]"}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_saliencyopacity_newton.png\>\""}], ",", "saliencyopacity5"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rmslist5", "=", 
       RowBox[{
        RowBox[{"#3", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rms5", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#3", "&"}], "@@@", "list"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Objective function\>\"", "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Objective function over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Root mean square\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_rms_newton.png\>\""}], ",", 
        "rms5"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"table5", "=", 
       RowBox[{"TableForm", "[", 
        RowBox[{"list", ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Visibility-Weighted Saliency\>\"", ",", "\"\<Opacity\>\"", 
              ",", " ", "\"\<Root Mean Square\>\"", ",", "\"\<Steps\>\""}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"TableSpacing", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_table_newton.png\>\""}], 
        ",", "table5"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"path5", "=", 
       RowBox[{
        RowBox[{"#2", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"records", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t2", "-", "t1"}], ",", "iteration", ",", 
          RowBox[{"Last", "[", "path5", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"reset", " ", "peak", " ", "control", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"alpha0", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"peaks1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"alpha0", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "=", 
           RowBox[{"peaks1", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}], ",", 
        "index0"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "gradient", " ", "descent", " ", "with", " ", "fixed", " ", "step", 
        " ", "size"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iteration", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"list", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "peaks", ",", "mean", ",", "steps", ",", "rms", ",", "peaks0", 
             ",", "gradient"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mean", "=", 
             RowBox[{"Visibility", "[", 
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"rms", "=", 
             RowBox[{"RootMeanSquare", "[", 
              RowBox[{"mean", "-", "target"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"peaks", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"alpha0", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"steps", "=", 
             RowBox[{
              RowBox[{"-", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"mean", "-", "target"}], ")"}], "*", "stepsize"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"gradient", "=", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"mean", "-", "target"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"peaks0", "=", "peaks"}], ";", "\[IndentingNewLine]", 
            RowBox[{"peaks", "=", 
             RowBox[{"Clip", "[", 
              RowBox[{
               RowBox[{"peaks", "+", "steps"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"alpha0", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "=", 
                 RowBox[{"peaks", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}],
               ",", "index0"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"t2", "\[Equal]", "0"}], " ", "&&", " ", 
               RowBox[{"rms", "<", "epsilon"}]}], ",", 
              RowBox[{
               RowBox[{"t2", "=", 
                RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
               RowBox[{"iteration", "=", "iterator"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "mean", ",", "peaks0", ",", "rms", ",", "steps", ",", 
              "gradient"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iterator", ",", "iterationcount1"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"saliency1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Iterations\>\"", ",", 
            "\"\<Visibility-weighted saliency\>\""}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_saliency_fixed.png\>\""}], 
        ",", "saliency1"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"opacity1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#2", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Opacity over iterations\>\""}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Opacity\>\""}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_opacity_fixed.png\>\""}], 
        ",", "opacity1"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#2", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"saliencyopacity1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "chartcolors", "]"}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_saliencyopacity_fixed.png\>\""}], ",", "saliencyopacity1"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rmslist1", "=", 
       RowBox[{
        RowBox[{"#3", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rms1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#3", "&"}], "@@@", "list"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Objective function\>\"", "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Objective function over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Root mean square\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_rms_fixed.png\>\""}], ",", 
        "rms1"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"table1", "=", 
       RowBox[{"TableForm", "[", 
        RowBox[{"list", ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Visibility-Weighted Saliency\>\"", ",", "\"\<Opacity\>\"", 
              ",", " ", "\"\<Root Mean Square\>\"", ",", "\"\<Steps\>\""}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"TableSpacing", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_table_fixed.png\>\""}], ",",
         "table1"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"path1", "=", 
       RowBox[{
        RowBox[{"#2", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"records", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t2", "-", "t1"}], ",", "iteration", ",", 
          RowBox[{"Last", "[", "path1", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rmslists1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rmslist1", ",", "rmslist5"}], "}"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Method 1\>\"", ",", "\"\<Method 2\>\""}], "}"}]}], 
         ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Objective function over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Objective function\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_rms_fixed_newton.png\>\""}],
         ",", "rmslists1"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"reset", " ", "peak", " ", "control", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"alpha0", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"peaks1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"alpha0", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "=", 
           RowBox[{"peaks1", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}], ",", 
        "index0"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"parallel", " ", "gradient"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"multipliers", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "4", ",", "8"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"previous", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iteration", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"list", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "peaks", ",", "mean", ",", "steps", ",", "rms", ",", "meanlist", 
             ",", "peaklist", ",", "rmslist", ",", "minindex"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mean", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", "previous", "]"}], ">", "0"}], ",", 
               "previous", ",", 
               RowBox[{"Visibility", "[", 
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"rms", "=", 
             RowBox[{"RootMeanSquare", "[", 
              RowBox[{"mean", "-", "target"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"peaks", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"alpha0", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"steps", "=", 
             RowBox[{
              RowBox[{"-", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"mean", "-", "target"}], ")"}], "*", "stepsize"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"peaklist", "=", 
             RowBox[{"ParallelMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Clip", "[", 
                 RowBox[{
                  RowBox[{"peaks", "+", 
                   RowBox[{"steps", "*", "#"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
               "multipliers"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"meanlist", "=", 
             RowBox[{"ParallelMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"VisibilitySaliency", "[", "#", "]"}], "&"}], ",", 
               "peaklist"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"rmslist", "=", 
             RowBox[{"ParallelMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"RootMeanSquare", "[", 
                 RowBox[{"#", "-", "target"}], "]"}], "&"}], ",", 
               "meanlist"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"minindex", "=", 
             RowBox[{"First", "@", 
              RowBox[{"Ordering", "[", 
               RowBox[{"rmslist", ",", "1"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"alpha0", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"peaklist", "[", 
                   RowBox[{"[", "minindex", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}],
               ",", "index0"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"previous", "=", 
             RowBox[{"meanlist", "[", 
              RowBox[{"[", "minindex", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"t2", "\[Equal]", "0"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"rmslist", "[", 
                 RowBox[{"[", "minindex", "]"}], "]"}], "<", "epsilon"}]}], 
              ",", 
              RowBox[{
               RowBox[{"t2", "=", 
                RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
               RowBox[{"iteration", "=", "iterator"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"mean", ",", "peaks", ",", "rms", ",", "steps", ",", 
              RowBox[{"multipliers", "[", 
               RowBox[{"[", "minindex", "]"}], "]"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iterator", ",", "iterationcount2"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"saliency2", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Iterations\>\"", ",", 
            "\"\<Visibility-weighted saliency\>\""}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_saliency_parallelsearch.png\>\""}], ",", "saliency2"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"opacity2", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#2", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Opacity over iterations\>\""}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Opacity\>\""}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_opacity_parallelsearch.png\>\""}], ",", "opacity2"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#2", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"saliencyopacity2", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "chartcolors", "]"}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_saliencyopacity_parallelsearch.png\>\""}], ",", 
        "saliencyopacity2"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rmslist2", "=", 
       RowBox[{
        RowBox[{"#3", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rms2", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#3", "&"}], "@@@", "list"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Objective function\>\"", "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Objective function over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Root mean square\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_rms_parallelsearch.png\>\""}], ",", "rms2"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"table2", "=", 
       RowBox[{"TableForm", "[", 
        RowBox[{"list", ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Visibility-Weighted Saliency\>\"", ",", "\"\<Opacity\>\"", 
              ",", " ", "\"\<Root Mean Square\>\"", ",", "\"\<Steps\>\"", 
              ",", "\"\<Multiplier\>\""}], "}"}]}], "}"}]}], ",", 
         RowBox[{"TableSpacing", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_table_parallelsearch.png\>\""}], ",", "table2"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"path2", "=", 
       RowBox[{
        RowBox[{"#2", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"records", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t2", "-", "t1"}], ",", "iteration", ",", 
          RowBox[{"Last", "[", "path2", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"reset", " ", "peak", " ", "control", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"alpha0", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"peaks1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"alpha0", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "=", 
           RowBox[{"peaks1", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}], ",", 
        "index0"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"line", " ", "search"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"previous", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iteration", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"list", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "peaks", ",", "mean", ",", "steps", ",", "rms", ",", "peaklist", 
             ",", "minindex", ",", "minrms", ",", "minmean", ",", "r2", ",", 
             "mean2"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mean", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", "previous", "]"}], ">", "0"}], ",", 
               "previous", ",", 
               RowBox[{"Visibility", "[", 
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"intensity0", ",", "alpha0"}], "}"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"rms", "=", 
             RowBox[{"RootMeanSquare", "[", 
              RowBox[{"mean", "-", "target"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"peaks", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"alpha0", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "index0"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"steps", "=", 
             RowBox[{
              RowBox[{"-", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"mean", "-", "target"}], ")"}], "*", "stepsize"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"peaklist", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Clip", "[", 
                 RowBox[{
                  RowBox[{"peaks", "+", 
                   RowBox[{"steps", "*", "#"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
               "multipliers"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"minindex", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"minmean", "=", 
             RowBox[{"VisibilitySaliency", "[", 
              RowBox[{"peaklist", "[", 
               RowBox[{"[", "minindex", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"minrms", "=", 
             RowBox[{"RootMeanSquare", "[", 
              RowBox[{"minmean", "-", "target"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mean2", "=", 
                RowBox[{"VisibilitySaliency", "[", 
                 RowBox[{"peaklist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r2", "=", 
                RowBox[{"RootMeanSquare", "[", 
                 RowBox[{"mean2", "-", "target"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"r2", "<", "minrms"}], ",", 
                 RowBox[{
                  RowBox[{"minrms", "=", "r2"}], ";", 
                  RowBox[{"minmean", "=", "mean2"}], ";", 
                  RowBox[{"minindex", "=", "i"}]}], ",", 
                 RowBox[{"Return", "[", "i", "]"}]}], "]"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"2", ",", "4"}], "]"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"alpha0", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"peaklist", "[", 
                   RowBox[{"[", "minindex", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "@", "#2"}], "]"}], "]"}]}], ")"}], "&"}],
               ",", "index0"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"previous", "=", "minmean"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"t2", "\[Equal]", "0"}], " ", "&&", " ", 
               RowBox[{"minrms", "<", "epsilon"}]}], ",", 
              RowBox[{
               RowBox[{"t2", "=", 
                RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
               RowBox[{"iteration", "=", "iterator"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"mean", ",", "peaks", ",", "rms", ",", "steps", ",", 
              RowBox[{"multipliers", "[", 
               RowBox[{"[", "minindex", "]"}], "]"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iterator", ",", "iterationcount2"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"saliency3", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Iterations\>\"", ",", 
            "\"\<Visibility-weighted saliency\>\""}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_saliency_linesearch.png\>\""}], ",", "saliency3"}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"opacity3", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"#2", "&"}], "@@@", "list"}], "]"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Opacity over iterations\>\""}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Opacity\>\""}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_opacity_linesearch.png\>\""}], ",", "opacity3"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#2", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"#", "&"}], "@@@", "list"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"saliencyopacity3", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "chartcolors", "]"}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "chartcolors"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Visibility-weighted saliency vs opacity\>\""}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Opacity\>\"", ",", "\"\<Visibility-weighted saliency\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Feature 1\>\"", ",", "\"\<Feature 2\>\"", ",", 
            "\"\<Feature 3\>\"", ",", "\"\<Feature 4\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_saliencyopacity_linesearch.png\>\""}], ",", 
        "saliencyopacity3"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rmslist3", "=", 
       RowBox[{
        RowBox[{"#3", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rms3", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#3", "&"}], "@@@", "list"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Objective function\>\"", "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Objective function over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Root mean square\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_rms_linesearch.png\>\""}], 
        ",", "rms3"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"table3", "=", 
       RowBox[{"TableForm", "[", 
        RowBox[{"list", ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Visibility-Weighted Saliency\>\"", ",", "\"\<Opacity\>\"", 
              ",", " ", "\"\<Root Mean Square\>\"", ",", "\"\<Steps\>\"", 
              ",", "\"\<Multiplier\>\""}], "}"}]}], "}"}]}], ",", 
         RowBox[{"TableSpacing", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", "\"\<_table_linesearch.png\>\""}],
         ",", "table3"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"path3", "=", 
       RowBox[{
        RowBox[{"#2", "&"}], "@@@", "list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"records", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t2", "-", "t1"}], ",", "iteration", ",", 
          RowBox[{"Last", "[", "path3", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"dataname", ",", 
        RowBox[{"t2", "-", "t1"}], ",", "iteration", ",", 
        RowBox[{"Last", "[", "path3", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rmslists2", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rmslist1", ",", "rmslist2", ",", "rmslist3"}], "}"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Fixed step size\>\"", ",", "\"\<Line search\>\"", ",", 
            "\"\<Parallel line search\>\""}], "}"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Objective function over iterations\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Iterations\>\"", ",", "\"\<Objective function\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "plotpath", "<>", "dataname", "<>", 
         "\"\<_rms_fixed_linesearch_parallel.png\>\""}], ",", "rmslists2"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"recordxml", "=", 
       RowBox[{"plotpath", "<>", "\"\<records.xml\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"recordmap", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "recordxml", "]"}], ",", 
         RowBox[{"Association", "@", 
          RowBox[{"Import", "[", "recordxml", "]"}]}], ",", 
         RowBox[{"<|", "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"recordmap", ",", 
        RowBox[{"dataname", "\[Rule]", "records"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"recordxml", ",", 
        RowBox[{"Normal", "[", "recordmap", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tf1", "=", 
       RowBox[{"saveTransferFunction", "[", 
        RowBox[{
         RowBox[{"Last", "[", "path1", "]"}], ",", 
         RowBox[{
         "plotpath", "<>", "dataname", "<>", 
          "\"\<_optimized_fixed.tfi\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tf2", "=", 
       RowBox[{"saveTransferFunction", "[", 
        RowBox[{
         RowBox[{"Last", "[", "path2", "]"}], ",", 
         RowBox[{
         "plotpath", "<>", "dataname", "<>", 
          "\"\<_optimized_parallelsearch.tfi\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tf3", "=", 
       RowBox[{"saveTransferFunction", "[", 
        RowBox[{
         RowBox[{"Last", "[", "path3", "]"}], ",", 
         RowBox[{
         "plotpath", "<>", "dataname", "<>", 
          "\"\<_optimized_linesearch.tfi\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataname", "\[Rule]", "records"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xmlstr", ",", "vorts"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time2", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"time2", "-", "time1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Image3D", "[", 
     RowBox[{"d", ",", 
      RowBox[{"ColorFunction", "\[Rule]", "rgbafunction"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"viewpoints", "[", "face", "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Image3D", "[", 
     RowBox[{"d", ",", 
      RowBox[{"ColorFunction", "\[Rule]", "tf3"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"viewpoints", "[", "face", "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"intensity", ",", "alpha"}], "}"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "\"\<Before optimization\>\""}]}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"intensity", ",", "r", ",", "g", ",", "b", ",", "a"}], "}"}], 
      "]"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"intensity0", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "rangeOfAlpha"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"alpha0", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "rangeOfAlpha"}]}], 
        "}"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "rgbfunction"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "\"\<After optimization\>\""}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", "xrgba", "*)"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.650016010847435*^9, 3.6500160344620285`*^9}, 
   3.6500160970401473`*^9, 3.6500165656694775`*^9, 3.650016713948494*^9, 
   3.650017085260745*^9, {3.6500171411902285`*^9, 3.6500171817495975`*^9}, {
   3.650017233984085*^9, 3.6500172898926163`*^9}, {3.6500174423929048`*^9, 
   3.6500174871293154`*^9}, {3.6500175403349094`*^9, 
   3.6500175986715207`*^9}, {3.6500176324156456`*^9, 3.650017632994951*^9}, {
   3.6500177269517217`*^9, 3.65001777747255*^9}, 3.6500222412081485`*^9, 
   3.6500225840162363`*^9, {3.650025621303483*^9, 3.6500256222287245`*^9}, 
   3.6500395269270196`*^9, 3.65003979959371*^9, {3.650045015344633*^9, 
   3.6500450580942793`*^9}, 3.6500451183246503`*^9, 3.6500451733582335`*^9, 
   3.650045343145255*^9, {3.65009686307224*^9, 3.6500969160928507`*^9}, {
   3.6500969618530903`*^9, 3.6500969752331004`*^9}, {3.6500971869883966`*^9, 
   3.6500972288452*^9}, 3.6501073780119085`*^9, 3.650107723220256*^9, {
   3.6501079238588104`*^9, 3.6501079321720405`*^9}, 3.650128318028931*^9, {
   3.650128936247884*^9, 3.6501289619536343`*^9}, {3.65013095222859*^9, 
   3.650130952964272*^9}, {3.6501312946084805`*^9, 3.650131298228372*^9}, {
   3.6501317605222197`*^9, 3.6501317725783114`*^9}, {3.650135334384781*^9, 
   3.6501353376933403`*^9}, {3.650137703884256*^9, 3.6501377064503856`*^9}, 
   3.6501398070716214`*^9, 3.6502659151440983`*^9, 3.650266777120908*^9, 
   3.6503712217213182`*^9, {3.6503715511097264`*^9, 3.6503715528021455`*^9}, {
   3.6503716788627462`*^9, 3.6503716842142973`*^9}, {3.6503720868285866`*^9, 
   3.6503720978840017`*^9}, {3.6512705809146957`*^9, 3.651270583350629*^9}, 
   3.651273752937693*^9, {3.6520098937075024`*^9, 3.652009897594437*^9}, 
   3.652390402197175*^9, {3.6523939877015543`*^9, 3.6523939878690786`*^9}, {
   3.6523941334575434`*^9, 3.6523941342598553`*^9}, 3.652441919495344*^9, 
   3.6524434241756444`*^9, 3.652465585937043*^9, 3.6524667391036024`*^9, 
   3.652467745885472*^9, 3.6524677846309423`*^9, 3.6524683081870394`*^9, 
   3.652468863433117*^9, 3.6525253391781206`*^9, {3.652525835099517*^9, 
   3.6525258592246895`*^9}, {3.652619000156124*^9, 3.6526190056952176`*^9}, {
   3.6526190731134977`*^9, 3.6526190925157733`*^9}, {3.6526192463109617`*^9, 
   3.6526192526253624`*^9}, 3.6526193475159454`*^9, {3.652639759476675*^9, 
   3.6526397665117474`*^9}, {3.6526404928622627`*^9, 
   3.6526405005423727`*^9}, {3.652642067915524*^9, 3.652642068215149*^9}, {
   3.6526436663258247`*^9, 3.652643712675127*^9}, {3.6526437726157126`*^9, 
   3.6526437811764755`*^9}, {3.65264389239963*^9, 3.652643894665254*^9}, {
   3.6527009063861103`*^9, 3.6527009113417983`*^9}, 3.652717984283203*^9, {
   3.652718224177024*^9, 3.6527182252160816`*^9}, {3.6527251570443673`*^9, 
   3.652725184157651*^9}, 3.6528885750381627`*^9, {3.652893889959538*^9, 
   3.652893921274851*^9}, 3.6528940077188444`*^9, {3.652894059093927*^9, 
   3.652894064227418*^9}, 3.6528941308544335`*^9, {3.652894180635068*^9, 
   3.652894180822584*^9}, {3.652894901210397*^9, 3.6528949033995204`*^9}, {
   3.652905809064406*^9, 3.6529058147252455`*^9}, 3.6531287319809914`*^9, {
   3.6531290324200163`*^9, 3.6531290334512763`*^9}, 3.6531290652683744`*^9, 
   3.6531298732367697`*^9, 3.6531342387391615`*^9, {3.653134494769705*^9, 
   3.6531344961549644`*^9}, {3.653135146970539*^9, 3.6531351478298626`*^9}, {
   3.6531367529972625`*^9, 3.6531367541222725`*^9}, {3.6531372129251857`*^9, 
   3.6531372385366488`*^9}, {3.653138073805985*^9, 3.653138077194366*^9}, {
   3.6531384383401384`*^9, 3.6531384418141303`*^9}, {3.653139351635395*^9, 
   3.653139355702466*^9}, {3.6531725282856417`*^9, 3.6531725344339857`*^9}, {
   3.653174033615883*^9, 3.6531740393839593`*^9}, {3.653175514157439*^9, 
   3.6531755174484024`*^9}, {3.653176190989702*^9, 3.6531761942086744`*^9}, {
   3.6531774230834312`*^9, 3.653177430776275*^9}, {3.6531786647992477`*^9, 
   3.6531786671480803`*^9}, 3.6531830891891823`*^9, {3.653215542876462*^9, 
   3.6532155448283787`*^9}, {3.653222308052495*^9, 3.653222309757191*^9}, 
   3.653229916991674*^9, 3.653236770831257*^9, {3.653247604176057*^9, 
   3.653247609391593*^9}, {3.653248830540564*^9, 3.6532488605949802`*^9}, {
   3.653299680172884*^9, 3.6532996837270966`*^9}, {3.6533301487003107`*^9, 
   3.6533301584464912`*^9}, 3.6533303967117567`*^9, {3.6533306048302593`*^9, 
   3.653330634418811*^9}, 3.6533306851258993`*^9, 3.653330740361678*^9, 
   3.6533309102918305`*^9, 3.6533310251544056`*^9, 3.653331723729951*^9, 
   3.6533318238305097`*^9, 3.6533319231023006`*^9, 3.6533320027809577`*^9, 
   3.653332114032469*^9, 3.65333232331271*^9, {3.653332884349699*^9, 
   3.6533328870834846`*^9}, {3.6533335919705477`*^9, 
   3.6533335956515074`*^9}, {3.6533339310142403`*^9, 3.653333934351056*^9}, {
   3.653394147263233*^9, 3.6533941502879705`*^9}, {3.6533944740201406`*^9, 
   3.6533944769822283`*^9}, {3.653403178464492*^9, 3.653403181887129*^9}, {
   3.653403521835101*^9, 3.6534035345433207`*^9}, {3.653404518236615*^9, 
   3.6534045214666348`*^9}, {3.6534252350196095`*^9, 3.653425269491725*^9}, {
   3.65347162891201*^9, 3.653471666888797*^9}, {3.6534729494060755`*^9, 
   3.653472965806373*^9}, {3.6534745222349763`*^9, 3.653474522726985*^9}, {
   3.653476482075961*^9, 3.6534764885936155`*^9}, 3.653511520296916*^9, 
   3.6535130225135717`*^9, 3.653513194213627*^9, 3.6535134585473757`*^9, {
   3.653513619582384*^9, 3.653513621780954*^9}, {3.6535875807493124`*^9, 
   3.6535875846604147`*^9}, {3.6536021369107513`*^9, 3.653602140486471*^9}, {
   3.653602223317255*^9, 3.653602229161172*^9}, {3.653602270629915*^9, 
   3.6536022717551994`*^9}, {3.6536023249604516`*^9, 3.6536023710711145`*^9}, 
   3.653603111758416*^9, {3.6536455779582453`*^9, 3.653645581450263*^9}, {
   3.6536457183840413`*^9, 3.6536457187278166`*^9}, 3.6536546329541683`*^9, 
   3.653663342703579*^9, 3.6536638774221134`*^9, {3.6536640240483503`*^9, 
   3.653664024251506*^9}, {3.653666840786741*^9, 3.653666841119795*^9}, 
   3.6536677601014314`*^9, 3.65367789312068*^9, {3.6536782954082136`*^9, 
   3.653678296149723*^9}, {3.6536784926590223`*^9, 3.6536784928220716`*^9}, {
   3.653680472171296*^9, 3.6536804750432653`*^9}, {3.6536831000181384`*^9, 
   3.653683100221281*^9}, {3.6537233737719545`*^9, 3.653723377513708*^9}, {
   3.6537238757758293`*^9, 3.6537238787562304`*^9}, {3.6537303586855416`*^9, 
   3.6537303619134235`*^9}, {3.6537379100379615`*^9, 
   3.6537379129130545`*^9}, {3.65373933615511*^9, 3.653739339378091*^9}, {
   3.6537395663578253`*^9, 3.6537395693185024`*^9}, {3.6537497164667845`*^9, 
   3.653749719762285*^9}, 3.653750966456008*^9, 3.6537523596080976`*^9, {
   3.653753354598487*^9, 3.6537533626550493`*^9}, 3.6537547025391455`*^9, {
   3.653754900047403*^9, 3.6537549006175137`*^9}, 3.6537549988726244`*^9, {
   3.6537555963928385`*^9, 3.653755596759486*^9}, 3.653760087890825*^9, {
   3.6537603796103244`*^9, 3.6537603890387464`*^9}, {3.6537610106968837`*^9, 
   3.6537610142393913`*^9}, {3.6537624402819843`*^9, 
   3.6537624439467793`*^9}, {3.653762570789426*^9, 3.6537625911977797`*^9}, {
   3.6537628084934263`*^9, 3.65376284454373*^9}, {3.653762984628009*^9, 
   3.653762984723015*^9}, {3.6537654143577757`*^9, 3.6537654484147573`*^9}, {
   3.653765675727414*^9, 3.6537656929883037`*^9}, 3.6537688274594107`*^9, 
   3.6537762483025503`*^9, {3.6537765795518446`*^9, 3.653776579692504*^9}, {
   3.6537766212895823`*^9, 3.653776625551359*^9}, {3.6537767317867336`*^9, 
   3.653776756520371*^9}, {3.653776810271597*^9, 3.653776893993781*^9}, {
   3.653776946988154*^9, 3.653777009081972*^9}, {3.6537770710048313`*^9, 
   3.65377716107334*^9}, {3.653777205725375*^9, 3.653777524443367*^9}, {
   3.653777562145019*^9, 3.6537776415688534`*^9}, {3.653777671958002*^9, 
   3.6537776726772594`*^9}, {3.653777723190691*^9, 3.6537777340353355`*^9}, {
   3.653777857083187*^9, 3.653777884131556*^9}, {3.653777980034647*^9, 
   3.653777996539095*^9}, {3.653778276318203*^9, 3.6537783076932807`*^9}, {
   3.653778803115438*^9, 3.653778804256445*^9}, {3.6537788548787956`*^9, 
   3.6537789119428177`*^9}, {3.653778942645255*^9, 3.653778966503978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts1\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537826990183141`17.315317704200687*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.040626876909059056`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts1", -3.6537826990183141`17.315317704200687*^9, 0, {0., 
   0.040626876909059056`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537791275978827`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts2\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537828308394268`17.31531771986916*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04302531320422933`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts2", -3.6537828308394268`17.31531771986916*^9, 0, {0., 
   0.04302531320422933, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653779259770001*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts3\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537829617535432`17.315317735429822*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04608516254932969`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts3", -3.6537829617535432`17.315317735429822*^9, 0, {0., 
   0.04608516254932969, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537793901903777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts4\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537830935804651`17.31531775109898*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04828849439139876`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts4", -3.6537830935804651`17.31531775109898*^9, 0, {0., 
   0.04828849439139876, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537795223158593`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts5\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537832284346785`17.315317767127965*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.050751861022891726`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts5", -3.6537832284346785`17.315317767127965*^9, 0, {0., 
   0.050751861022891726`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537796571601686`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts6\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537833661293263`17.31531778349457*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.050768107362572465`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts6", -3.6537833661293263`17.31531778349457*^9, 0, {0., 
   0.050768107362572465`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537797946912184`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts7\"\>", "\[InvisibleSpace]", 
   "16.0654225`8.657437144921374", "\[InvisibleSpace]", "17", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.004423284004876686`", ",", "0.05270459310211791`", ",", 
     "0.999799435669735`"}], "}"}]}],
  SequenceForm[
  "vorts7", 16.0654225`8.657437144921374, 17, {0.004423284004876686, 
   0.05270459310211791, 0.999799435669735}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537799332702727`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts8\"\>", "\[InvisibleSpace]", 
   "5.0774808`8.157193283333562", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005393921803707231`", ",", "0.05870439167858004`", ",", "1.`"}], 
    "}"}]}],
  SequenceForm[
  "vorts8", 5.0774808`8.157193283333562, 5, {0.005393921803707231, 
   0.05870439167858004, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653780075286208*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts9\"\>", "\[InvisibleSpace]", 
   "4.2164626`8.076493245986521", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.006090785871656745`", ",", "0.06455031847273797`", ",", "1.`"}], 
    "}"}]}],
  SequenceForm[
  "vorts9", 4.2164626`8.076493245986521, 4, {0.006090785871656745, 
   0.06455031847273797, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537802235049286`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts10\"\>", "\[InvisibleSpace]", 
   "6.9688221`8.294704371493486", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.004972510382510535`", ",", "0.05597255107472579`", ",", 
     "0.9999956152841294`"}], "}"}]}],
  SequenceForm[
  "vorts10", 6.9688221`8.294704371493486, 7, {0.004972510382510535, 
   0.05597255107472579, 0.9999956152841294}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537803697060304`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts11\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653784089649097`17.31531786949327*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.05142789961267765`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts11", -3.653784089649097`17.31531786949327*^9, 0, {0., 
   0.05142789961267765, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537805182852583`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts12\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537842402387203`17.315317887392585*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04835145504477405`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts12", -3.6537842402387203`17.315317887392585*^9, 0, {0., 
   0.04835145504477405, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653780670316286*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts13\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537843959412644`17.315317905899633*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.046716507915096406`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts13", -3.6537843959412644`17.315317905899633*^9, 0, {0., 
   0.046716507915096406`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537808254097652`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts14\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537845541452701`17.315317924704004*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.045078005769248614`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts14", -3.6537845541452701`17.315317924704004*^9, 0, {0., 
   0.045078005769248614`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537809834701214`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts15\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537847161292994`17.315317943957677*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.039329932086826155`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts15", -3.6537847161292994`17.315317943957677*^9, 0, {0., 
   0.039329932086826155`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653781145035265*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts16\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653784880078801`17.31531796344497*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.0359581045204955`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts16", -3.653784880078801`17.31531796344497*^9, 0, {0., 
   0.0359581045204955, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537813090016756`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts17\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537850494584622`17.315317983577692*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03595896341403716`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts17", -3.6537850494584622`17.315317983577692*^9, 0, {0., 
   0.03595896341403716, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537814784266644`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts18\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537852230095951`17.315318004206244*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03419923184424558`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts18", -3.6537852230095951`17.315318004206244*^9, 0, {0., 
   0.03419923184424558, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537816516431804`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts19\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537854018624876`17.315318025464972*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03434393099594928`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts19", -3.6537854018624876`17.315318025464972*^9, 0, {0., 
   0.03434393099594928, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537818304247704`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts20\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537855856748103`17.315318047313184*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03452517820617307`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts20", -3.6537855856748103`17.315318047313184*^9, 0, {0., 
   0.03452517820617307, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537820144571114`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts21\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653785775894292`17.31531806992296*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03540817578074572`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts21", -3.653785775894292`17.31531806992296*^9, 0, {0., 
   0.03540817578074572, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653782204659047*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts22\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537859711441312`17.31531809313065*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03734890635231152`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts22", -3.6537859711441312`17.31531809313065*^9, 0, {0., 
   0.03734890635231152, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653782400142988*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts23\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537861741933672`17.315318117265385*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03934258245144348`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts23", -3.6537861741933672`17.315318117265385*^9, 0, {0., 
   0.03934258245144348, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537826035049314`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts24\"\>", "\[InvisibleSpace]", 
   "1.2969624`7.564472379210569", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.014489078628801558`", ",", "0.0890919309063642`", ",", 
     "0.978771931641307`"}], "}"}]}],
  SequenceForm[
  "vorts24", 1.2969624`7.564472379210569, 2, {0.014489078628801558`, 
   0.0890919309063642, 0.978771931641307}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537827337077885`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts25\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537865194557056`17.315318158303782*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03764484898013857`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts25", -3.6537865194557056`17.315318158303782*^9, 0, {0., 
   0.03764484898013857, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653782948363084*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts26\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537867398797053`17.315318184503703*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03812145377124293`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts26", -3.6537867398797053`17.315318184503703*^9, 0, {0., 
   0.03812145377124293, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537831689726653`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts27\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653786968424688`17.315318211668895*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03820350041917378`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts27", -3.653786968424688`17.315318211668895*^9, 0, {0., 
   0.03820350041917378, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653783398565872*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts28\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653787204584267`17.31531823973917*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.038202885689293586`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts28", -3.653787204584267`17.31531823973917*^9, 0, {0., 
   0.038202885689293586`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537836338647547`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts29\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537874479268408`17.315318268663223*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03914203152447793`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts29", -3.6537874479268408`17.315318268663223*^9, 0, {0., 
   0.03914203152447793, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537838773618116`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts30\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537876998559272`17.315318298607878*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03801784490929598`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts30", -3.6537876998559272`17.315318298607878*^9, 0, {0., 
   0.03801784490929598, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537841291139097`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts31\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537879597854683`17.315318329503476*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03619684341275622`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts31", -3.6537879597854683`17.315318329503476*^9, 0, {0., 
   0.03619684341275622, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653784389052147*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts32\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537882260511886`17.3153183611522*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03422953584395448`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts32", -3.6537882260511886`17.3153183611522*^9, 0, {0., 
   0.03422953584395448, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653784655082428*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts33\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537885003209508`17.315318393752293*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03260632731846137`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts33", -3.6537885003209508`17.315318393752293*^9, 0, {0., 
   0.03260632731846137, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537849292525773`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts34\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537887839564341`17.31531842746561*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.031345842723283585`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts34", -3.6537887839564341`17.31531842746561*^9, 0, {0., 
   0.031345842723283585`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537852141121197`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts35\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537890763319499`17.31531846221777*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03174384848440556`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts35", -3.6537890763319499`17.31531846221777*^9, 0, {0., 
   0.03174384848440556, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653785505020449*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts36\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537893790363896`17.315318498197648*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03303823586272883`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts36", -3.6537893790363896`17.315318498197648*^9, 0, {0., 
   0.03303823586272883, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537858078940897`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts37\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537896909120157`17.315318535267615*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03476441656146889`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts37", -3.6537896909120157`17.315318535267615*^9, 0, {0., 
   0.03476441656146889, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537861215791836`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts38\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537900165350141`17.315318573971613*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03685909401845923`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts38", -3.6537900165350141`17.315318573971613*^9, 0, {0., 
   0.03685909401845923, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537864458306036`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts39\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537903494101716`17.315318613537606*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03685925916909099`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts39", -3.6537903494101716`17.315318613537606*^9, 0, {0., 
   0.03685925916909099, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653786778676874*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts40\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537906949583656`17.31531865460993*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03871266685565365`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts40", -3.6537906949583656`17.31531865460993*^9, 0, {0., 
   0.03871266685565365, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537871242377386`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts41\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537910476923225`17.315318696536366*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.040105879749981234`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts41", -3.6537910476923225`17.315318696536366*^9, 0, {0., 
   0.040105879749981234`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537874768631287`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts42\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537914122065895`17.315318739863013*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.041210091306482816`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts42", -3.6537914122065895`17.315318739863013*^9, 0, {0., 
   0.041210091306482816`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537878414878016`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts43\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537917909569575`17.315318784881782*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04178450588279352`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts43", -3.6537917909569575`17.315318784881782*^9, 0, {0., 
   0.04178450588279352, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653788220175789*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts44\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537921782706265`17.31531883091839*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.041975184960297854`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts44", -3.6537921782706265`17.31531883091839*^9, 0, {0., 
   0.041975184960297854`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537886077221355`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts45\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537925809734347`17.315318878784165*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.042715949821970724`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts45", -3.6537925809734347`17.315318878784165*^9, 0, {0., 
   0.042715949821970724`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537890105681486`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts46\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653792995050709`17.31531892800192*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04221356480433307`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts46", -3.653792995050709`17.31531892800192*^9, 0, {0., 
   0.04221356480433307, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.65378942383112*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts47\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653793421472311`17.315318978686932*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04147182751050159`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts47", -3.653793421472311`17.315318978686932*^9, 0, {0., 
   0.04147182751050159, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537898504873466`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts48\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537938679719579`17.31531903175844*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.002578127775058188`", ",", "0.0407388910119684`", ",", "1.`"}],
     "}"}]}],
  SequenceForm[
  "vorts48", -3.6537938679719579`17.31531903175844*^9, 0, {
   0.002578127775058188, 0.0407388910119684, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537902967991714`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts49\"\>", "\[InvisibleSpace]", 
   "6.4822927`8.263273630671163", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005378723463552785`", ",", "0.04396856501021491`", ",", 
     "0.9999984952856773`"}], "}"}]}],
  SequenceForm[
  "vorts49", 6.4822927`8.263273630671163, 6, {0.005378723463552785, 
   0.04396856501021491, 0.9999984952856773}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537907602210293`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts50\"\>", "\[InvisibleSpace]", 
   "6.4848545`8.263445229805662", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005376225469613022`", ",", "0.043951825728452916`", ",", 
     "0.9999983497925851`"}], "}"}]}],
  SequenceForm[
  "vorts50", 6.4848545`8.263445229805662, 6, {0.005376225469613022, 
   0.043951825728452916`, 0.9999983497925851}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537912489256926`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts51\"\>", "\[InvisibleSpace]", 
   "6.0143245`8.23073185004355", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0052306081988852515`", ",", "0.04282468540170854`", ",", 
     "0.9999998410651119`"}], "}"}]}],
  SequenceForm[
  "vorts51", 6.0143245`8.23073185004355, 6, {0.0052306081988852515`, 
   0.04282468540170854, 0.9999998410651119}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537917652242107`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts52\"\>", "\[InvisibleSpace]", 
   "14.2362667`8.60494110890908", "\[InvisibleSpace]", "15", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.004249158910642464`", ",", "0.04025881796891412`", ",", 
     "0.9998349512135081`"}], "}"}]}],
  SequenceForm[
  "vorts52", 14.2362667`8.60494110890908, 15, {0.004249158910642464, 
   0.04025881796891412, 0.9998349512135081}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653792270252356*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts53\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537963768795328`17.315319329970208*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04088350847370556`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts53", -3.6537963768795328`17.315319329970208*^9, 0, {0., 
   0.04088350847370556, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537928064083796`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts54\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537969160976913`17.3153193940623*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.039826758975971814`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts54", -3.6537969160976913`17.3153193940623*^9, 0, {0., 
   0.039826758975971814`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653793345613341*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts55\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537974577211653`17.315319458440282*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.039343774101178744`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts55", -3.6537974577211653`17.315319458440282*^9, 0, {0., 
   0.039343774101178744`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653793887113826*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts56\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537981066596631`17.31531953557383*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03880501883249876`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts56", -3.6537981066596631`17.31531953557383*^9, 0, {0., 
   0.03880501883249876, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537945359730115`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts57\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537987480477081`17.31531961180992*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03961790683936384`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts57", -3.6537987480477081`17.31531961180992*^9, 0, {0., 
   0.03961790683936384, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653795177189822*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts58\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6537994178323871`17.315319691421244*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.040403837660027274`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts58", -3.6537994178323871`17.315319691421244*^9, 0, {0., 
   0.040403837660027274`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537958478315306`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts59\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538000966605008`17.315319772107472*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.04180912033876641`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts59", -3.6538000966605008`17.315319772107472*^9, 0, {0., 
   0.04180912033876641, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653796526644943*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts60\"\>", "\[InvisibleSpace]", 
   "18.6402993`8.721997874866664", "\[InvisibleSpace]", "20", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.004069012732698328`", ",", "0.04249468753807376`", ",", 
     "0.9998707151190593`"}], "}"}]}],
  SequenceForm[
  "vorts60", 18.6402993`8.721997874866664, 20, {0.004069012732698328, 
   0.04249468753807376, 0.9998707151190593}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653797191112198*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts61\"\>", "\[InvisibleSpace]", 
   "18.7495813`8.724536567366114", "\[InvisibleSpace]", "20", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.004062924951481072`", ",", "0.042493434412462595`", ",", 
     "0.9998715004932754`"}], "}"}]}],
  SequenceForm[
  "vorts61", 18.7495813`8.724536567366114, 20, {0.004062924951481072, 
   0.042493434412462595`, 0.9998715004932754}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537978550666747`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts62\"\>", "\[InvisibleSpace]", 
   "5.9536169`8.226325878968098", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005028042165247107`", ",", "0.04454993923929522`", ",", 
     "0.9999967974577637`"}], "}"}]}],
  SequenceForm[
  "vorts62", 5.9536169`8.226325878968098, 6, {0.005028042165247107, 
   0.04454993923929522, 0.9999967974577637}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537985550839434`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts63\"\>", "\[InvisibleSpace]", 
   "5.5301438`8.194281417881058", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0055981104715061205`", ",", "0.04753768226950842`", ",", 
     "0.9999999941004729`"}], "}"}]}],
  SequenceForm[
  "vorts63", 5.5301438`8.194281417881058, 5, {0.0055981104715061205`, 
   0.04753768226950842, 0.9999999941004729}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6537992665328474`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts64\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538036040200562`17.315320188995678*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.002390898889949311`", ",", "0.041080712985650344`", ",", "1.`"}], 
    "}"}]}],
  SequenceForm[
  "vorts64", -3.6538036040200562`17.315320188995678*^9, 0, {
   0.002390898889949311, 0.041080712985650344`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6538000328952894`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts65\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653804368019905`17.3153202798054*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03696972332229445`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts65", -3.653804368019905`17.3153202798054*^9, 0, {0., 
   0.03696972332229445, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6538007975341935`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts66\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538051474865735`17.3153203724535*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.032905340875551095`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts66", -3.6538051474865735`17.3153203724535*^9, 0, {0., 
   0.032905340875551095`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6538015768771973`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts67\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538059652365436`17.315320469651965*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.030453241596130335`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts67", -3.6538059652365436`17.315320469651965*^9, 0, {0., 
   0.030453241596130335`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653802394128363*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts68\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538067974418429`17.315320568568584*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.030076905886496225`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts68", -3.6538067974418429`17.315320568568584*^9, 0, {0., 
   0.030076905886496225`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6538032262376623`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts69\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.653807660767936`17.31532067118422*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03088963396798212`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts69", -3.653807660767936`17.31532067118422*^9, 0, {0., 
   0.03088963396798212, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6538040897370234`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts70\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538085289721426`17.31532077437965*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03207447994704318`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts70", -3.6538085289721426`17.31532077437965*^9, 0, {0., 
   0.03207447994704318, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6538049578323054`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts71\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538094460198793`17.315320883380632*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.033161660812317036`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts71", -3.6538094460198793`17.315320883380632*^9, 0, {0., 
   0.033161660812317036`, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653805874926272*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vorts72\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "3.6538104115188216`17.315320998140535*^9"}], 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.03315782415629254`", ",", "1.`"}], "}"}]}],
  SequenceForm[
  "vorts72", -3.6538104115188216`17.315320998140535*^9, 0, {0., 
   0.03315782415629254, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.653806840393823*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.653807291550547*^9}],

Cell[BoxData["28296.2631701`11.903274079488092"], "Output",
 CellChangeTimes->{3.65380729159737*^9}]
}, Open  ]]
},
WindowSize->{1474, 805},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 16988, 468, 952, "Input"],
Cell[17549, 490, 16381, 457, 972, "Input"],
Cell[CellGroupData[{
Cell[33955, 951, 112809, 2667, 7052, "Input"],
Cell[CellGroupData[{
Cell[146789, 3622, 472, 11, 23, "Print"],
Cell[147264, 3635, 465, 11, 23, "Print"],
Cell[147732, 3648, 469, 11, 23, "Print"],
Cell[148204, 3661, 467, 11, 23, "Print"],
Cell[148674, 3674, 472, 11, 23, "Print"],
Cell[149149, 3687, 470, 11, 23, "Print"],
Cell[149622, 3700, 508, 13, 23, "Print"],
Cell[150133, 3715, 471, 13, 23, "Print"],
Cell[150607, 3730, 473, 13, 23, "Print"],
Cell[151083, 3745, 508, 13, 23, "Print"],
Cell[151594, 3760, 467, 11, 23, "Print"],
Cell[152064, 3773, 469, 11, 23, "Print"],
Cell[152536, 3786, 474, 11, 23, "Print"],
Cell[153013, 3799, 474, 11, 23, "Print"],
Cell[153490, 3812, 472, 11, 23, "Print"],
Cell[153965, 3825, 465, 11, 23, "Print"],
Cell[154433, 3838, 471, 11, 23, "Print"],
Cell[154907, 3851, 471, 11, 23, "Print"],
Cell[155381, 3864, 471, 11, 23, "Print"],
Cell[155855, 3877, 471, 11, 23, "Print"],
Cell[156329, 3890, 465, 11, 23, "Print"],
Cell[156797, 3903, 467, 11, 23, "Print"],
Cell[157267, 3916, 471, 11, 23, "Print"],
Cell[157741, 3929, 505, 13, 23, "Print"],
Cell[158249, 3944, 469, 11, 23, "Print"],
Cell[158721, 3957, 471, 11, 23, "Print"],
Cell[159195, 3970, 467, 11, 23, "Print"],
Cell[159665, 3983, 470, 11, 23, "Print"],
Cell[160138, 3996, 471, 11, 23, "Print"],
Cell[160612, 4009, 471, 11, 23, "Print"],
Cell[161086, 4022, 469, 11, 23, "Print"],
Cell[161558, 4035, 465, 11, 23, "Print"],
Cell[162026, 4048, 471, 11, 23, "Print"],
Cell[162500, 4061, 472, 11, 23, "Print"],
Cell[162975, 4074, 467, 11, 23, "Print"],
Cell[163445, 4087, 471, 11, 23, "Print"],
Cell[163919, 4100, 471, 11, 23, "Print"],
Cell[164393, 4113, 471, 11, 23, "Print"],
Cell[164867, 4126, 469, 11, 23, "Print"],
Cell[165339, 4139, 469, 11, 23, "Print"],
Cell[165811, 4152, 474, 11, 23, "Print"],
Cell[166288, 4165, 474, 11, 23, "Print"],
Cell[166765, 4178, 469, 11, 23, "Print"],
Cell[167237, 4191, 472, 11, 23, "Print"],
Cell[167712, 4204, 474, 11, 23, "Print"],
Cell[168189, 4217, 464, 11, 23, "Print"],
Cell[168656, 4230, 469, 11, 23, "Print"],
Cell[169128, 4243, 508, 12, 23, "Print"],
Cell[169639, 4257, 508, 13, 23, "Print"],
Cell[170150, 4272, 511, 13, 23, "Print"],
Cell[170664, 4287, 509, 13, 23, "Print"],
Cell[171176, 4302, 508, 13, 23, "Print"],
Cell[171687, 4317, 471, 11, 23, "Print"],
Cell[172161, 4330, 468, 11, 23, "Print"],
Cell[172632, 4343, 472, 11, 23, "Print"],
Cell[173107, 4356, 469, 11, 23, "Print"],
Cell[173579, 4369, 467, 11, 23, "Print"],
Cell[174049, 4382, 474, 11, 23, "Print"],
Cell[174526, 4395, 469, 11, 23, "Print"],
Cell[174998, 4408, 510, 13, 23, "Print"],
Cell[175511, 4423, 515, 13, 23, "Print"],
Cell[176029, 4438, 508, 13, 23, "Print"],
Cell[176540, 4453, 511, 13, 23, "Print"],
Cell[177054, 4468, 520, 13, 23, "Print"],
Cell[177577, 4483, 465, 11, 23, "Print"],
Cell[178045, 4496, 470, 11, 23, "Print"],
Cell[178518, 4509, 472, 11, 23, "Print"],
Cell[178993, 4522, 474, 11, 23, "Print"],
Cell[179470, 4535, 467, 11, 23, "Print"],
Cell[179940, 4548, 469, 11, 23, "Print"],
Cell[180412, 4561, 472, 11, 23, "Print"],
Cell[180887, 4574, 469, 11, 23, "Print"]
}, Open  ]],
Cell[181371, 4588, 77, 1, 31, "Output"],
Cell[181451, 4591, 100, 1, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
